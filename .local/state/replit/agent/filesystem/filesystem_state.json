{"file_contents":{"client/src/components/ui/pagination.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { ButtonProps, buttonVariants } from \"@/components/ui/button\"\n\nconst Pagination = ({ className, ...props }: React.ComponentProps<\"nav\">) => (\n  <nav\n    role=\"navigation\"\n    aria-label=\"pagination\"\n    className={cn(\"mx-auto flex w-full justify-center\", className)}\n    {...props}\n  />\n)\nPagination.displayName = \"Pagination\"\n\nconst PaginationContent = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    className={cn(\"flex flex-row items-center gap-1\", className)}\n    {...props}\n  />\n))\nPaginationContent.displayName = \"PaginationContent\"\n\nconst PaginationItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ className, ...props }, ref) => (\n  <li ref={ref} className={cn(\"\", className)} {...props} />\n))\nPaginationItem.displayName = \"PaginationItem\"\n\ntype PaginationLinkProps = {\n  isActive?: boolean\n} & Pick<ButtonProps, \"size\"> &\n  React.ComponentProps<\"a\">\n\nconst PaginationLink = ({\n  className,\n  isActive,\n  size = \"icon\",\n  ...props\n}: PaginationLinkProps) => (\n  <a\n    aria-current={isActive ? \"page\" : undefined}\n    className={cn(\n      buttonVariants({\n        variant: isActive ? \"outline\" : \"ghost\",\n        size,\n      }),\n      className\n    )}\n    {...props}\n  />\n)\nPaginationLink.displayName = \"PaginationLink\"\n\nconst PaginationPrevious = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to previous page\"\n    size=\"default\"\n    className={cn(\"gap-1 pl-2.5\", className)}\n    {...props}\n  >\n    <ChevronLeft className=\"h-4 w-4\" />\n    <span>Previous</span>\n  </PaginationLink>\n)\nPaginationPrevious.displayName = \"PaginationPrevious\"\n\nconst PaginationNext = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to next page\"\n    size=\"default\"\n    className={cn(\"gap-1 pr-2.5\", className)}\n    {...props}\n  >\n    <span>Next</span>\n    <ChevronRight className=\"h-4 w-4\" />\n  </PaginationLink>\n)\nPaginationNext.displayName = \"PaginationNext\"\n\nconst PaginationEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    aria-hidden\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More pages</span>\n  </span>\n)\nPaginationEllipsis.displayName = \"PaginationEllipsis\"\n\nexport {\n  Pagination,\n  PaginationContent,\n  PaginationEllipsis,\n  PaginationItem,\n  PaginationLink,\n  PaginationNext,\n  PaginationPrevious,\n}\n","size_bytes":2751},"client/src/components/ui/chart.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as RechartsPrimitive from \"recharts\"\n\nimport { cn } from \"@/lib/utils\"\n\n// Format: { THEME_NAME: CSS_SELECTOR }\nconst THEMES = { light: \"\", dark: \".dark\" } as const\n\nexport type ChartConfig = {\n  [k in string]: {\n    label?: React.ReactNode\n    icon?: React.ComponentType\n  } & (\n    | { color?: string; theme?: never }\n    | { color?: never; theme: Record<keyof typeof THEMES, string> }\n  )\n}\n\ntype ChartContextProps = {\n  config: ChartConfig\n}\n\nconst ChartContext = React.createContext<ChartContextProps | null>(null)\n\nfunction useChart() {\n  const context = React.useContext(ChartContext)\n\n  if (!context) {\n    throw new Error(\"useChart must be used within a <ChartContainer />\")\n  }\n\n  return context\n}\n\nconst ChartContainer = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    config: ChartConfig\n    children: React.ComponentProps<\n      typeof RechartsPrimitive.ResponsiveContainer\n    >[\"children\"]\n  }\n>(({ id, className, children, config, ...props }, ref) => {\n  const uniqueId = React.useId()\n  const chartId = `chart-${id || uniqueId.replace(/:/g, \"\")}`\n\n  return (\n    <ChartContext.Provider value={{ config }}>\n      <div\n        data-chart={chartId}\n        ref={ref}\n        className={cn(\n          \"flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none\",\n          className\n        )}\n        {...props}\n      >\n        <ChartStyle id={chartId} config={config} />\n        <RechartsPrimitive.ResponsiveContainer>\n          {children}\n        </RechartsPrimitive.ResponsiveContainer>\n      </div>\n    </ChartContext.Provider>\n  )\n})\nChartContainer.displayName = \"Chart\"\n\nconst ChartStyle = ({ id, config }: { id: string; config: ChartConfig }) => {\n  const colorConfig = Object.entries(config).filter(\n    ([, config]) => config.theme || config.color\n  )\n\n  if (!colorConfig.length) {\n    return null\n  }\n\n  return (\n    <style\n      dangerouslySetInnerHTML={{\n        __html: Object.entries(THEMES)\n          .map(\n            ([theme, prefix]) => `\n${prefix} [data-chart=${id}] {\n${colorConfig\n  .map(([key, itemConfig]) => {\n    const color =\n      itemConfig.theme?.[theme as keyof typeof itemConfig.theme] ||\n      itemConfig.color\n    return color ? `  --color-${key}: ${color};` : null\n  })\n  .join(\"\\n\")}\n}\n`\n          )\n          .join(\"\\n\"),\n      }}\n    />\n  )\n}\n\nconst ChartTooltip = RechartsPrimitive.Tooltip\n\nconst ChartTooltipContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<typeof RechartsPrimitive.Tooltip> &\n    React.ComponentProps<\"div\"> & {\n      hideLabel?: boolean\n      hideIndicator?: boolean\n      indicator?: \"line\" | \"dot\" | \"dashed\"\n      nameKey?: string\n      labelKey?: string\n    }\n>(\n  (\n    {\n      active,\n      payload,\n      className,\n      indicator = \"dot\",\n      hideLabel = false,\n      hideIndicator = false,\n      label,\n      labelFormatter,\n      labelClassName,\n      formatter,\n      color,\n      nameKey,\n      labelKey,\n    },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    const tooltipLabel = React.useMemo(() => {\n      if (hideLabel || !payload?.length) {\n        return null\n      }\n\n      const [item] = payload\n      const key = `${labelKey || item?.dataKey || item?.name || \"value\"}`\n      const itemConfig = getPayloadConfigFromPayload(config, item, key)\n      const value =\n        !labelKey && typeof label === \"string\"\n          ? config[label as keyof typeof config]?.label || label\n          : itemConfig?.label\n\n      if (labelFormatter) {\n        return (\n          <div className={cn(\"font-medium\", labelClassName)}>\n            {labelFormatter(value, payload)}\n          </div>\n        )\n      }\n\n      if (!value) {\n        return null\n      }\n\n      return <div className={cn(\"font-medium\", labelClassName)}>{value}</div>\n    }, [\n      label,\n      labelFormatter,\n      payload,\n      hideLabel,\n      labelClassName,\n      config,\n      labelKey,\n    ])\n\n    if (!active || !payload?.length) {\n      return null\n    }\n\n    const nestLabel = payload.length === 1 && indicator !== \"dot\"\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl\",\n          className\n        )}\n      >\n        {!nestLabel ? tooltipLabel : null}\n        <div className=\"grid gap-1.5\">\n          {payload.map((item, index) => {\n            const key = `${nameKey || item.name || item.dataKey || \"value\"}`\n            const itemConfig = getPayloadConfigFromPayload(config, item, key)\n            const indicatorColor = color || item.payload.fill || item.color\n\n            return (\n              <div\n                key={item.dataKey}\n                className={cn(\n                  \"flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground\",\n                  indicator === \"dot\" && \"items-center\"\n                )}\n              >\n                {formatter && item?.value !== undefined && item.name ? (\n                  formatter(item.value, item.name, item, index, item.payload)\n                ) : (\n                  <>\n                    {itemConfig?.icon ? (\n                      <itemConfig.icon />\n                    ) : (\n                      !hideIndicator && (\n                        <div\n                          className={cn(\n                            \"shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]\",\n                            {\n                              \"h-2.5 w-2.5\": indicator === \"dot\",\n                              \"w-1\": indicator === \"line\",\n                              \"w-0 border-[1.5px] border-dashed bg-transparent\":\n                                indicator === \"dashed\",\n                              \"my-0.5\": nestLabel && indicator === \"dashed\",\n                            }\n                          )}\n                          style={\n                            {\n                              \"--color-bg\": indicatorColor,\n                              \"--color-border\": indicatorColor,\n                            } as React.CSSProperties\n                          }\n                        />\n                      )\n                    )}\n                    <div\n                      className={cn(\n                        \"flex flex-1 justify-between leading-none\",\n                        nestLabel ? \"items-end\" : \"items-center\"\n                      )}\n                    >\n                      <div className=\"grid gap-1.5\">\n                        {nestLabel ? tooltipLabel : null}\n                        <span className=\"text-muted-foreground\">\n                          {itemConfig?.label || item.name}\n                        </span>\n                      </div>\n                      {item.value && (\n                        <span className=\"font-mono font-medium tabular-nums text-foreground\">\n                          {item.value.toLocaleString()}\n                        </span>\n                      )}\n                    </div>\n                  </>\n                )}\n              </div>\n            )\n          })}\n        </div>\n      </div>\n    )\n  }\n)\nChartTooltipContent.displayName = \"ChartTooltip\"\n\nconst ChartLegend = RechartsPrimitive.Legend\n\nconst ChartLegendContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> &\n    Pick<RechartsPrimitive.LegendProps, \"payload\" | \"verticalAlign\"> & {\n      hideIcon?: boolean\n      nameKey?: string\n    }\n>(\n  (\n    { className, hideIcon = false, payload, verticalAlign = \"bottom\", nameKey },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    if (!payload?.length) {\n      return null\n    }\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"flex items-center justify-center gap-4\",\n          verticalAlign === \"top\" ? \"pb-3\" : \"pt-3\",\n          className\n        )}\n      >\n        {payload.map((item) => {\n          const key = `${nameKey || item.dataKey || \"value\"}`\n          const itemConfig = getPayloadConfigFromPayload(config, item, key)\n\n          return (\n            <div\n              key={item.value}\n              className={cn(\n                \"flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground\"\n              )}\n            >\n              {itemConfig?.icon && !hideIcon ? (\n                <itemConfig.icon />\n              ) : (\n                <div\n                  className=\"h-2 w-2 shrink-0 rounded-[2px]\"\n                  style={{\n                    backgroundColor: item.color,\n                  }}\n                />\n              )}\n              {itemConfig?.label}\n            </div>\n          )\n        })}\n      </div>\n    )\n  }\n)\nChartLegendContent.displayName = \"ChartLegend\"\n\n// Helper to extract item config from a payload.\nfunction getPayloadConfigFromPayload(\n  config: ChartConfig,\n  payload: unknown,\n  key: string\n) {\n  if (typeof payload !== \"object\" || payload === null) {\n    return undefined\n  }\n\n  const payloadPayload =\n    \"payload\" in payload &&\n    typeof payload.payload === \"object\" &&\n    payload.payload !== null\n      ? payload.payload\n      : undefined\n\n  let configLabelKey: string = key\n\n  if (\n    key in payload &&\n    typeof payload[key as keyof typeof payload] === \"string\"\n  ) {\n    configLabelKey = payload[key as keyof typeof payload] as string\n  } else if (\n    payloadPayload &&\n    key in payloadPayload &&\n    typeof payloadPayload[key as keyof typeof payloadPayload] === \"string\"\n  ) {\n    configLabelKey = payloadPayload[\n      key as keyof typeof payloadPayload\n    ] as string\n  }\n\n  return configLabelKey in config\n    ? config[configLabelKey]\n    : config[key as keyof typeof config]\n}\n\nexport {\n  ChartContainer,\n  ChartTooltip,\n  ChartTooltipContent,\n  ChartLegend,\n  ChartLegendContent,\n  ChartStyle,\n}\n","size_bytes":10481},"client/src/components/ui/popover.tsx":{"content":"import * as React from \"react\"\nimport * as PopoverPrimitive from \"@radix-ui/react-popover\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Popover = PopoverPrimitive.Root\n\nconst PopoverTrigger = PopoverPrimitive.Trigger\n\nconst PopoverContent = React.forwardRef<\n  React.ElementRef<typeof PopoverPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof PopoverPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <PopoverPrimitive.Portal>\n    <PopoverPrimitive.Content\n      ref={ref}\n      align={align}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </PopoverPrimitive.Portal>\n))\nPopoverContent.displayName = PopoverPrimitive.Content.displayName\n\nexport { Popover, PopoverTrigger, PopoverContent }\n","size_bytes":1280},"client/src/components/ui/sheet.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SheetPrimitive from \"@radix-ui/react-dialog\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Sheet = SheetPrimitive.Root\n\nconst SheetTrigger = SheetPrimitive.Trigger\n\nconst SheetClose = SheetPrimitive.Close\n\nconst SheetPortal = SheetPrimitive.Portal\n\nconst SheetOverlay = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nSheetOverlay.displayName = SheetPrimitive.Overlay.displayName\n\nconst sheetVariants = cva(\n  \"fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500\",\n  {\n    variants: {\n      side: {\n        top: \"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top\",\n        bottom:\n          \"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom\",\n        left: \"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm\",\n        right:\n          \"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm\",\n      },\n    },\n    defaultVariants: {\n      side: \"right\",\n    },\n  }\n)\n\ninterface SheetContentProps\n  extends React.ComponentPropsWithoutRef<typeof SheetPrimitive.Content>,\n    VariantProps<typeof sheetVariants> {}\n\nconst SheetContent = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Content>,\n  SheetContentProps\n>(({ side = \"right\", className, children, ...props }, ref) => (\n  <SheetPortal>\n    <SheetOverlay />\n    <SheetPrimitive.Content\n      ref={ref}\n      className={cn(sheetVariants({ side }), className)}\n      {...props}\n    >\n      {children}\n      <SheetPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </SheetPrimitive.Close>\n    </SheetPrimitive.Content>\n  </SheetPortal>\n))\nSheetContent.displayName = SheetPrimitive.Content.displayName\n\nconst SheetHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetHeader.displayName = \"SheetHeader\"\n\nconst SheetFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetFooter.displayName = \"SheetFooter\"\n\nconst SheetTitle = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold text-foreground\", className)}\n    {...props}\n  />\n))\nSheetTitle.displayName = SheetPrimitive.Title.displayName\n\nconst SheetDescription = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nSheetDescription.displayName = SheetPrimitive.Description.displayName\n\nexport {\n  Sheet,\n  SheetPortal,\n  SheetOverlay,\n  SheetTrigger,\n  SheetClose,\n  SheetContent,\n  SheetHeader,\n  SheetFooter,\n  SheetTitle,\n  SheetDescription,\n}\n","size_bytes":4281},"client/src/pages/marcom.tsx":{"content":"import { CampaignCard } from \"@/components/campaign-card\";\nimport { CampaignDialog } from \"@/components/campaign-dialog\";\nimport { SocialAccountOAuthDialog } from \"@/components/social-account-dialog-oauth\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Plus, Eye, Heart, TrendingUp, Users, BarChart3, RefreshCw, Trash2, Link as LinkIcon, CheckCircle2, XCircle } from \"lucide-react\";\nimport { SiInstagram, SiX, SiFacebook, SiTiktok, SiYoutube, SiTwitch } from \"react-icons/si\";\nimport { useState, useEffect } from \"react\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { isUnauthorizedError } from \"@/lib/authUtils\";\nimport type { Campaign as CampaignType, SocialAccount } from \"@shared/schema\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { useLocation } from \"wouter\";\n\nconst platformIcons: Record<string, any> = {\n  instagram: SiInstagram,\n  twitter: SiX,\n  facebook: SiFacebook,\n  tiktok: SiTiktok,\n  youtube: SiYoutube,\n  twitch: SiTwitch,\n};\n\nexport default function Marcom() {\n  const [campaignDialogOpen, setCampaignDialogOpen] = useState(false);\n  const [socialDialogOpen, setSocialDialogOpen] = useState(false);\n  const [selectedCampaign, setSelectedCampaign] = useState<CampaignType | undefined>();\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [location, setLocation] = useLocation();\n\n  // Handle OAuth callback messages\n  useEffect(() => {\n    const params = new URLSearchParams(window.location.search);\n    const oauthSuccess = params.get(\"oauth_success\");\n    const oauthError = params.get(\"oauth_error\");\n\n    if (oauthSuccess === \"true\") {\n      toast({\n        title: \"Success\",\n        description: \"Social account connected successfully\",\n      });\n      // Clear the OAuth params but preserve other query params\n      params.delete(\"oauth_success\");\n      const newSearch = params.toString();\n      const newUrl = newSearch ? `/marcom?${newSearch}` : \"/marcom\";\n      window.history.replaceState({}, \"\", newUrl);\n      \n      // Invalidate queries to refresh the data\n      queryClient.invalidateQueries({ queryKey: [\"/api/social/accounts\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/social/analytics\"] });\n    } else if (oauthError) {\n      toast({\n        title: \"Connection failed\",\n        description: `OAuth error: ${oauthError}`,\n        variant: \"destructive\",\n      });\n      // Clear the OAuth params but preserve other query params\n      params.delete(\"oauth_error\");\n      const newSearch = params.toString();\n      const newUrl = newSearch ? `/marcom?${newSearch}` : \"/marcom\";\n      window.history.replaceState({}, \"\", newUrl);\n    }\n  }, [toast, queryClient]);\n\n  const { data: campaigns = [], isLoading: campaignsLoading } = useQuery<CampaignType[]>({\n    queryKey: [\"/api/campaigns\"],\n  });\n\n  const { data: socialAccounts = [], isLoading: accountsLoading } = useQuery<SocialAccount[]>({\n    queryKey: [\"/api/social/accounts\"],\n  });\n\n  const { data: socialAnalytics, isLoading: analyticsLoading } = useQuery<any>({\n    queryKey: [\"/api/social/analytics\"],\n  });\n\n  const deleteCampaignMutation = useMutation({\n    mutationFn: async (id: string) => {\n      return await apiRequest(`/api/campaigns/${id}`, \"DELETE\");\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/campaigns\"] });\n      toast({\n        title: \"Success\",\n        description: \"Campaign deleted successfully\",\n      });\n    },\n    onError: (error: Error) => {\n      if (isUnauthorizedError(error)) {\n        toast({\n          title: \"Unauthorized\",\n          description: \"You are logged out. Logging in again...\",\n          variant: \"destructive\",\n        });\n        setTimeout(() => {\n          window.location.href = \"/login\";\n        }, 500);\n        return;\n      }\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to delete campaign\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const deleteAccountMutation = useMutation({\n    mutationFn: async (id: string) => {\n      return await apiRequest(`/api/social/accounts/${id}`, \"DELETE\");\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/social/accounts\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/social/analytics\"] });\n      toast({\n        title: \"Success\",\n        description: \"Social account disconnected\",\n      });\n    },\n    onError: (error: Error) => {\n      if (isUnauthorizedError(error)) {\n        toast({\n          title: \"Unauthorized\",\n          description: \"You are logged out. Logging in again...\",\n          variant: \"destructive\",\n        });\n        setTimeout(() => {\n          window.location.href = \"/login\";\n        }, 500);\n        return;\n      }\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to disconnect account\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const syncAccountMutation = useMutation({\n    mutationFn: async (accountId: string) => {\n      return await apiRequest(`/api/social/sync/${accountId}`, \"POST\");\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/social/analytics\"] });\n      toast({\n        title: \"Success\",\n        description: \"Analytics synced successfully\",\n      });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to sync analytics\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const totalReach = campaigns.filter(c => c.reach).reduce((sum, c) => sum + (c.reach || 0), 0);\n  const avgEngagement = campaigns.filter(c => c.engagement).length > 0\n    ? campaigns.filter(c => c.engagement).reduce((sum, c) => sum + (Number(c.engagement) || 0), 0) / campaigns.filter(c => c.engagement).length\n    : 0;\n\n  const handleEditCampaign = (campaign: CampaignType) => {\n    setSelectedCampaign(campaign);\n    setCampaignDialogOpen(true);\n  };\n\n  const handleAddCampaign = () => {\n    setSelectedCampaign(undefined);\n    setCampaignDialogOpen(true);\n  };\n\n  const handleDeleteCampaign = async (id: string) => {\n    if (confirm(\"Are you sure you want to delete this campaign?\")) {\n      await deleteCampaignMutation.mutateAsync(id);\n    }\n  };\n\n  const handleConnectAccount = () => {\n    setSocialDialogOpen(true);\n  };\n\n  const handleDisconnectAccount = async (id: string) => {\n    if (confirm(\"Are you sure you want to disconnect this account?\")) {\n      await deleteAccountMutation.mutateAsync(id);\n    }\n  };\n\n  const handleSyncAccount = async (accountId: string) => {\n    await syncAccountMutation.mutateAsync(accountId);\n  };\n\n  return (\n    <div className=\"p-6 space-y-6\">\n      <div className=\"flex items-center justify-between gap-4\">\n        <div>\n          <h1 className=\"text-3xl font-heading font-bold mb-1\" data-testid=\"text-marcom-title\">\n            Marketing & Communications\n          </h1>\n          <p className=\"text-muted-foreground\">Manage campaigns and track social media performance</p>\n        </div>\n      </div>\n\n      <Tabs defaultValue=\"analytics\" className=\"space-y-6\">\n        <TabsList>\n          <TabsTrigger value=\"analytics\" data-testid=\"tab-analytics\">Social Analytics</TabsTrigger>\n          <TabsTrigger value=\"campaigns\" data-testid=\"tab-campaigns\">Campaigns</TabsTrigger>\n        </TabsList>\n\n        <TabsContent value=\"analytics\" className=\"space-y-6\">\n          <div className=\"flex items-center justify-between\">\n            <h2 className=\"text-xl font-heading font-semibold\">Connected Accounts</h2>\n            <Button onClick={handleConnectAccount} data-testid=\"button-connect-account\">\n              <LinkIcon className=\"w-4 h-4 mr-2\" />\n              Connect Account\n            </Button>\n          </div>\n\n          {accountsLoading ? (\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n              {[1, 2, 3].map((i) => (\n                <Skeleton key={i} className=\"h-32\" />\n              ))}\n            </div>\n          ) : socialAccounts.length === 0 ? (\n            <Card>\n              <CardContent className=\"py-12 text-center text-muted-foreground\">\n                No social accounts connected. Connect your first account to start tracking analytics.\n              </CardContent>\n            </Card>\n          ) : (\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n              {socialAccounts.map((account) => {\n                const Icon = platformIcons[account.platform] || LinkIcon;\n                return (\n                  <Card key={account.id}>\n                    <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-3\">\n                      <div className=\"flex items-center gap-2\">\n                        <Icon className=\"h-5 w-5\" />\n                        <div>\n                          <CardTitle className=\"text-base\">{account.accountName}</CardTitle>\n                          <p className=\"text-xs text-muted-foreground capitalize\">{account.platform}</p>\n                        </div>\n                      </div>\n                      {account.isActive && (\n                        <Badge variant=\"secondary\" className=\"text-xs\">Active</Badge>\n                      )}\n                    </CardHeader>\n                    <CardContent className=\"space-y-2\">\n                      <div className=\"flex gap-2\">\n                        <Button\n                          size=\"sm\"\n                          variant=\"outline\"\n                          className=\"flex-1\"\n                          onClick={() => handleSyncAccount(account.id)}\n                          disabled={syncAccountMutation.isPending}\n                          data-testid={`button-sync-${account.id}`}\n                        >\n                          <RefreshCw className=\"w-3 h-3 mr-1\" />\n                          Sync\n                        </Button>\n                        <Button\n                          size=\"sm\"\n                          variant=\"outline\"\n                          onClick={() => handleDisconnectAccount(account.id)}\n                          data-testid={`button-disconnect-${account.id}`}\n                        >\n                          <Trash2 className=\"w-3 h-3\" />\n                        </Button>\n                      </div>\n                      {account.lastSyncedAt && (\n                        <p className=\"text-xs text-muted-foreground\">\n                          Last synced: {new Date(account.lastSyncedAt).toLocaleDateString()}\n                        </p>\n                      )}\n                    </CardContent>\n                  </Card>\n                );\n              })}\n            </div>\n          )}\n\n          <div className=\"grid grid-cols-1 md:grid-cols-4 gap-6\">\n            <Card>\n              <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n                <CardTitle className=\"text-sm font-medium text-muted-foreground\">Total Followers</CardTitle>\n                <Users className=\"h-4 w-4 text-muted-foreground\" />\n              </CardHeader>\n              <CardContent>\n                {analyticsLoading ? (\n                  <Skeleton className=\"h-10 w-24\" />\n                ) : (\n                  <>\n                    <div className=\"text-3xl font-bold font-mono\" data-testid=\"stat-total-followers\">\n                      {((socialAnalytics?.totalFollowers || 0) / 1000).toFixed(1)}K\n                    </div>\n                    <p className=\"text-xs text-muted-foreground mt-1\">Across all platforms</p>\n                  </>\n                )}\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n                <CardTitle className=\"text-sm font-medium text-muted-foreground\">Total Reach</CardTitle>\n                <Eye className=\"h-4 w-4 text-muted-foreground\" />\n              </CardHeader>\n              <CardContent>\n                {analyticsLoading ? (\n                  <Skeleton className=\"h-10 w-24\" />\n                ) : (\n                  <>\n                    <div className=\"text-3xl font-bold font-mono\" data-testid=\"stat-social-reach\">\n                      {((socialAnalytics?.totalReach || 0) / 1000).toFixed(0)}K\n                    </div>\n                    <p className=\"text-xs text-muted-foreground mt-1\">Total impressions</p>\n                  </>\n                )}\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n                <CardTitle className=\"text-sm font-medium text-muted-foreground\">Engagement</CardTitle>\n                <Heart className=\"h-4 w-4 text-muted-foreground\" />\n              </CardHeader>\n              <CardContent>\n                {analyticsLoading ? (\n                  <Skeleton className=\"h-10 w-24\" />\n                ) : (\n                  <>\n                    <div className=\"text-3xl font-bold font-mono\">\n                      {((socialAnalytics?.totalEngagement || 0) / 1000).toFixed(1)}K\n                    </div>\n                    <p className=\"text-xs text-muted-foreground mt-1\">Total interactions</p>\n                  </>\n                )}\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n                <CardTitle className=\"text-sm font-medium text-muted-foreground\">Avg Engagement Rate</CardTitle>\n                <BarChart3 className=\"h-4 w-4 text-muted-foreground\" />\n              </CardHeader>\n              <CardContent>\n                {analyticsLoading ? (\n                  <Skeleton className=\"h-10 w-24\" />\n                ) : (\n                  <>\n                    <div className=\"text-3xl font-bold font-mono\">\n                      {(socialAnalytics?.avgEngagementRate || 0).toFixed(1)}%\n                    </div>\n                    <p className=\"text-xs text-muted-foreground mt-1\">Across platforms</p>\n                  </>\n                )}\n              </CardContent>\n            </Card>\n          </div>\n\n          {socialAnalytics?.platforms && socialAnalytics.platforms.length > 0 && (\n            <div>\n              <h3 className=\"text-lg font-heading font-semibold mb-4\">Platform Breakdown</h3>\n              <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n                {socialAnalytics.platforms.map((platform: any, index: number) => {\n                  const Icon = platformIcons[platform.platform] || BarChart3;\n                  return (\n                    <Card key={index}>\n                      <CardHeader className=\"flex flex-row items-center gap-2 space-y-0 pb-3\">\n                        <Icon className=\"h-5 w-5\" />\n                        <CardTitle className=\"text-base capitalize\">{platform.platform}</CardTitle>\n                      </CardHeader>\n                      <CardContent className=\"space-y-2\">\n                        <div className=\"flex justify-between text-sm\">\n                          <span className=\"text-muted-foreground\">Followers:</span>\n                          <span className=\"font-mono font-semibold\">{(platform.followers || 0).toLocaleString()}</span>\n                        </div>\n                        <div className=\"flex justify-between text-sm\">\n                          <span className=\"text-muted-foreground\">Reach:</span>\n                          <span className=\"font-mono font-semibold\">{(platform.reach || 0).toLocaleString()}</span>\n                        </div>\n                        <div className=\"flex justify-between text-sm\">\n                          <span className=\"text-muted-foreground\">Engagement Rate:</span>\n                          <span className=\"font-mono font-semibold\">{platform.engagementRate || 0}%</span>\n                        </div>\n                        <div className=\"flex justify-between text-sm\">\n                          <span className=\"text-muted-foreground\">Posts:</span>\n                          <span className=\"font-mono font-semibold\">{platform.posts || 0}</span>\n                        </div>\n                      </CardContent>\n                    </Card>\n                  );\n                })}\n              </div>\n            </div>\n          )}\n        </TabsContent>\n\n        <TabsContent value=\"campaigns\" className=\"space-y-6\">\n          <div className=\"flex items-center justify-between\">\n            <h2 className=\"text-xl font-heading font-semibold\">Marketing Campaigns</h2>\n            <Button onClick={handleAddCampaign} data-testid=\"button-add-campaign\">\n              <Plus className=\"w-4 h-4 mr-2\" />\n              New Campaign\n            </Button>\n          </div>\n\n          <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n            <Card>\n              <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n                <CardTitle className=\"text-sm font-medium text-muted-foreground\">Campaign Reach</CardTitle>\n                <Eye className=\"h-4 w-4 text-muted-foreground\" />\n              </CardHeader>\n              <CardContent>\n                {campaignsLoading ? (\n                  <Skeleton className=\"h-10 w-24\" />\n                ) : (\n                  <>\n                    <div className=\"text-3xl font-bold font-mono\" data-testid=\"stat-total-reach\">\n                      {(totalReach / 1000).toFixed(0)}K\n                    </div>\n                    <p className=\"text-xs text-muted-foreground mt-1\">Across all campaigns</p>\n                  </>\n                )}\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n                <CardTitle className=\"text-sm font-medium text-muted-foreground\">Avg Engagement</CardTitle>\n                <Heart className=\"h-4 w-4 text-muted-foreground\" />\n              </CardHeader>\n              <CardContent>\n                {campaignsLoading ? (\n                  <Skeleton className=\"h-10 w-24\" />\n                ) : (\n                  <>\n                    <div className=\"text-3xl font-bold font-mono\">\n                      {avgEngagement.toFixed(1)}%\n                    </div>\n                    <p className=\"text-xs text-muted-foreground mt-1\">Engagement rate</p>\n                  </>\n                )}\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n                <CardTitle className=\"text-sm font-medium text-muted-foreground\">Active Campaigns</CardTitle>\n                <TrendingUp className=\"h-4 w-4 text-muted-foreground\" />\n              </CardHeader>\n              <CardContent>\n                {campaignsLoading ? (\n                  <Skeleton className=\"h-10 w-16\" />\n                ) : (\n                  <>\n                    <div className=\"text-3xl font-bold font-mono\">\n                      {campaigns.filter(c => c.status === 'active').length}\n                    </div>\n                    <p className=\"text-xs text-muted-foreground mt-1\">Currently running</p>\n                  </>\n                )}\n              </CardContent>\n            </Card>\n          </div>\n\n          {campaignsLoading ? (\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n              {[1, 2, 3, 4].map((i) => (\n                <Skeleton key={i} className=\"h-64\" />\n              ))}\n            </div>\n          ) : campaigns.length === 0 ? (\n            <div className=\"text-center py-12 text-muted-foreground\">\n              No campaigns yet. Create your first campaign to get started.\n            </div>\n          ) : (\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n              {campaigns.map((campaign) => (\n                <div key={campaign.id} className=\"relative group\">\n                  <CampaignCard\n                    {...campaign}\n                    platforms={campaign.platforms as any}\n                    status={campaign.status as any}\n                    startDate={new Date(campaign.startDate)}\n                    endDate={new Date(campaign.endDate)}\n                    reach={campaign.reach ?? undefined}\n                    engagement={campaign.engagement ? Number(campaign.engagement) : undefined}\n                  />\n                  <div className=\"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity flex gap-2\">\n                    <Button \n                      variant=\"secondary\" \n                      size=\"sm\"\n                      onClick={() => handleEditCampaign(campaign)} \n                      data-testid={`button-edit-campaign-${campaign.id}`}\n                    >\n                      Edit\n                    </Button>\n                    <Button\n                      variant=\"secondary\"\n                      size=\"sm\"\n                      onClick={() => handleDeleteCampaign(campaign.id)}\n                      data-testid={`button-delete-campaign-${campaign.id}`}\n                    >\n                      <Trash2 className=\"h-4 w-4\" />\n                    </Button>\n                  </div>\n                </div>\n              ))}\n            </div>\n          )}\n        </TabsContent>\n      </Tabs>\n\n      <CampaignDialog\n        open={campaignDialogOpen}\n        onOpenChange={setCampaignDialogOpen}\n        campaign={selectedCampaign}\n      />\n\n      <SocialAccountOAuthDialog\n        open={socialDialogOpen}\n        onOpenChange={setSocialDialogOpen}\n      />\n    </div>\n  );\n}\n","size_bytes":22170},"client/src/components/ui/badge.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst badgeVariants = cva(\n  // Whitespace-nowrap: Badges should never wrap.\n  \"whitespace-nowrap inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\" +\n  \" hover-elevate \" ,\n  {\n    variants: {\n      variant: {\n        default:\n          \"border-transparent bg-primary text-primary-foreground shadow-xs\",\n        secondary: \"border-transparent bg-secondary text-secondary-foreground\",\n        destructive:\n          \"border-transparent bg-destructive text-destructive-foreground shadow-xs\",\n\n        outline: \" border [border-color:var(--badge-outline)] shadow-xs\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  },\n)\n\nexport interface BadgeProps\n  extends React.HTMLAttributes<HTMLDivElement>,\n    VariantProps<typeof badgeVariants> {}\n\nfunction Badge({ className, variant, ...props }: BadgeProps) {\n  return (\n    <div className={cn(badgeVariants({ variant }), className)} {...props} />\n  );\n}\n\nexport { Badge, badgeVariants }\n","size_bytes":1202},"client/src/components/ui/input-otp.tsx":{"content":"import * as React from \"react\"\nimport { OTPInput, OTPInputContext } from \"input-otp\"\nimport { Dot } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst InputOTP = React.forwardRef<\n  React.ElementRef<typeof OTPInput>,\n  React.ComponentPropsWithoutRef<typeof OTPInput>\n>(({ className, containerClassName, ...props }, ref) => (\n  <OTPInput\n    ref={ref}\n    containerClassName={cn(\n      \"flex items-center gap-2 has-[:disabled]:opacity-50\",\n      containerClassName\n    )}\n    className={cn(\"disabled:cursor-not-allowed\", className)}\n    {...props}\n  />\n))\nInputOTP.displayName = \"InputOTP\"\n\nconst InputOTPGroup = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"flex items-center\", className)} {...props} />\n))\nInputOTPGroup.displayName = \"InputOTPGroup\"\n\nconst InputOTPSlot = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\"> & { index: number }\n>(({ index, className, ...props }, ref) => {\n  const inputOTPContext = React.useContext(OTPInputContext)\n  const { char, hasFakeCaret, isActive } = inputOTPContext.slots[index]\n\n  return (\n    <div\n      ref={ref}\n      className={cn(\n        \"relative flex h-10 w-10 items-center justify-center border-y border-r border-input text-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md\",\n        isActive && \"z-10 ring-2 ring-ring ring-offset-background\",\n        className\n      )}\n      {...props}\n    >\n      {char}\n      {hasFakeCaret && (\n        <div className=\"pointer-events-none absolute inset-0 flex items-center justify-center\">\n          <div className=\"h-4 w-px animate-caret-blink bg-foreground duration-1000\" />\n        </div>\n      )}\n    </div>\n  )\n})\nInputOTPSlot.displayName = \"InputOTPSlot\"\n\nconst InputOTPSeparator = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ ...props }, ref) => (\n  <div ref={ref} role=\"separator\" {...props}>\n    <Dot />\n  </div>\n))\nInputOTPSeparator.displayName = \"InputOTPSeparator\"\n\nexport { InputOTP, InputOTPGroup, InputOTPSlot, InputOTPSeparator }\n","size_bytes":2154},"client/src/components/ui/collapsible.tsx":{"content":"\"use client\"\n\nimport * as CollapsiblePrimitive from \"@radix-ui/react-collapsible\"\n\nconst Collapsible = CollapsiblePrimitive.Root\n\nconst CollapsibleTrigger = CollapsiblePrimitive.CollapsibleTrigger\n\nconst CollapsibleContent = CollapsiblePrimitive.CollapsibleContent\n\nexport { Collapsible, CollapsibleTrigger, CollapsibleContent }\n","size_bytes":329},"shared/schema.ts":{"content":"import { sql } from \"drizzle-orm\";\nimport {\n  index,\n  jsonb,\n  pgTable,\n  timestamp,\n  varchar,\n  text,\n  integer,\n  boolean,\n  decimal,\n} from \"drizzle-orm/pg-core\";\nimport { createInsertSchema } from \"drizzle-zod\";\nimport { z } from \"zod\";\n\n// Session storage table - Required for Replit Auth\nexport const sessions = pgTable(\n  \"sessions\",\n  {\n    sid: varchar(\"sid\").primaryKey(),\n    sess: jsonb(\"sess\").notNull(),\n    expire: timestamp(\"expire\").notNull(),\n  },\n  (table) => [index(\"IDX_session_expire\").on(table.expire)],\n);\n\n// Users table - Custom authentication with tenant support\nexport const users = pgTable(\"users\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  email: varchar(\"email\").notNull().unique(),\n  password: text(\"password\").notNull(), // Hashed password\n  firstName: varchar(\"first_name\"),\n  lastName: varchar(\"last_name\"),\n  profileImageUrl: varchar(\"profile_image_url\"),\n  tenantId: varchar(\"tenant_id\"), // Multi-tenant support (nullable for super admins)\n  role: varchar(\"role\").notNull().default(\"owner\"), // owner, admin, manager, staff, player, marcom, analyst, finance\n  isSuperAdmin: boolean(\"is_super_admin\").notNull().default(false), // System-level admin\n  isTemporaryPassword: boolean(\"is_temporary_password\").notNull().default(false), // Must change on first login\n  lastPasswordChange: timestamp(\"last_password_change\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\nexport type UpsertUser = typeof users.$inferInsert;\nexport type User = typeof users.$inferSelect;\n\n// Tenants table - Each esports club is a tenant\nexport const tenants = pgTable(\"tenants\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  name: varchar(\"name\").notNull(),\n  clubTag: varchar(\"club_tag\"),\n  logoUrl: varchar(\"logo_url\"),\n  primaryColor: varchar(\"primary_color\").default(\"#a855f7\"),\n  website: varchar(\"website\"),\n  region: varchar(\"region\"),\n  // Subscription fields\n  subscriptionPlan: varchar(\"subscription_plan\").default(\"starter\"), // starter, growth, enterprise\n  subscriptionStatus: varchar(\"subscription_status\").default(\"active\"), // active, suspended, canceled, trial\n  stripeCustomerId: varchar(\"stripe_customer_id\"),\n  stripeSubscriptionId: varchar(\"stripe_subscription_id\"),\n  trialEndsAt: timestamp(\"trial_ends_at\"),\n  subscriptionEndsAt: timestamp(\"subscription_ends_at\"),\n  // Suspension tracking\n  suspendedAt: timestamp(\"suspended_at\"),\n  suspensionReason: text(\"suspension_reason\"),\n  suspendedBy: varchar(\"suspended_by\"), // User ID who suspended the tenant\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\nexport const insertTenantSchema = createInsertSchema(tenants).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n});\nexport type InsertTenant = z.infer<typeof insertTenantSchema>;\nexport type Tenant = typeof tenants.$inferSelect;\n\n// Staff members (players, managers, analysts, etc.)\nexport const staff = pgTable(\"staff\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  tenantId: varchar(\"tenant_id\").notNull(),\n  name: varchar(\"name\").notNull(),\n  email: varchar(\"email\").notNull(),\n  phone: varchar(\"phone\"),\n  role: varchar(\"role\").notNull(), // owner, admin, manager, staff, player, marcom, analyst, finance\n  avatar: varchar(\"avatar\"),\n  permissions: jsonb(\"permissions\").notNull().$type<string[]>(),\n  status: varchar(\"status\").notNull().default(\"active\"), // active, suspended\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\nexport const insertStaffSchema = createInsertSchema(staff).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n});\nexport type InsertStaff = z.infer<typeof insertStaffSchema>;\nexport type Staff = typeof staff.$inferSelect;\n\n// Payroll entries\nexport const payroll = pgTable(\"payroll\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  tenantId: varchar(\"tenant_id\").notNull(),\n  staffId: varchar(\"staff_id\"),\n  name: varchar(\"name\").notNull(),\n  role: varchar(\"role\").notNull(),\n  amount: decimal(\"amount\", { precision: 10, scale: 2 }).notNull(),\n  type: varchar(\"type\").notNull(), // monthly, weekly, one-time\n  status: varchar(\"status\").notNull().default(\"pending\"), // paid, pending\n  date: timestamp(\"date\").notNull(),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\nexport const insertPayrollSchema = createInsertSchema(payroll).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n}).extend({\n  date: z.union([z.date(), z.string().transform(val => new Date(val))]),\n});\nexport type InsertPayroll = z.infer<typeof insertPayrollSchema>;\nexport type Payroll = typeof payroll.$inferSelect;\n\n// Tournaments (parent structure)\nexport const tournaments = pgTable(\"tournaments\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  tenantId: varchar(\"tenant_id\").notNull(),\n  name: varchar(\"name\").notNull(),\n  game: varchar(\"game\").notNull(),\n  format: varchar(\"format\").notNull(), // single_elimination, double_elimination, round_robin, league, custom\n  startDate: timestamp(\"start_date\").notNull(),\n  endDate: timestamp(\"end_date\"),\n  prizePool: decimal(\"prize_pool\", { precision: 10, scale: 2 }),\n  status: varchar(\"status\").notNull().default(\"upcoming\"), // upcoming, ongoing, completed, cancelled\n  description: text(\"description\"),\n  rules: text(\"rules\"),\n  maxTeams: integer(\"max_teams\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\nexport const insertTournamentSchema = createInsertSchema(tournaments).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n}).extend({\n  startDate: z.union([z.date(), z.string().transform(val => new Date(val))]),\n  endDate: z.union([z.date(), z.string().transform(val => new Date(val))]).optional(),\n});\nexport type InsertTournament = z.infer<typeof insertTournamentSchema>;\nexport type Tournament = typeof tournaments.$inferSelect;\n\n// Tournament Rounds/Stages (middle layer for brackets/groups)\nexport const tournamentRounds = pgTable(\"tournament_rounds\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  tournamentId: varchar(\"tournament_id\").notNull(),\n  name: varchar(\"name\").notNull(), // e.g., \"Group A\", \"Quarterfinals\", \"Semifinals\", \"Finals\"\n  roundNumber: integer(\"round_number\").notNull(), // 1, 2, 3, etc. for ordering\n  format: varchar(\"format\"), // bracket, group, best_of_3, best_of_5\n  startDate: timestamp(\"start_date\"),\n  status: varchar(\"status\").notNull().default(\"upcoming\"), // upcoming, ongoing, completed\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const insertTournamentRoundSchema = createInsertSchema(tournamentRounds).omit({\n  id: true,\n  createdAt: true,\n}).extend({\n  startDate: z.union([z.date(), z.string().transform(val => new Date(val))]).optional(),\n});\nexport type InsertTournamentRound = z.infer<typeof insertTournamentRoundSchema>;\nexport type TournamentRound = typeof tournamentRounds.$inferSelect;\n\n// Matches (updated to reference tournament and round)\nexport const matches = pgTable(\"matches\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  tenantId: varchar(\"tenant_id\").notNull(),\n  tournamentId: varchar(\"tournament_id\"), // Reference to tournament (null for standalone matches)\n  roundId: varchar(\"round_id\"), // Reference to round (optional)\n  teamA: varchar(\"team_a\").notNull(),\n  teamB: varchar(\"team_b\").notNull(),\n  scoreA: integer(\"score_a\"),\n  scoreB: integer(\"score_b\"),\n  date: timestamp(\"date\").notNull(),\n  tournament: varchar(\"tournament\"), // Legacy field, kept for backward compatibility\n  game: varchar(\"game\").notNull(),\n  venue: varchar(\"venue\"),\n  matchNumber: integer(\"match_number\"), // For ordering within a round\n  nextMatchId: varchar(\"next_match_id\"), // For bracket progression (winner goes to this match)\n  status: varchar(\"status\").notNull().default(\"upcoming\"), // upcoming, live, completed\n  notes: text(\"notes\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\nexport const insertMatchSchema = createInsertSchema(matches).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n}).extend({\n  date: z.union([z.date(), z.string().transform(val => new Date(val))]),\n});\nexport type InsertMatch = z.infer<typeof insertMatchSchema>;\nexport type Match = typeof matches.$inferSelect;\n\n// Marketing campaigns\nexport const campaigns = pgTable(\"campaigns\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  tenantId: varchar(\"tenant_id\").notNull(),\n  title: varchar(\"title\").notNull(),\n  description: text(\"description\").notNull(),\n  startDate: timestamp(\"start_date\").notNull(),\n  endDate: timestamp(\"end_date\").notNull(),\n  platforms: jsonb(\"platforms\").notNull().$type<string[]>(),\n  reach: integer(\"reach\"),\n  engagement: decimal(\"engagement\", { precision: 5, scale: 2 }),\n  status: varchar(\"status\").notNull().default(\"scheduled\"), // active, completed, scheduled\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\nexport const insertCampaignSchema = createInsertSchema(campaigns).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n}).extend({\n  startDate: z.union([z.date(), z.string().transform(val => new Date(val))]),\n  endDate: z.union([z.date(), z.string().transform(val => new Date(val))]),\n});\nexport type InsertCampaign = z.infer<typeof insertCampaignSchema>;\nexport type Campaign = typeof campaigns.$inferSelect;\n\n// Contracts\nexport const contracts = pgTable(\"contracts\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  tenantId: varchar(\"tenant_id\").notNull(),\n  fileName: varchar(\"file_name\").notNull(),\n  fileUrl: varchar(\"file_url\").notNull(),\n  type: varchar(\"type\").notNull(), // Player, Staff, Sponsor\n  linkedPerson: varchar(\"linked_person\").notNull(),\n  expirationDate: timestamp(\"expiration_date\").notNull(),\n  status: varchar(\"status\").notNull().default(\"active\"), // active, expiring, expired\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\nexport const insertContractSchema = createInsertSchema(contracts).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n}).extend({\n  expirationDate: z.union([z.date(), z.string().transform(val => new Date(val))]),\n});\nexport type InsertContract = z.infer<typeof insertContractSchema>;\nexport type Contract = typeof contracts.$inferSelect;\n\n// Audit logs\nexport const auditLogs = pgTable(\"audit_logs\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  tenantId: varchar(\"tenant_id\").notNull(),\n  userId: varchar(\"user_id\").notNull(),\n  userName: varchar(\"user_name\").notNull(),\n  action: text(\"action\").notNull(),\n  entity: varchar(\"entity\").notNull(),\n  entityId: varchar(\"entity_id\"),\n  oldValue: text(\"old_value\"),\n  newValue: text(\"new_value\"),\n  actionType: varchar(\"action_type\").notNull(), // create, update, delete\n  timestamp: timestamp(\"timestamp\").defaultNow(),\n});\n\nexport const insertAuditLogSchema = createInsertSchema(auditLogs).omit({\n  id: true,\n  timestamp: true,\n});\nexport type InsertAuditLog = z.infer<typeof insertAuditLogSchema>;\nexport type AuditLog = typeof auditLogs.$inferSelect;\n\n// Social Media Accounts\nexport const socialAccounts = pgTable(\"social_accounts\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  tenantId: varchar(\"tenant_id\").notNull(),\n  platform: varchar(\"platform\").notNull(), // facebook, instagram, twitter, tiktok, youtube\n  accountName: varchar(\"account_name\").notNull(),\n  accountId: varchar(\"account_id\"), // Platform-specific account ID\n  apiKey: text(\"api_key\"), // Encrypted API key/access token\n  apiSecret: text(\"api_secret\"), // Encrypted API secret if needed\n  refreshToken: text(\"refresh_token\"), // For OAuth flows\n  expiresAt: timestamp(\"expires_at\"), // Token expiration\n  isActive: boolean(\"is_active\").notNull().default(true),\n  lastSyncedAt: timestamp(\"last_synced_at\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\nexport const insertSocialAccountSchema = createInsertSchema(socialAccounts).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n});\nexport type InsertSocialAccount = z.infer<typeof insertSocialAccountSchema>;\nexport type SocialAccount = typeof socialAccounts.$inferSelect;\n\n// Social Media Metrics\nexport const socialMetrics = pgTable(\"social_metrics\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  accountId: varchar(\"account_id\").notNull(), // References socialAccounts.id\n  tenantId: varchar(\"tenant_id\").notNull(),\n  platform: varchar(\"platform\").notNull(),\n  followers: integer(\"followers\").default(0),\n  following: integer(\"following\").default(0),\n  posts: integer(\"posts\").default(0),\n  reach: integer(\"reach\").default(0),\n  impressions: integer(\"impressions\").default(0),\n  engagement: integer(\"engagement\").default(0),\n  engagementRate: decimal(\"engagement_rate\", { precision: 5, scale: 2 }).default(\"0\"),\n  profileViews: integer(\"profile_views\").default(0),\n  websiteClicks: integer(\"website_clicks\").default(0),\n  date: timestamp(\"date\").notNull().defaultNow(),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const insertSocialMetricSchema = createInsertSchema(socialMetrics).omit({\n  id: true,\n  createdAt: true,\n}).extend({\n  date: z.union([z.date(), z.string().transform(val => new Date(val))]),\n});\nexport type InsertSocialMetric = z.infer<typeof insertSocialMetricSchema>;\nexport type SocialMetric = typeof socialMetrics.$inferSelect;\n\n// Staff Invites\nexport const invites = pgTable(\"invites\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  tenantId: varchar(\"tenant_id\").notNull(),\n  email: varchar(\"email\").notNull(),\n  role: varchar(\"role\").notNull(),\n  permissions: jsonb(\"permissions\").notNull().$type<string[]>(),\n  token: varchar(\"token\").notNull().unique(),\n  invitedBy: varchar(\"invited_by\").notNull(),\n  inviterName: varchar(\"inviter_name\").notNull(),\n  status: varchar(\"status\").notNull().default(\"pending\"), // pending, accepted, expired\n  expiresAt: timestamp(\"expires_at\").notNull(),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const insertInviteSchema = createInsertSchema(invites).omit({\n  id: true,\n  createdAt: true,\n});\nexport type InsertInvite = z.infer<typeof insertInviteSchema>;\nexport type Invite = typeof invites.$inferSelect;\n\n// Finance Transactions\nexport const transactions = pgTable(\"transactions\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  tenantId: varchar(\"tenant_id\").notNull(),\n  type: varchar(\"type\").notNull(), // income, expense\n  category: varchar(\"category\").notNull(), // sponsorship, merchandise, tournament_prize, salaries, equipment, facility, travel, etc\n  amount: decimal(\"amount\", { precision: 10, scale: 2 }).notNull(),\n  description: text(\"description\"),\n  date: timestamp(\"date\").notNull(),\n  paymentMethod: varchar(\"payment_method\"), // cash, bank_transfer, credit_card, paypal, etc\n  reference: varchar(\"reference\"), // invoice number, receipt number, etc\n  createdBy: varchar(\"created_by\").notNull(),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\nexport const insertTransactionSchema = createInsertSchema(transactions).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n}).extend({\n  date: z.union([z.date(), z.string().transform(val => new Date(val))]),\n});\nexport type InsertTransaction = z.infer<typeof insertTransactionSchema>;\nexport type Transaction = typeof transactions.$inferSelect;\n","size_bytes":15797},"client/src/components/ui/label.tsx":{"content":"import * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst labelVariants = cva(\n  \"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n)\n\nconst Label = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &\n    VariantProps<typeof labelVariants>\n>(({ className, ...props }, ref) => (\n  <LabelPrimitive.Root\n    ref={ref}\n    className={cn(labelVariants(), className)}\n    {...props}\n  />\n))\nLabel.displayName = LabelPrimitive.Root.displayName\n\nexport { Label }\n","size_bytes":710},"client/src/components/ui/toggle.tsx":{"content":"import * as React from \"react\"\nimport * as TogglePrimitive from \"@radix-ui/react-toggle\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst toggleVariants = cva(\n  \"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 gap-2\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        outline:\n          \"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground\",\n      },\n      size: {\n        default: \"h-10 px-3 min-w-10\",\n        sm: \"h-9 px-2.5 min-w-9\",\n        lg: \"h-11 px-5 min-w-11\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nconst Toggle = React.forwardRef<\n  React.ElementRef<typeof TogglePrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof TogglePrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, ...props }, ref) => (\n  <TogglePrimitive.Root\n    ref={ref}\n    className={cn(toggleVariants({ variant, size, className }))}\n    {...props}\n  />\n))\n\nToggle.displayName = TogglePrimitive.Root.displayName\n\nexport { Toggle, toggleVariants }\n","size_bytes":1527},"client/src/components/ui/skeleton.tsx":{"content":"import { cn } from \"@/lib/utils\"\n\nfunction Skeleton({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      className={cn(\"animate-pulse rounded-md bg-muted\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Skeleton }\n","size_bytes":261},"client/src/components/ui/toggle-group.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ToggleGroupPrimitive from \"@radix-ui/react-toggle-group\"\nimport { type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { toggleVariants } from \"@/components/ui/toggle\"\n\nconst ToggleGroupContext = React.createContext<\n  VariantProps<typeof toggleVariants>\n>({\n  size: \"default\",\n  variant: \"default\",\n})\n\nconst ToggleGroup = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, children, ...props }, ref) => (\n  <ToggleGroupPrimitive.Root\n    ref={ref}\n    className={cn(\"flex items-center justify-center gap-1\", className)}\n    {...props}\n  >\n    <ToggleGroupContext.Provider value={{ variant, size }}>\n      {children}\n    </ToggleGroupContext.Provider>\n  </ToggleGroupPrimitive.Root>\n))\n\nToggleGroup.displayName = ToggleGroupPrimitive.Root.displayName\n\nconst ToggleGroupItem = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Item> &\n    VariantProps<typeof toggleVariants>\n>(({ className, children, variant, size, ...props }, ref) => {\n  const context = React.useContext(ToggleGroupContext)\n\n  return (\n    <ToggleGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        toggleVariants({\n          variant: context.variant || variant,\n          size: context.size || size,\n        }),\n        className\n      )}\n      {...props}\n    >\n      {children}\n    </ToggleGroupPrimitive.Item>\n  )\n})\n\nToggleGroupItem.displayName = ToggleGroupPrimitive.Item.displayName\n\nexport { ToggleGroup, ToggleGroupItem }\n","size_bytes":1753},"client/src/pages/settings.tsx":{"content":"import { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Upload, UserPlus, Copy, Trash2, Check, Crown, Zap, Rocket } from \"lucide-react\";\nimport { useState, useEffect } from \"react\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { isUnauthorizedError } from \"@/lib/authUtils\";\nimport type { Tenant, Invite } from \"@shared/schema\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { Dialog, DialogContent, DialogDescription, DialogFooter, DialogHeader, DialogTitle, DialogTrigger } from \"@/components/ui/dialog\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Badge } from \"@/components/ui/badge\";\n\nfunction InviteManagement() {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [isDialogOpen, setIsDialogOpen] = useState(false);\n  const [email, setEmail] = useState(\"\");\n  const [role, setRole] = useState(\"staff\");\n  const [permissions, setPermissions] = useState<string[]>([]);\n  const [copiedToken, setCopiedToken] = useState(\"\");\n\n  const { data: invites = [] } = useQuery<Invite[]>({\n    queryKey: [\"/api/invites\"],\n  });\n\n  const createInviteMutation = useMutation({\n    mutationFn: async (data: { email: string; role: string; permissions: string[] }) => {\n      return await apiRequest(\"/api/invites\", \"POST\", data);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/invites\"] });\n      setIsDialogOpen(false);\n      setEmail(\"\");\n      setRole(\"staff\");\n      setPermissions([]);\n      toast({ title: \"Success\", description: \"Invite created successfully\" });\n    },\n    onError: () => {\n      toast({ title: \"Error\", description: \"Failed to create invite\", variant: \"destructive\" });\n    },\n  });\n\n  const deleteInviteMutation = useMutation({\n    mutationFn: async (id: string) => {\n      return await apiRequest(`/api/invites/${id}`, \"DELETE\", {});\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/invites\"] });\n      toast({ title: \"Success\", description: \"Invite deleted\" });\n    },\n    onError: () => {\n      toast({ title: \"Error\", description: \"Failed to delete invite\", variant: \"destructive\" });\n    },\n  });\n\n  const copyInviteLink = (token: string) => {\n    const link = `${window.location.origin}/invite/${token}`;\n    navigator.clipboard.writeText(link);\n    setCopiedToken(token);\n    toast({ title: \"Copied!\", description: \"Invite link copied to clipboard\" });\n    setTimeout(() => setCopiedToken(\"\"), 2000);\n  };\n\n  const handleCreateInvite = () => {\n    if (!email) {\n      toast({ title: \"Error\", description: \"Email is required\", variant: \"destructive\" });\n      return;\n    }\n    createInviteMutation.mutate({ email, role, permissions });\n  };\n\n  return (\n    <Card>\n      <CardHeader>\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <CardTitle className=\"text-lg font-heading\">Staff Invites</CardTitle>\n            <CardDescription>Invite team members to join your club</CardDescription>\n          </div>\n          <Dialog open={isDialogOpen} onOpenChange={setIsDialogOpen}>\n            <DialogTrigger asChild>\n              <Button data-testid=\"button-create-invite\">\n                <UserPlus className=\"mr-2 h-4 w-4\" />\n                Invite Staff\n              </Button>\n            </DialogTrigger>\n            <DialogContent>\n              <DialogHeader>\n                <DialogTitle>Invite New Staff Member</DialogTitle>\n                <DialogDescription>\n                  Send an invitation link to add a new member to your club\n                </DialogDescription>\n              </DialogHeader>\n              <div className=\"space-y-4\">\n                <div className=\"space-y-2\">\n                  <Label>Email</Label>\n                  <Input\n                    value={email}\n                    onChange={(e) => setEmail(e.target.value)}\n                    placeholder=\"staff@example.com\"\n                    type=\"email\"\n                    data-testid=\"input-invite-email\"\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>Role</Label>\n                  <Select value={role} onValueChange={setRole}>\n                    <SelectTrigger data-testid=\"select-invite-role\">\n                      <SelectValue />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"staff\">Staff</SelectItem>\n                      <SelectItem value=\"player\">Player</SelectItem>\n                      <SelectItem value=\"manager\">Manager</SelectItem>\n                      <SelectItem value=\"analyst\">Analyst</SelectItem>\n                      <SelectItem value=\"marcom\">Marketing</SelectItem>\n                      <SelectItem value=\"finance\">Finance</SelectItem>\n                    </SelectContent>\n                  </Select>\n                </div>\n              </div>\n              <DialogFooter>\n                <Button\n                  onClick={handleCreateInvite}\n                  disabled={createInviteMutation.isPending}\n                  data-testid=\"button-submit-invite\"\n                >\n                  {createInviteMutation.isPending ? \"Creating...\" : \"Create Invite\"}\n                </Button>\n              </DialogFooter>\n            </DialogContent>\n          </Dialog>\n        </div>\n      </CardHeader>\n      <CardContent>\n        {invites.length === 0 ? (\n          <p className=\"text-muted-foreground text-center py-4\">No pending invites</p>\n        ) : (\n          <div className=\"space-y-3\">\n            {invites.map((invite) => (\n              <div\n                key={invite.id}\n                className=\"flex items-center justify-between p-4 rounded-lg border\"\n                data-testid={`invite-item-${invite.id}`}\n              >\n                <div className=\"flex-1\">\n                  <p className=\"font-medium\">{invite.email}</p>\n                  <div className=\"flex items-center gap-2 mt-1\">\n                    <Badge variant=\"outline\">{invite.role}</Badge>\n                    <Badge variant={invite.status === \"pending\" ? \"default\" : \"secondary\"}>\n                      {invite.status}\n                    </Badge>\n                    <span className=\"text-xs text-muted-foreground\">\n                      Expires: {new Date(invite.expiresAt).toLocaleDateString()}\n                    </span>\n                  </div>\n                </div>\n                <div className=\"flex gap-2\">\n                  <Button\n                    variant=\"outline\"\n                    size=\"sm\"\n                    onClick={() => copyInviteLink(invite.token)}\n                    data-testid={`button-copy-invite-${invite.id}`}\n                  >\n                    {copiedToken === invite.token ? (\n                      <Check className=\"h-4 w-4\" />\n                    ) : (\n                      <Copy className=\"h-4 w-4\" />\n                    )}\n                  </Button>\n                  <Button\n                    variant=\"destructive\"\n                    size=\"sm\"\n                    onClick={() => deleteInviteMutation.mutate(invite.id)}\n                    data-testid={`button-delete-invite-${invite.id}`}\n                  >\n                    <Trash2 className=\"h-4 w-4\" />\n                  </Button>\n                </div>\n              </div>\n            ))}\n          </div>\n        )}\n      </CardContent>\n    </Card>\n  );\n}\n\nfunction SubscriptionManagement() {\n  const { toast } = useToast();\n  const { data: tenant, isLoading } = useQuery<Tenant>({\n    queryKey: [\"/api/tenant\"],\n  });\n\n  const upgradeMutation = useMutation({\n    mutationFn: async (plan: string) => {\n      const response = await apiRequest(\"/api/subscriptions/create-checkout\", \"POST\", { plan });\n      return response;\n    },\n    onSuccess: (data: { url: string }) => {\n      window.location.href = data.url;\n    },\n    onError: () => {\n      toast({ title: \"Error\", description: \"Failed to start checkout\", variant: \"destructive\" });\n    },\n  });\n\n  const portalMutation = useMutation({\n    mutationFn: async () => {\n      const response = await apiRequest(\"/api/subscriptions/create-portal\", \"POST\", {});\n      return response;\n    },\n    onSuccess: (data: { url: string }) => {\n      window.location.href = data.url;\n    },\n    onError: () => {\n      toast({ title: \"Error\", description: \"Failed to open billing portal\", variant: \"destructive\" });\n    },\n  });\n\n  const plans = [\n    {\n      name: \"Starter\",\n      value: \"starter\",\n      price: \"$29\",\n      icon: Zap,\n      features: [\n        \"Up to 10 staff members\",\n        \"Basic analytics\",\n        \"Email support\",\n        \"1 GB file storage\",\n      ],\n    },\n    {\n      name: \"Growth\",\n      value: \"growth\",\n      price: \"$99\",\n      icon: Rocket,\n      features: [\n        \"Up to 50 staff members\",\n        \"Advanced analytics\",\n        \"Priority support\",\n        \"10 GB file storage\",\n        \"Social media integration\",\n      ],\n    },\n    {\n      name: \"Enterprise\",\n      value: \"enterprise\",\n      price: \"$299\",\n      icon: Crown,\n      features: [\n        \"Unlimited staff members\",\n        \"Custom analytics\",\n        \"Dedicated support\",\n        \"Unlimited storage\",\n        \"Full social media suite\",\n        \"API access\",\n      ],\n    },\n  ];\n\n  const currentPlan = tenant?.subscriptionPlan || \"starter\";\n  const subscriptionStatus = tenant?.subscriptionStatus || \"active\";\n\n  return (\n    <Card>\n      <CardHeader>\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <CardTitle className=\"text-lg font-heading\">Subscription Plan</CardTitle>\n            <CardDescription>Manage your subscription and billing</CardDescription>\n          </div>\n          {tenant?.stripeCustomerId && (\n            <Button\n              variant=\"outline\"\n              onClick={() => portalMutation.mutate()}\n              disabled={portalMutation.isPending}\n              data-testid=\"button-billing-portal\"\n            >\n              {portalMutation.isPending ? \"Loading...\" : \"Manage Billing\"}\n            </Button>\n          )}\n        </div>\n      </CardHeader>\n      <CardContent>\n        {isLoading ? (\n          <div className=\"space-y-4\">\n            <Skeleton className=\"h-32 w-full\" />\n          </div>\n        ) : (\n          <div className=\"space-y-6\">\n            <div className=\"flex items-center gap-3\">\n              <Badge variant={subscriptionStatus === \"active\" ? \"default\" : \"destructive\"}>\n                {subscriptionStatus.charAt(0).toUpperCase() + subscriptionStatus.slice(1)}\n              </Badge>\n              <span className=\"text-sm text-muted-foreground\">\n                Current plan: <span className=\"font-semibold text-foreground\">{currentPlan.charAt(0).toUpperCase() + currentPlan.slice(1)}</span>\n              </span>\n            </div>\n\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n              {plans.map((plan) => {\n                const Icon = plan.icon;\n                const isCurrentPlan = currentPlan === plan.value;\n                \n                return (\n                  <div\n                    key={plan.value}\n                    className={`p-4 rounded-lg border-2 ${\n                      isCurrentPlan ? \"border-primary bg-primary/5\" : \"border-border\"\n                    }`}\n                  >\n                    <div className=\"flex items-center gap-2 mb-3\">\n                      <Icon className=\"w-5 h-5 text-primary\" />\n                      <h3 className=\"font-heading font-semibold\">{plan.name}</h3>\n                    </div>\n                    <div className=\"mb-4\">\n                      <span className=\"text-3xl font-bold\">{plan.price}</span>\n                      <span className=\"text-muted-foreground\">/mo</span>\n                    </div>\n                    <ul className=\"space-y-2 mb-4\">\n                      {plan.features.map((feature, idx) => (\n                        <li key={idx} className=\"text-sm text-muted-foreground flex items-start gap-2\">\n                          <Check className=\"w-4 h-4 text-primary mt-0.5 flex-shrink-0\" />\n                          <span>{feature}</span>\n                        </li>\n                      ))}\n                    </ul>\n                    <Button\n                      className=\"w-full\"\n                      variant={isCurrentPlan ? \"outline\" : \"default\"}\n                      disabled={isCurrentPlan || upgradeMutation.isPending}\n                      onClick={() => upgradeMutation.mutate(plan.value)}\n                      data-testid={`button-upgrade-${plan.value}`}\n                    >\n                      {isCurrentPlan ? \"Current Plan\" : upgradeMutation.isPending ? \"Loading...\" : \"Upgrade\"}\n                    </Button>\n                  </div>\n                );\n              })}\n            </div>\n          </div>\n        )}\n      </CardContent>\n    </Card>\n  );\n}\n\nexport default function Settings() {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  \n  const [name, setName] = useState(\"\");\n  const [clubTag, setClubTag] = useState(\"\");\n  const [website, setWebsite] = useState(\"\");\n  const [region, setRegion] = useState(\"\");\n  const [primaryColor, setPrimaryColor] = useState(\"#a855f7\");\n  const [logoUrl, setLogoUrl] = useState(\"\");\n\n  const { data: tenant, isLoading } = useQuery<Tenant>({\n    queryKey: [\"/api/tenant\"],\n  });\n\n  useEffect(() => {\n    if (tenant) {\n      setName(tenant.name || \"\");\n      setClubTag(tenant.clubTag || \"\");\n      setWebsite(tenant.website || \"\");\n      setRegion(tenant.region || \"\");\n      setPrimaryColor(tenant.primaryColor || \"#a855f7\");\n      setLogoUrl(tenant.logoUrl || \"\");\n    }\n  }, [tenant]);\n\n  // Sync subscription from Stripe checkout session\n  useEffect(() => {\n    const params = new URLSearchParams(window.location.search);\n    const sessionId = params.get('session_id');\n    \n    if (sessionId) {\n      // Clear the session_id from URL\n      window.history.replaceState({}, '', '/settings');\n      \n      // Sync the subscription - apiRequest throws on non-2xx\n      apiRequest('/api/subscriptions/sync-session', 'POST', { sessionId })\n        .then(() => {\n          // Success - apiRequest only resolves on 2xx responses\n          queryClient.invalidateQueries({ queryKey: ['/api/tenant'] });\n          toast({\n            title: 'Success',\n            description: 'Your subscription has been updated!',\n          });\n        })\n        .catch((error: Error) => {\n          // Error - apiRequest threw due to non-2xx or network error\n          console.error('Error syncing subscription:', error);\n          toast({\n            title: 'Error',\n            description: error.message || 'Failed to sync subscription. Please contact support.',\n            variant: 'destructive',\n          });\n        });\n    }\n  }, [queryClient, toast]);\n\n  const updateMutation = useMutation({\n    mutationFn: async (data: Partial<Tenant>) => {\n      return await apiRequest(\"/api/tenant\", \"PATCH\", data);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/tenant\"] });\n      toast({\n        title: \"Success\",\n        description: \"Settings updated successfully\",\n      });\n    },\n    onError: (error: Error) => {\n      if (isUnauthorizedError(error)) {\n        toast({\n          title: \"Unauthorized\",\n          description: \"You are logged out. Logging in again...\",\n          variant: \"destructive\",\n        });\n        setTimeout(() => {\n          window.location.href = \"/login\";\n        }, 500);\n        return;\n      }\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to update settings\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleSaveBranding = async () => {\n    await updateMutation.mutateAsync({\n      primaryColor,\n      logoUrl,\n    });\n  };\n\n  const handleSaveInfo = async () => {\n    await updateMutation.mutateAsync({\n      name,\n      clubTag,\n      website,\n      region,\n    });\n  };\n\n  return (\n    <div className=\"p-6 space-y-6\">\n      <div>\n        <h1 className=\"text-3xl font-heading font-bold mb-1\" data-testid=\"text-settings-title\">\n          Club Settings\n        </h1>\n        <p className=\"text-muted-foreground\">Customize your club's branding and preferences</p>\n      </div>\n\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"text-lg font-heading\">Club Branding</CardTitle>\n            <CardDescription>Upload your club logo and customize colors</CardDescription>\n          </CardHeader>\n          <CardContent className=\"space-y-6\">\n            {isLoading ? (\n              <div className=\"space-y-4\">\n                <Skeleton className=\"h-20 w-full\" />\n                <Skeleton className=\"h-12 w-full\" />\n                <Skeleton className=\"h-10 w-full\" />\n              </div>\n            ) : (\n              <>\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"logo-upload\">Club Logo</Label>\n                  <div className=\"flex items-center gap-4\">\n                    <div className=\"w-20 h-20 rounded-lg bg-primary flex items-center justify-center\">\n                      {logoUrl ? (\n                        <img src={logoUrl} alt=\"Club logo\" className=\"w-full h-full object-cover rounded-lg\" />\n                      ) : (\n                        <span className=\"text-primary-foreground font-heading font-bold text-3xl\">\n                          {clubTag?.charAt(0) || \"N\"}\n                        </span>\n                      )}\n                    </div>\n                    <div className=\"flex-1\">\n                      <Input\n                        id=\"logo-url\"\n                        placeholder=\"https://example.com/logo.png\"\n                        value={logoUrl}\n                        onChange={(e) => setLogoUrl(e.target.value)}\n                        data-testid=\"input-logo-url\"\n                      />\n                    </div>\n                  </div>\n                  <p className=\"text-xs text-muted-foreground\">\n                    Recommended: PNG or SVG, 512x512px minimum\n                  </p>\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"primary-color\">Primary Brand Color</Label>\n                  <div className=\"flex items-center gap-3\">\n                    <div \n                      className=\"w-12 h-12 rounded-lg border-2 border-border cursor-pointer\"\n                      style={{ backgroundColor: primaryColor }}\n                    />\n                    <Input\n                      id=\"primary-color\"\n                      type=\"color\"\n                      value={primaryColor}\n                      onChange={(e) => setPrimaryColor(e.target.value)}\n                      className=\"w-24 h-12\"\n                      data-testid=\"input-primary-color\"\n                    />\n                    <span className=\"font-mono text-sm text-muted-foreground\">{primaryColor}</span>\n                  </div>\n                </div>\n\n                <Button \n                  className=\"w-full\" \n                  onClick={handleSaveBranding}\n                  disabled={updateMutation.isPending}\n                  data-testid=\"button-save-branding\"\n                >\n                  {updateMutation.isPending ? \"Saving...\" : \"Save Branding Changes\"}\n                </Button>\n              </>\n            )}\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"text-lg font-heading\">Club Information</CardTitle>\n            <CardDescription>Update your club's basic information</CardDescription>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            {isLoading ? (\n              <div className=\"space-y-4\">\n                <Skeleton className=\"h-10 w-full\" />\n                <Skeleton className=\"h-10 w-full\" />\n                <Skeleton className=\"h-10 w-full\" />\n                <Skeleton className=\"h-10 w-full\" />\n              </div>\n            ) : (\n              <>\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"club-name\">Club Name</Label>\n                  <Input\n                    id=\"club-name\"\n                    value={name}\n                    onChange={(e) => setName(e.target.value)}\n                    data-testid=\"input-club-name\"\n                  />\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"club-tag\">Club Tag</Label>\n                  <Input\n                    id=\"club-tag\"\n                    value={clubTag}\n                    onChange={(e) => setClubTag(e.target.value)}\n                    maxLength={5}\n                    data-testid=\"input-club-tag\"\n                  />\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"club-website\">Website</Label>\n                  <Input\n                    id=\"club-website\"\n                    type=\"url\"\n                    value={website}\n                    onChange={(e) => setWebsite(e.target.value)}\n                    placeholder=\"https://nexus.gg\"\n                    data-testid=\"input-club-website\"\n                  />\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"club-region\">Region</Label>\n                  <Input\n                    id=\"club-region\"\n                    value={region}\n                    onChange={(e) => setRegion(e.target.value)}\n                    data-testid=\"input-club-region\"\n                  />\n                </div>\n\n                <Button \n                  className=\"w-full\" \n                  onClick={handleSaveInfo}\n                  disabled={updateMutation.isPending}\n                  data-testid=\"button-save-info\"\n                >\n                  {updateMutation.isPending ? \"Saving...\" : \"Save Information\"}\n                </Button>\n              </>\n            )}\n          </CardContent>\n        </Card>\n      </div>\n\n      <SubscriptionManagement />\n      \n      <InviteManagement />\n\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"text-lg font-heading\">Social Media Connections</CardTitle>\n          <CardDescription>Connect your social media accounts for Marcom analytics</CardDescription>\n        </CardHeader>\n        <CardContent className=\"space-y-3\">\n          {['Twitter/X', 'Instagram', 'YouTube', 'TikTok', 'Twitch'].map((platform) => (\n            <div key={platform} className=\"flex items-center justify-between p-4 rounded-lg border border-border\">\n              <div>\n                <p className=\"font-semibold\">{platform}</p>\n                <p className=\"text-sm text-muted-foreground\">Not connected</p>\n              </div>\n              <Button variant=\"outline\" size=\"sm\" data-testid={`button-connect-${platform.toLowerCase().replace('/', '-')}`}>\n                Connect\n              </Button>\n            </div>\n          ))}\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":23480},"client/src/components/ui/command.tsx":{"content":"import * as React from \"react\"\nimport { type DialogProps } from \"@radix-ui/react-dialog\"\nimport { Command as CommandPrimitive } from \"cmdk\"\nimport { Search } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Dialog, DialogContent } from \"@/components/ui/dialog\"\n\nconst Command = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nCommand.displayName = CommandPrimitive.displayName\n\nconst CommandDialog = ({ children, ...props }: DialogProps) => {\n  return (\n    <Dialog {...props}>\n      <DialogContent className=\"overflow-hidden p-0 shadow-lg\">\n        <Command className=\"[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5\">\n          {children}\n        </Command>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nconst CommandInput = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Input>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Input>\n>(({ className, ...props }, ref) => (\n  <div className=\"flex items-center border-b px-3\" cmdk-input-wrapper=\"\">\n    <Search className=\"mr-2 h-4 w-4 shrink-0 opacity-50\" />\n    <CommandPrimitive.Input\n      ref={ref}\n      className={cn(\n        \"flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    />\n  </div>\n))\n\nCommandInput.displayName = CommandPrimitive.Input.displayName\n\nconst CommandList = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.List\n    ref={ref}\n    className={cn(\"max-h-[300px] overflow-y-auto overflow-x-hidden\", className)}\n    {...props}\n  />\n))\n\nCommandList.displayName = CommandPrimitive.List.displayName\n\nconst CommandEmpty = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Empty>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Empty>\n>((props, ref) => (\n  <CommandPrimitive.Empty\n    ref={ref}\n    className=\"py-6 text-center text-sm\"\n    {...props}\n  />\n))\n\nCommandEmpty.displayName = CommandPrimitive.Empty.displayName\n\nconst CommandGroup = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Group>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Group>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Group\n    ref={ref}\n    className={cn(\n      \"overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandGroup.displayName = CommandPrimitive.Group.displayName\n\nconst CommandSeparator = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nCommandSeparator.displayName = CommandPrimitive.Separator.displayName\n\nconst CommandItem = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandItem.displayName = CommandPrimitive.Item.displayName\n\nconst CommandShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nCommandShortcut.displayName = \"CommandShortcut\"\n\nexport {\n  Command,\n  CommandDialog,\n  CommandInput,\n  CommandList,\n  CommandEmpty,\n  CommandGroup,\n  CommandItem,\n  CommandShortcut,\n  CommandSeparator,\n}\n","size_bytes":4885},"client/src/components/ui/hover-card.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as HoverCardPrimitive from \"@radix-ui/react-hover-card\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst HoverCard = HoverCardPrimitive.Root\n\nconst HoverCardTrigger = HoverCardPrimitive.Trigger\n\nconst HoverCardContent = React.forwardRef<\n  React.ElementRef<typeof HoverCardPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof HoverCardPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <HoverCardPrimitive.Content\n    ref={ref}\n    align={align}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 w-64 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-hover-card-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nHoverCardContent.displayName = HoverCardPrimitive.Content.displayName\n\nexport { HoverCard, HoverCardTrigger, HoverCardContent }\n","size_bytes":1251},"server/index.ts":{"content":"import express, { type Request, Response, NextFunction } from \"express\";\nimport { registerRoutes } from \"./routes\";\nimport { setupVite, serveStatic, log } from \"./vite\";\n\nconst app = express();\napp.use(express.json());\napp.use(express.urlencoded({ extended: false }));\n\napp.use((req, res, next) => {\n  const start = Date.now();\n  const path = req.path;\n  let capturedJsonResponse: Record<string, any> | undefined = undefined;\n\n  const originalResJson = res.json;\n  res.json = function (bodyJson, ...args) {\n    capturedJsonResponse = bodyJson;\n    return originalResJson.apply(res, [bodyJson, ...args]);\n  };\n\n  res.on(\"finish\", () => {\n    const duration = Date.now() - start;\n    if (path.startsWith(\"/api\")) {\n      let logLine = `${req.method} ${path} ${res.statusCode} in ${duration}ms`;\n      if (capturedJsonResponse) {\n        logLine += ` :: ${JSON.stringify(capturedJsonResponse)}`;\n      }\n\n      if (logLine.length > 80) {\n        logLine = logLine.slice(0, 79) + \"\";\n      }\n\n      log(logLine);\n    }\n  });\n\n  next();\n});\n\n(async () => {\n  const server = await registerRoutes(app);\n\n  app.use((err: any, _req: Request, res: Response, _next: NextFunction) => {\n    const status = err.status || err.statusCode || 500;\n    const message = err.message || \"Internal Server Error\";\n\n    res.status(status).json({ message });\n    throw err;\n  });\n\n  // importantly only setup vite in development and after\n  // setting up all the other routes so the catch-all route\n  // doesn't interfere with the other routes\n  if (app.get(\"env\") === \"development\") {\n    await setupVite(app, server);\n  } else {\n    serveStatic(app);\n  }\n\n  // ALWAYS serve the app on the port specified in the environment variable PORT\n  // Other ports are firewalled. Default to 5000 if not specified.\n  // this serves both the API and the client.\n  // It is the only port that is not firewalled.\n  const port = parseInt(process.env.PORT || '5000', 10);\n  server.listen({\n    port,\n    host: \"0.0.0.0\",\n    reusePort: true,\n  }, () => {\n    log(`serving on port ${port}`);\n  });\n})();\n","size_bytes":2066},"client/src/components/ui/radio-group.tsx":{"content":"import * as React from \"react\"\nimport * as RadioGroupPrimitive from \"@radix-ui/react-radio-group\"\nimport { Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst RadioGroup = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Root\n      className={cn(\"grid gap-2\", className)}\n      {...props}\n      ref={ref}\n    />\n  )\n})\nRadioGroup.displayName = RadioGroupPrimitive.Root.displayName\n\nconst RadioGroupItem = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Item>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        \"aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    >\n      <RadioGroupPrimitive.Indicator className=\"flex items-center justify-center\">\n        <Circle className=\"h-2.5 w-2.5 fill-current text-current\" />\n      </RadioGroupPrimitive.Indicator>\n    </RadioGroupPrimitive.Item>\n  )\n})\nRadioGroupItem.displayName = RadioGroupPrimitive.Item.displayName\n\nexport { RadioGroup, RadioGroupItem }\n","size_bytes":1467},"client/src/components/ui/card.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"shadcn-card rounded-xl border bg-card border-card-border text-card-foreground shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n));\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n    {...props}\n  />\n));\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"text-2xl font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n));\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-6 pt-0\", className)}\n    {...props}\n  />\n))\nCardFooter.displayName = \"CardFooter\"\nexport {\n  Card,\n  CardHeader,\n  CardFooter,\n  CardTitle,\n  CardDescription,\n  CardContent,\n}\n","size_bytes":1904},"server/storage.ts":{"content":"import {\n  users,\n  tenants,\n  staff,\n  payroll,\n  matches,\n  campaigns,\n  contracts,\n  auditLogs,\n  invites,\n  socialAccounts,\n  socialMetrics,\n  type User,\n  type UpsertUser,\n  type Tenant,\n  type InsertTenant,\n  type Staff,\n  type InsertStaff,\n  type Payroll,\n  type InsertPayroll,\n  type Match,\n  type InsertMatch,\n  type Campaign,\n  type InsertCampaign,\n  type Contract,\n  type InsertContract,\n  type AuditLog,\n  type InsertAuditLog,\n  type Invite,\n  type InsertInvite,\n  type SocialAccount,\n  type InsertSocialAccount,\n  type SocialMetric,\n  type InsertSocialMetric,\n  transactions,\n  type Transaction,\n  type InsertTransaction,\n  tournaments,\n  type Tournament,\n  type InsertTournament,\n  tournamentRounds,\n  type TournamentRound,\n  type InsertTournamentRound,\n} from \"@shared/schema\";\nimport { db } from \"./db\";\nimport { eq, and, desc } from \"drizzle-orm\";\n\nexport interface IStorage {\n  // User operations - Required for Replit Auth\n  getUser(id: string): Promise<User | undefined>;\n  getUserByEmail(email: string): Promise<User | undefined>;\n  createUser(userData: UpsertUser): Promise<User>;\n  updateUser(id: string, userData: Partial<UpsertUser>): Promise<User>;\n  upsertUser(user: UpsertUser & { tenantId?: string }): Promise<User>;\n\n  // Tenant operations\n  getTenant(id: string): Promise<Tenant | undefined>;\n  createTenant(tenant: InsertTenant): Promise<Tenant>;\n  updateTenant(id: string, tenant: Partial<InsertTenant>): Promise<Tenant>;\n\n  // Staff operations\n  getStaffByTenant(tenantId: string): Promise<Staff[]>;\n  getStaff(id: string, tenantId: string): Promise<Staff | undefined>;\n  createStaff(staff: InsertStaff): Promise<Staff>;\n  updateStaff(id: string, tenantId: string, staff: Partial<InsertStaff>): Promise<Staff>;\n  deleteStaff(id: string, tenantId: string): Promise<void>;\n\n  // Payroll operations\n  getPayrollByTenant(tenantId: string): Promise<Payroll[]>;\n  getPayroll(id: string, tenantId: string): Promise<Payroll | undefined>;\n  createPayroll(payroll: InsertPayroll): Promise<Payroll>;\n  updatePayroll(id: string, tenantId: string, payroll: Partial<InsertPayroll>): Promise<Payroll>;\n  deletePayroll(id: string, tenantId: string): Promise<void>;\n\n  // Tournament operations\n  getTournamentsByTenant(tenantId: string): Promise<Tournament[]>;\n  getTournament(id: string, tenantId: string): Promise<Tournament | undefined>;\n  createTournament(tournament: InsertTournament): Promise<Tournament>;\n  updateTournament(id: string, tenantId: string, tournament: Partial<InsertTournament>): Promise<Tournament>;\n  deleteTournament(id: string, tenantId: string): Promise<void>;\n\n  // Tournament Round operations\n  getRoundsByTournament(tournamentId: string): Promise<TournamentRound[]>;\n  getRound(id: string, tournamentId: string): Promise<TournamentRound | undefined>;\n  createRound(round: InsertTournamentRound): Promise<TournamentRound>;\n  updateRound(id: string, tournamentId: string, round: Partial<InsertTournamentRound>): Promise<TournamentRound>;\n  deleteRound(id: string, tournamentId: string): Promise<void>;\n\n  // Match operations\n  getMatchesByTenant(tenantId: string): Promise<Match[]>;\n  getMatchesByTournament(tournamentId: string): Promise<Match[]>;\n  getMatchesByRound(roundId: string): Promise<Match[]>;\n  getMatch(id: string, tenantId: string): Promise<Match | undefined>;\n  createMatch(match: InsertMatch): Promise<Match>;\n  updateMatch(id: string, tenantId: string, match: Partial<InsertMatch>): Promise<Match>;\n  deleteMatch(id: string, tenantId: string): Promise<void>;\n\n  // Campaign operations\n  getCampaignsByTenant(tenantId: string): Promise<Campaign[]>;\n  getCampaign(id: string, tenantId: string): Promise<Campaign | undefined>;\n  createCampaign(campaign: InsertCampaign): Promise<Campaign>;\n  updateCampaign(id: string, tenantId: string, campaign: Partial<InsertCampaign>): Promise<Campaign>;\n  deleteCampaign(id: string, tenantId: string): Promise<void>;\n\n  // Contract operations\n  getContractsByTenant(tenantId: string): Promise<Contract[]>;\n  getContract(id: string, tenantId: string): Promise<Contract | undefined>;\n  createContract(contract: InsertContract): Promise<Contract>;\n  updateContract(id: string, tenantId: string, contract: Partial<InsertContract>): Promise<Contract>;\n  deleteContract(id: string, tenantId: string): Promise<void>;\n\n  // Audit log operations\n  getAuditLogsByTenant(tenantId: string, limit?: number): Promise<AuditLog[]>;\n  createAuditLog(log: InsertAuditLog): Promise<AuditLog>;\n\n  // Super Admin operations\n  getAllTenants(): Promise<Tenant[]>;\n  updateTenantAdmin(id: string, tenant: Partial<InsertTenant>): Promise<Tenant>;\n  deleteTenant(id: string): Promise<void>;\n  getAllUsers(): Promise<User[]>;\n  updateUserAdmin(id: string, user: Partial<UpsertUser>): Promise<User>;\n  \n  // Stripe operations\n  updateTenantStripe(id: string, stripeData: Partial<Pick<Tenant, 'stripeCustomerId' | 'stripeSubscriptionId' | 'subscriptionPlan' | 'subscriptionStatus'>>): Promise<Tenant>;\n\n  // Invite operations\n  getInvitesByTenant(tenantId: string): Promise<Invite[]>;\n  getInviteByToken(token: string): Promise<Invite | undefined>;\n  createInvite(invite: InsertInvite): Promise<Invite>;\n  updateInviteStatus(token: string, status: \"pending\" | \"accepted\" | \"expired\"): Promise<Invite>;\n  deleteInvite(id: string, tenantId: string): Promise<void>;\n\n  // Social Media operations\n  getSocialAccountsByTenant(tenantId: string): Promise<SocialAccount[]>;\n  getSocialAccount(id: string, tenantId: string): Promise<SocialAccount | undefined>;\n  createSocialAccount(account: InsertSocialAccount): Promise<SocialAccount>;\n  updateSocialAccount(id: string, tenantId: string, account: Partial<InsertSocialAccount>): Promise<SocialAccount>;\n  deleteSocialAccount(id: string, tenantId: string): Promise<void>;\n  \n  getSocialMetricsByTenant(tenantId: string, limit?: number): Promise<SocialMetric[]>;\n  getSocialMetricsByAccount(accountId: string, limit?: number): Promise<SocialMetric[]>;\n  createSocialMetric(metric: InsertSocialMetric): Promise<SocialMetric>;\n  getLatestMetricsByTenant(tenantId: string): Promise<SocialMetric[]>;\n\n  // Finance operations\n  getTransactionsByTenant(tenantId: string): Promise<Transaction[]>;\n  getTransaction(id: string, tenantId: string): Promise<Transaction | undefined>;\n  createTransaction(transaction: InsertTransaction): Promise<Transaction>;\n  updateTransaction(id: string, tenantId: string, transaction: Partial<InsertTransaction>): Promise<Transaction>;\n  deleteTransaction(id: string, tenantId: string): Promise<void>;\n}\n\nexport class DatabaseStorage implements IStorage {\n  // User operations\n  async getUser(id: string): Promise<User | undefined> {\n    const [user] = await db.select().from(users).where(eq(users.id, id));\n    return user;\n  }\n\n  async getUserByEmail(email: string): Promise<User | undefined> {\n    const [user] = await db.select().from(users).where(eq(users.email, email));\n    return user;\n  }\n\n  async createUser(userData: UpsertUser): Promise<User> {\n    const [user] = await db.insert(users).values(userData).returning();\n    return user;\n  }\n\n  async updateUser(id: string, userData: Partial<UpsertUser>): Promise<User> {\n    const [user] = await db\n      .update(users)\n      .set({ ...userData, updatedAt: new Date() })\n      .where(eq(users.id, id))\n      .returning();\n    return user;\n  }\n\n  async upsertUser(userData: UpsertUser & { tenantId?: string }): Promise<User> {\n    // First try to get existing user\n    const existingUser = await this.getUser(userData.id!);\n    \n    // If user doesn't exist, create tenant first\n    if (!existingUser) {\n      const tenantData: InsertTenant = {\n        name: `${userData.firstName || userData.email?.split('@')[0] || 'Club'}'s Esports Club`,\n        clubTag: userData.email?.substring(0, 3).toUpperCase() || 'NXS',\n      };\n      const tenant = await this.createTenant(tenantData);\n      userData.tenantId = tenant.id;\n    }\n\n    const [user] = await db\n      .insert(users)\n      .values(userData)\n      .onConflictDoUpdate({\n        target: users.id,\n        set: {\n          email: userData.email,\n          firstName: userData.firstName,\n          lastName: userData.lastName,\n          profileImageUrl: userData.profileImageUrl,\n          updatedAt: new Date(),\n        },\n      })\n      .returning();\n    return user;\n  }\n\n  // Tenant operations\n  async getTenant(id: string): Promise<Tenant | undefined> {\n    const [tenant] = await db.select().from(tenants).where(eq(tenants.id, id));\n    return tenant;\n  }\n\n  async createTenant(tenantData: InsertTenant): Promise<Tenant> {\n    const [tenant] = await db.insert(tenants).values(tenantData).returning();\n    return tenant;\n  }\n\n  async updateTenant(id: string, tenantData: Partial<InsertTenant>): Promise<Tenant> {\n    const [tenant] = await db\n      .update(tenants)\n      .set({ ...tenantData, updatedAt: new Date() })\n      .where(eq(tenants.id, id))\n      .returning();\n    return tenant;\n  }\n\n  // Staff operations\n  async getStaffByTenant(tenantId: string): Promise<Staff[]> {\n    return db.select().from(staff).where(eq(staff.tenantId, tenantId));\n  }\n\n  async getStaff(id: string, tenantId: string): Promise<Staff | undefined> {\n    const [staffMember] = await db\n      .select()\n      .from(staff)\n      .where(and(eq(staff.id, id), eq(staff.tenantId, tenantId)));\n    return staffMember;\n  }\n\n  async createStaff(staffData: InsertStaff): Promise<Staff> {\n    const [staffMember] = await db.insert(staff).values({\n      ...staffData,\n      permissions: staffData.permissions as any,\n    }).returning();\n    return staffMember;\n  }\n\n  async updateStaff(id: string, tenantId: string, staffData: Partial<InsertStaff>): Promise<Staff> {\n    const updateData: any = { ...staffData, updatedAt: new Date() };\n    if (staffData.permissions) {\n      updateData.permissions = staffData.permissions as any;\n    }\n    const [staffMember] = await db\n      .update(staff)\n      .set(updateData)\n      .where(and(eq(staff.id, id), eq(staff.tenantId, tenantId)))\n      .returning();\n    return staffMember;\n  }\n\n  async deleteStaff(id: string, tenantId: string): Promise<void> {\n    await db.delete(staff).where(and(eq(staff.id, id), eq(staff.tenantId, tenantId)));\n  }\n\n  // Payroll operations\n  async getPayrollByTenant(tenantId: string): Promise<Payroll[]> {\n    return db.select().from(payroll).where(eq(payroll.tenantId, tenantId)).orderBy(desc(payroll.date));\n  }\n\n  async getPayroll(id: string, tenantId: string): Promise<Payroll | undefined> {\n    const [payrollEntry] = await db\n      .select()\n      .from(payroll)\n      .where(and(eq(payroll.id, id), eq(payroll.tenantId, tenantId)));\n    return payrollEntry;\n  }\n\n  async createPayroll(payrollData: InsertPayroll): Promise<Payroll> {\n    const [payrollEntry] = await db.insert(payroll).values(payrollData).returning();\n    return payrollEntry;\n  }\n\n  async updatePayroll(id: string, tenantId: string, payrollData: Partial<InsertPayroll>): Promise<Payroll> {\n    const [payrollEntry] = await db\n      .update(payroll)\n      .set({ ...payrollData, updatedAt: new Date() })\n      .where(and(eq(payroll.id, id), eq(payroll.tenantId, tenantId)))\n      .returning();\n    return payrollEntry;\n  }\n\n  async deletePayroll(id: string, tenantId: string): Promise<void> {\n    await db.delete(payroll).where(and(eq(payroll.id, id), eq(payroll.tenantId, tenantId)));\n  }\n\n  // Tournament operations\n  async getTournamentsByTenant(tenantId: string): Promise<Tournament[]> {\n    return db.select().from(tournaments).where(eq(tournaments.tenantId, tenantId)).orderBy(desc(tournaments.startDate));\n  }\n\n  async getTournament(id: string, tenantId: string): Promise<Tournament | undefined> {\n    const [tournament] = await db\n      .select()\n      .from(tournaments)\n      .where(and(eq(tournaments.id, id), eq(tournaments.tenantId, tenantId)));\n    return tournament;\n  }\n\n  async createTournament(tournamentData: InsertTournament): Promise<Tournament> {\n    const [tournament] = await db.insert(tournaments).values(tournamentData).returning();\n    return tournament;\n  }\n\n  async updateTournament(id: string, tenantId: string, tournamentData: Partial<InsertTournament>): Promise<Tournament> {\n    const [tournament] = await db\n      .update(tournaments)\n      .set({ ...tournamentData, updatedAt: new Date() })\n      .where(and(eq(tournaments.id, id), eq(tournaments.tenantId, tenantId)))\n      .returning();\n    return tournament;\n  }\n\n  async deleteTournament(id: string, tenantId: string): Promise<void> {\n    // Delete associated rounds and matches first\n    const rounds = await this.getRoundsByTournament(id);\n    for (const round of rounds) {\n      await this.deleteRound(round.id, id);\n    }\n    // Delete matches directly associated with tournament\n    await db.delete(matches).where(eq(matches.tournamentId, id));\n    // Delete tournament\n    await db.delete(tournaments).where(and(eq(tournaments.id, id), eq(tournaments.tenantId, tenantId)));\n  }\n\n  // Tournament Round operations\n  async getRoundsByTournament(tournamentId: string): Promise<TournamentRound[]> {\n    return db.select().from(tournamentRounds).where(eq(tournamentRounds.tournamentId, tournamentId)).orderBy(tournamentRounds.roundNumber);\n  }\n\n  async getRound(id: string, tournamentId: string): Promise<TournamentRound | undefined> {\n    const [round] = await db\n      .select()\n      .from(tournamentRounds)\n      .where(and(eq(tournamentRounds.id, id), eq(tournamentRounds.tournamentId, tournamentId)));\n    return round;\n  }\n\n  async createRound(roundData: InsertTournamentRound): Promise<TournamentRound> {\n    const [round] = await db.insert(tournamentRounds).values(roundData).returning();\n    return round;\n  }\n\n  async updateRound(id: string, tournamentId: string, roundData: Partial<InsertTournamentRound>): Promise<TournamentRound> {\n    const [round] = await db\n      .update(tournamentRounds)\n      .set(roundData)\n      .where(and(eq(tournamentRounds.id, id), eq(tournamentRounds.tournamentId, tournamentId)))\n      .returning();\n    return round;\n  }\n\n  async deleteRound(id: string, tournamentId: string): Promise<void> {\n    // Delete associated matches first\n    await db.delete(matches).where(eq(matches.roundId, id));\n    // Delete round\n    await db.delete(tournamentRounds).where(and(eq(tournamentRounds.id, id), eq(tournamentRounds.tournamentId, tournamentId)));\n  }\n\n  // Match operations\n  async getMatchesByTenant(tenantId: string): Promise<Match[]> {\n    return db.select().from(matches).where(eq(matches.tenantId, tenantId)).orderBy(desc(matches.date));\n  }\n\n  async getMatchesByTournament(tournamentId: string): Promise<Match[]> {\n    return db.select().from(matches).where(eq(matches.tournamentId, tournamentId)).orderBy(matches.matchNumber);\n  }\n\n  async getMatchesByRound(roundId: string): Promise<Match[]> {\n    return db.select().from(matches).where(eq(matches.roundId, roundId)).orderBy(matches.matchNumber);\n  }\n\n  async getMatch(id: string, tenantId: string): Promise<Match | undefined> {\n    const [match] = await db\n      .select()\n      .from(matches)\n      .where(and(eq(matches.id, id), eq(matches.tenantId, tenantId)));\n    return match;\n  }\n\n  async createMatch(matchData: InsertMatch): Promise<Match> {\n    const [match] = await db.insert(matches).values(matchData).returning();\n    return match;\n  }\n\n  async updateMatch(id: string, tenantId: string, matchData: Partial<InsertMatch>): Promise<Match> {\n    const [match] = await db\n      .update(matches)\n      .set({ ...matchData, updatedAt: new Date() })\n      .where(and(eq(matches.id, id), eq(matches.tenantId, tenantId)))\n      .returning();\n    return match;\n  }\n\n  async deleteMatch(id: string, tenantId: string): Promise<void> {\n    await db.delete(matches).where(and(eq(matches.id, id), eq(matches.tenantId, tenantId)));\n  }\n\n  // Campaign operations\n  async getCampaignsByTenant(tenantId: string): Promise<Campaign[]> {\n    return db.select().from(campaigns).where(eq(campaigns.tenantId, tenantId)).orderBy(desc(campaigns.startDate));\n  }\n\n  async getCampaign(id: string, tenantId: string): Promise<Campaign | undefined> {\n    const [campaign] = await db\n      .select()\n      .from(campaigns)\n      .where(and(eq(campaigns.id, id), eq(campaigns.tenantId, tenantId)));\n    return campaign;\n  }\n\n  async createCampaign(campaignData: InsertCampaign): Promise<Campaign> {\n    const [campaign] = await db.insert(campaigns).values({\n      ...campaignData,\n      platforms: campaignData.platforms as any,\n    }).returning();\n    return campaign;\n  }\n\n  async updateCampaign(id: string, tenantId: string, campaignData: Partial<InsertCampaign>): Promise<Campaign> {\n    const updateData: any = { ...campaignData, updatedAt: new Date() };\n    if (campaignData.platforms) {\n      updateData.platforms = campaignData.platforms as any;\n    }\n    const [campaign] = await db\n      .update(campaigns)\n      .set(updateData)\n      .where(and(eq(campaigns.id, id), eq(campaigns.tenantId, tenantId)))\n      .returning();\n    return campaign;\n  }\n\n  async deleteCampaign(id: string, tenantId: string): Promise<void> {\n    await db.delete(campaigns).where(and(eq(campaigns.id, id), eq(campaigns.tenantId, tenantId)));\n  }\n\n  // Contract operations\n  async getContractsByTenant(tenantId: string): Promise<Contract[]> {\n    return db.select().from(contracts).where(eq(contracts.tenantId, tenantId)).orderBy(desc(contracts.expirationDate));\n  }\n\n  async getContract(id: string, tenantId: string): Promise<Contract | undefined> {\n    const [contract] = await db\n      .select()\n      .from(contracts)\n      .where(and(eq(contracts.id, id), eq(contracts.tenantId, tenantId)));\n    return contract;\n  }\n\n  async createContract(contractData: InsertContract): Promise<Contract> {\n    const [contract] = await db.insert(contracts).values(contractData).returning();\n    return contract;\n  }\n\n  async updateContract(id: string, tenantId: string, contractData: Partial<InsertContract>): Promise<Contract> {\n    const [contract] = await db\n      .update(contracts)\n      .set({ ...contractData, updatedAt: new Date() })\n      .where(and(eq(contracts.id, id), eq(contracts.tenantId, tenantId)))\n      .returning();\n    return contract;\n  }\n\n  async deleteContract(id: string, tenantId: string): Promise<void> {\n    await db.delete(contracts).where(and(eq(contracts.id, id), eq(contracts.tenantId, tenantId)));\n  }\n\n  // Audit log operations\n  async getAuditLogsByTenant(tenantId: string, limit: number = 100): Promise<AuditLog[]> {\n    return db\n      .select()\n      .from(auditLogs)\n      .where(eq(auditLogs.tenantId, tenantId))\n      .orderBy(desc(auditLogs.timestamp))\n      .limit(limit);\n  }\n\n  async getAllAuditLogs(limit: number = 10000): Promise<AuditLog[]> {\n    return db\n      .select()\n      .from(auditLogs)\n      .orderBy(desc(auditLogs.timestamp))\n      .limit(limit);\n  }\n\n  async createAuditLog(logData: InsertAuditLog): Promise<AuditLog> {\n    const [log] = await db.insert(auditLogs).values(logData).returning();\n    return log;\n  }\n\n  // Super Admin operations\n  async getAllTenants(): Promise<Tenant[]> {\n    return db.select().from(tenants).orderBy(desc(tenants.createdAt));\n  }\n\n  async updateTenantAdmin(id: string, tenantData: Partial<InsertTenant>): Promise<Tenant> {\n    const [tenant] = await db\n      .update(tenants)\n      .set({ ...tenantData, updatedAt: new Date() })\n      .where(eq(tenants.id, id))\n      .returning();\n    return tenant;\n  }\n\n  async deleteTenant(id: string): Promise<void> {\n    await db.delete(tenants).where(eq(tenants.id, id));\n  }\n\n  async getAllUsers(): Promise<User[]> {\n    return db.select().from(users).orderBy(desc(users.createdAt));\n  }\n\n  async updateUserAdmin(id: string, userData: Partial<UpsertUser>): Promise<User> {\n    const [user] = await db\n      .update(users)\n      .set({ ...userData, updatedAt: new Date() })\n      .where(eq(users.id, id))\n      .returning();\n    return user;\n  }\n  \n  // Stripe operations\n  async updateTenantStripe(id: string, stripeData: Partial<Pick<Tenant, 'stripeCustomerId' | 'stripeSubscriptionId' | 'subscriptionPlan' | 'subscriptionStatus'>>): Promise<Tenant> {\n    const [tenant] = await db\n      .update(tenants)\n      .set({ ...stripeData, updatedAt: new Date() })\n      .where(eq(tenants.id, id))\n      .returning();\n    return tenant;\n  }\n\n  // Invite operations\n  async getInvitesByTenant(tenantId: string): Promise<Invite[]> {\n    return db.select().from(invites).where(eq(invites.tenantId, tenantId)).orderBy(desc(invites.createdAt));\n  }\n\n  async getInviteByToken(token: string): Promise<Invite | undefined> {\n    const [invite] = await db.select().from(invites).where(eq(invites.token, token));\n    return invite;\n  }\n\n  async createInvite(inviteData: InsertInvite): Promise<Invite> {\n    const [invite] = await db.insert(invites).values({\n      ...inviteData,\n      permissions: inviteData.permissions as any,\n    }).returning();\n    return invite;\n  }\n\n  async updateInviteStatus(token: string, status: \"pending\" | \"accepted\" | \"expired\"): Promise<Invite> {\n    const [invite] = await db\n      .update(invites)\n      .set({ status })\n      .where(eq(invites.token, token))\n      .returning();\n    return invite;\n  }\n\n  async deleteInvite(id: string, tenantId: string): Promise<void> {\n    await db.delete(invites).where(and(eq(invites.id, id), eq(invites.tenantId, tenantId)));\n  }\n\n  async getAllInvites(): Promise<Invite[]> {\n    return db.select().from(invites).orderBy(desc(invites.createdAt));\n  }\n\n  // Social Media operations\n  async getSocialAccountsByTenant(tenantId: string): Promise<SocialAccount[]> {\n    return db.select().from(socialAccounts)\n      .where(eq(socialAccounts.tenantId, tenantId))\n      .orderBy(desc(socialAccounts.createdAt));\n  }\n\n  async getSocialAccount(id: string, tenantId: string): Promise<SocialAccount | undefined> {\n    const [account] = await db.select().from(socialAccounts)\n      .where(and(eq(socialAccounts.id, id), eq(socialAccounts.tenantId, tenantId)));\n    return account;\n  }\n\n  async createSocialAccount(account: InsertSocialAccount): Promise<SocialAccount> {\n    const [newAccount] = await db.insert(socialAccounts).values(account).returning();\n    return newAccount;\n  }\n\n  async updateSocialAccount(id: string, tenantId: string, account: Partial<InsertSocialAccount>): Promise<SocialAccount> {\n    const existing = await this.getSocialAccount(id, tenantId);\n    if (!existing) {\n      throw new Error(\"Social account not found\");\n    }\n    \n    const [updated] = await db.update(socialAccounts)\n      .set({ ...account, updatedAt: new Date() })\n      .where(and(eq(socialAccounts.id, id), eq(socialAccounts.tenantId, tenantId)))\n      .returning();\n    return updated;\n  }\n\n  async deleteSocialAccount(id: string, tenantId: string): Promise<void> {\n    await db.delete(socialAccounts).where(and(eq(socialAccounts.id, id), eq(socialAccounts.tenantId, tenantId)));\n  }\n\n  async getSocialMetricsByTenant(tenantId: string, limit: number = 100): Promise<SocialMetric[]> {\n    return db.select().from(socialMetrics)\n      .where(eq(socialMetrics.tenantId, tenantId))\n      .orderBy(desc(socialMetrics.date))\n      .limit(limit);\n  }\n\n  async getSocialMetricsByAccount(accountId: string, limit: number = 30): Promise<SocialMetric[]> {\n    return db.select().from(socialMetrics)\n      .where(eq(socialMetrics.accountId, accountId))\n      .orderBy(desc(socialMetrics.date))\n      .limit(limit);\n  }\n\n  async createSocialMetric(metric: InsertSocialMetric): Promise<SocialMetric> {\n    const [newMetric] = await db.insert(socialMetrics).values(metric).returning();\n    return newMetric;\n  }\n\n  async getLatestMetricsByTenant(tenantId: string): Promise<SocialMetric[]> {\n    // Get the latest metric for each social account\n    const accounts = await this.getSocialAccountsByTenant(tenantId);\n    const latestMetrics: SocialMetric[] = [];\n    \n    for (const account of accounts) {\n      const [latestMetric] = await db.select().from(socialMetrics)\n        .where(eq(socialMetrics.accountId, account.id))\n        .orderBy(desc(socialMetrics.date))\n        .limit(1);\n      if (latestMetric) {\n        latestMetrics.push(latestMetric);\n      }\n    }\n    \n    return latestMetrics;\n  }\n\n  // Super Admin export operations\n  async getAllStaff(): Promise<Staff[]> {\n    return db.select().from(staff).orderBy(desc(staff.createdAt));\n  }\n\n  async getAllPayroll(): Promise<Payroll[]> {\n    return db.select().from(payroll).orderBy(desc(payroll.date));\n  }\n\n  async getAllMatches(): Promise<Match[]> {\n    return db.select().from(matches).orderBy(desc(matches.date));\n  }\n\n  async getAllCampaigns(): Promise<Campaign[]> {\n    return db.select().from(campaigns).orderBy(desc(campaigns.createdAt));\n  }\n\n  async getAllContracts(): Promise<Contract[]> {\n    return db.select().from(contracts).orderBy(desc(contracts.createdAt));\n  }\n\n  // Finance operations\n  async getTransactionsByTenant(tenantId: string): Promise<Transaction[]> {\n    return db.select().from(transactions)\n      .where(eq(transactions.tenantId, tenantId))\n      .orderBy(desc(transactions.date));\n  }\n\n  async getTransaction(id: string, tenantId: string): Promise<Transaction | undefined> {\n    const [transaction] = await db.select().from(transactions)\n      .where(and(eq(transactions.id, id), eq(transactions.tenantId, tenantId)));\n    return transaction;\n  }\n\n  async createTransaction(transaction: InsertTransaction): Promise<Transaction> {\n    const [newTransaction] = await db.insert(transactions).values(transaction).returning();\n    return newTransaction;\n  }\n\n  async updateTransaction(id: string, tenantId: string, transactionData: Partial<InsertTransaction>): Promise<Transaction> {\n    const [transaction] = await db\n      .update(transactions)\n      .set({ ...transactionData, updatedAt: new Date() })\n      .where(and(eq(transactions.id, id), eq(transactions.tenantId, tenantId)))\n      .returning();\n    return transaction;\n  }\n\n  async deleteTransaction(id: string, tenantId: string): Promise<void> {\n    await db.delete(transactions).where(and(eq(transactions.id, id), eq(transactions.tenantId, tenantId)));\n  }\n}\n\nexport const storage = new DatabaseStorage();\n","size_bytes":26128},"client/src/components/ui/progress.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ProgressPrimitive from \"@radix-ui/react-progress\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Progress = React.forwardRef<\n  React.ElementRef<typeof ProgressPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ProgressPrimitive.Root>\n>(({ className, value, ...props }, ref) => (\n  <ProgressPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative h-4 w-full overflow-hidden rounded-full bg-secondary\",\n      className\n    )}\n    {...props}\n  >\n    <ProgressPrimitive.Indicator\n      className=\"h-full w-full flex-1 bg-primary transition-all\"\n      style={{ transform: `translateX(-${100 - (value || 0)}%)` }}\n    />\n  </ProgressPrimitive.Root>\n))\nProgress.displayName = ProgressPrimitive.Root.displayName\n\nexport { Progress }\n","size_bytes":791},"client/src/components/ui/avatar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as AvatarPrimitive from \"@radix-ui/react-avatar\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Avatar = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Root\n    ref={ref}\n    className={cn(`\n      after:content-[''] after:block after:absolute after:inset-0 after:rounded-full after:pointer-events-none after:border after:border-black/10 dark:after:border-white/10\n      relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full`,\n      className\n    )}\n    {...props}\n  />\n))\nAvatar.displayName = AvatarPrimitive.Root.displayName\n\nconst AvatarImage = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Image>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Image>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Image\n    ref={ref}\n    className={cn(\"aspect-square h-full w-full\", className)}\n    {...props}\n  />\n))\nAvatarImage.displayName = AvatarPrimitive.Image.displayName\n\nconst AvatarFallback = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Fallback>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Fallback>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Fallback\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full items-center justify-center rounded-full bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatarFallback.displayName = AvatarPrimitive.Fallback.displayName\n\nexport { Avatar, AvatarImage, AvatarFallback }\n","size_bytes":1592},"client/src/components/examples/StaffCard.tsx":{"content":"import { StaffCard } from \"../staff-card\";\n\nexport default function StaffCardExample() {\n  return (\n    <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 p-6 bg-background\">\n      <StaffCard\n        id=\"1\"\n        name=\"Sarah Johnson\"\n        role=\"Manager\"\n        email=\"sarah.j@nexus.gg\"\n        phone=\"+1 555-0123\"\n        permissions={['Staff', 'Payroll', 'Matches']}\n        status=\"active\"\n      />\n      <StaffCard\n        id=\"2\"\n        name=\"Mike Chen\"\n        role=\"Analyst\"\n        email=\"mike.c@nexus.gg\"\n        permissions={['Analytics', 'Matches']}\n        status=\"active\"\n      />\n      <StaffCard\n        id=\"3\"\n        name=\"Alex Rivera\"\n        role=\"Player\"\n        email=\"alex.r@nexus.gg\"\n        phone=\"+1 555-0456\"\n        permissions={['Matches']}\n        status=\"suspended\"\n      />\n    </div>\n  );\n}\n","size_bytes":846},"design_guidelines.md":{"content":"# Nexus Esports Suite - Design Guidelines\n\n## Design Approach\n\n**Hybrid Design System Strategy**: Material Design foundation for data-heavy interfaces + Linear's clean typography + esports-specific energy through strategic color and modern components.\n\n**Rationale**: This is a utility-focused, information-dense SaaS platform requiring stability, performance, and efficient data visualization. The design must balance professional enterprise UI with esports culture's vibrant, energetic aesthetic.\n\n**Core Principles**:\n- Dark mode primary with exceptional readability\n- Data clarity over decoration\n- Consistent, scannable layouts for quick information parsing\n- Purposeful use of color to indicate status and hierarchy\n- Esports energy through accent colors and subtle animated elements\n\n## Color Palette\n\n**Dark Mode (Primary)**:\n- Background Primary: 222 25% 8%\n- Background Secondary: 222 20% 12%\n- Background Tertiary: 222 18% 16%\n- Text Primary: 0 0% 95%\n- Text Secondary: 0 0% 70%\n- Text Tertiary: 0 0% 50%\n\n**Brand & Accent Colors**:\n- Primary (Cyber Purple): 270 85% 65%\n- Primary Hover: 270 85% 70%\n- Success (Wins/Positive): 142 70% 50%\n- Danger (Losses/Critical): 0 75% 60%\n- Warning (Pending/Alerts): 35 90% 60%\n- Info (Analytics/Neutral): 200 85% 55%\n\n**Status Indicators**:\n- Active/Online: 142 70% 50%\n- Inactive/Offline: 0 0% 45%\n- Pending: 35 90% 60%\n- Expired: 0 75% 60%\n\n**Light Mode (Secondary)**:\n- Background Primary: 0 0% 98%\n- Background Secondary: 0 0% 95%\n- Background Tertiary: 0 0% 92%\n- Text Primary: 222 25% 15%\n- Text Secondary: 222 20% 35%\n- Adapt accent colors for light mode accessibility\n\n## Typography\n\n**Font Families**:\n- Primary: Inter (via Google Fonts CDN) - UI, body text, data displays\n- Headings: Space Grotesk (via Google Fonts CDN) - dashboard titles, section headers\n- Monospace: JetBrains Mono (via Google Fonts CDN) - financial data, IDs, technical info\n\n**Type Scale**:\n- Hero/Dashboard Title: 3rem (48px), Space Grotesk, bold\n- Section Headers: 1.75rem (28px), Space Grotesk, semibold\n- Card Titles: 1.25rem (20px), Inter, semibold\n- Body Text: 0.938rem (15px), Inter, regular\n- Small/Meta: 0.813rem (13px), Inter, medium\n- Financial/Data: 0.938rem (15px), JetBrains Mono, medium\n\n## Layout System\n\n**Spacing Primitives**: Use Tailwind units of 2, 4, 6, 8, 12, 16, 20 for consistent rhythm.\n\n**Grid Structure**:\n- Dashboard: 12-column grid with 24px gutters\n- Sidebar Navigation: Fixed 280px width (collapsed: 80px)\n- Main Content Area: max-w-7xl with responsive padding (px-6 lg:px-8)\n- Card Spacing: gap-6 for card grids\n\n**Responsive Breakpoints**:\n- Mobile: Base (< 768px) - single column, stacked cards\n- Tablet: md (768px+) - 2-column grids where appropriate\n- Desktop: lg (1024px+) - full multi-column layouts\n- Wide: xl (1280px+) - maximum content width with side margins\n\n## Component Library\n\n**Navigation**:\n- Sidebar: Fixed position, dark background (222 25% 10%), collapsible with icon-only state\n- Top Bar: Sticky header with tenant branding, user profile, notifications, theme toggle\n- Module Icons: Use Heroicons (outline for inactive, solid for active states)\n\n**Data Display Components**:\n- Stat Cards: Elevated cards (shadow-lg) with large numbers (3rem), trend indicators (), sparkline charts\n- Data Tables: Striped rows, hover states (bg-secondary), sticky headers, sortable columns, action menus\n- Charts: Use Chart.js - line charts for trends, bar charts for comparisons, donut charts for distributions\n- Calendar View: Month grid with match/event indicators, color-coded by status/type\n\n**Forms & Inputs**:\n- Input Fields: Rounded (rounded-lg), border (border-secondary), focus ring (ring-2 ring-primary)\n- Select Dropdowns: Custom styled with Heroicons chevron, scrollable options list\n- File Upload: Drag-and-drop zone with preview thumbnails for contracts/documents\n- Toggle Switches: For permissions, active states, feature flags\n- Date Pickers: Calendar popup with range selection support\n\n**Cards & Containers**:\n- Standard Card: rounded-xl, border border-tertiary, p-6, shadow-sm on hover\n- Dashboard Widget: Same as standard but with header section (title + action button)\n- Player/Staff Profile Card: Includes avatar (64px), name, role badge, quick stats\n- Campaign Card: Image thumbnail, title, dates, platform icons, metrics preview\n\n**Modals & Overlays**:\n- Modal: Centered overlay, max-w-2xl, rounded-2xl, backdrop blur (backdrop-blur-sm)\n- Slide-over Panel: Right-side panel (w-96) for details/quick actions\n- Toast Notifications: Top-right position, auto-dismiss, color-coded by type\n\n**Buttons & Actions**:\n- Primary: bg-primary, px-6, py-2.5, rounded-lg, font-medium\n- Secondary: border-2 border-primary, text-primary, same padding/rounding\n- Danger: bg-danger for destructive actions\n- Icon Buttons: p-2, rounded-lg, hover:bg-secondary\n\n**Role Badges**:\n- Owner: bg-primary with gold border\n- Admin: bg-info\n- Manager: bg-success\n- Staff/Others: bg-secondary with colored left border\n\n**Status Indicators**:\n- Online/Active: Green dot (h-2 w-2 rounded-full) + text\n- Match Results: Win (green accent), Loss (red accent), neutral border for draws\n- Payment Status: Paid (green), Pending (yellow), Overdue (red)\n\n## Key Sections Design\n\n**Central Dashboard**:\n- Hero Stats Row: 4-column stat cards (total revenue, active rosters, upcoming matches, active campaigns)\n- Recent Activity Feed: Timeline with icons, color-coded by action type\n- Quick Actions: Floating action button (bottom-right) with contextual actions\n- Performance Charts: 2-column layout (finance trends + roster win rates)\n\n**Staff Management**:\n- Header: Add Staff button (top-right), search and filter bar\n- Staff Grid: 3-column card layout with avatar, name, role, permission count\n- Permission Matrix: Modal with checkbox grid (rows=staff, columns=modules)\n\n**Payroll & Finance**:\n- Summary Cards: Total salaries, monthly revenue, profit/loss with trend indicators\n- Payroll Table: Filterable by recurring/one-time, export button, payment status column\n- Category Breakdown: Donut chart showing expense distribution\n\n**Analytics Dashboard**:\n- Roster Filter: Dropdown to select game/roster (Valorant, LoL, etc.)\n- Metrics Grid: Win/loss rate, tournament placements, player stats cards\n- Performance Charts: Line chart for trends over time, bar chart for player comparisons\n\n**Matches Management**:\n- View Toggle: Button group to switch between List and Calendar views\n- Calendar: Month grid with match markers, click to expand match details modal\n- Match Card: Team logos, score, date/time, venue, result badge\n\n**Marcom Department**:\n- Campaign Grid: 2-3 column cards with image, title, dates, platform icons, ROI metric\n- Social Analytics: Connected platform cards with follower count, engagement rate, reach\n- Add Campaign Form: Multi-step modal with platform selection, date range picker, metrics tracking\n\n**Contracts Management**:\n- Document List: Table with file icon, name, type, linked person, expiration date, status\n- Upload Zone: Drag-and-drop area with file type indicator (PDF/DOCX)\n- Contract Preview: Modal with PDF viewer and download button\n\n**Audit Log**:\n- Filter Bar: Date range, user, action type filters\n- Log Entries: Timeline format with user avatar, action description, timestamp, before/after comparison\n\n**Club Branding Settings**:\n- Logo Upload: Drag-and-drop with preview (supports transparent PNG)\n- Color Picker: Primary and accent color selectors with live preview\n- Theme Toggle: Switch between light/dark with instant application\n\n**Images**:\n- Dashboard widgets and stat cards should use icon illustrations (abstract data visualizations, trophy icons for wins, chart graphics)\n- Player/Staff profiles use uploaded avatar photos (circular crop, 64px-128px)\n- Match cards include team logos (40px square)\n- Marcom campaigns display thumbnail images from campaigns (16:9 aspect, rounded corners)\n- Contract documents show PDF/DOCX file previews where possible\n- Hero sections are not applicable for this dashboard-style application","size_bytes":8036},"client/src/hooks/useAuth.ts":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport type { User } from \"@shared/schema\";\n\nexport function useAuth() {\n  const { data: user, isLoading } = useQuery<User>({\n    queryKey: [\"/api/auth/user\"],\n    retry: false,\n  });\n\n  return {\n    user,\n    isLoading,\n    isAuthenticated: !!user,\n  };\n}\n","size_bytes":307},"client/src/components/ui/navigation-menu.tsx":{"content":"import * as React from \"react\"\nimport * as NavigationMenuPrimitive from \"@radix-ui/react-navigation-menu\"\nimport { cva } from \"class-variance-authority\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst NavigationMenu = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative z-10 flex max-w-max flex-1 items-center justify-center\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <NavigationMenuViewport />\n  </NavigationMenuPrimitive.Root>\n))\nNavigationMenu.displayName = NavigationMenuPrimitive.Root.displayName\n\nconst NavigationMenuList = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.List\n    ref={ref}\n    className={cn(\n      \"group flex flex-1 list-none items-center justify-center space-x-1\",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuList.displayName = NavigationMenuPrimitive.List.displayName\n\nconst NavigationMenuItem = NavigationMenuPrimitive.Item\n\nconst navigationMenuTriggerStyle = cva(\n  \"group inline-flex h-10 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[state=open]:text-accent-foreground data-[state=open]:bg-accent/50 data-[state=open]:hover:bg-accent data-[state=open]:focus:bg-accent\"\n)\n\nconst NavigationMenuTrigger = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Trigger\n    ref={ref}\n    className={cn(navigationMenuTriggerStyle(), \"group\", className)}\n    {...props}\n  >\n    {children}{\" \"}\n    <ChevronDown\n      className=\"relative top-[1px] ml-1 h-3 w-3 transition duration-200 group-data-[state=open]:rotate-180\"\n      aria-hidden=\"true\"\n    />\n  </NavigationMenuPrimitive.Trigger>\n))\nNavigationMenuTrigger.displayName = NavigationMenuPrimitive.Trigger.displayName\n\nconst NavigationMenuContent = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"left-0 top-0 w-full data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 md:absolute md:w-auto \",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuContent.displayName = NavigationMenuPrimitive.Content.displayName\n\nconst NavigationMenuLink = NavigationMenuPrimitive.Link\n\nconst NavigationMenuViewport = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Viewport>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Viewport>\n>(({ className, ...props }, ref) => (\n  <div className={cn(\"absolute left-0 top-full flex justify-center\")}>\n    <NavigationMenuPrimitive.Viewport\n      className={cn(\n        \"origin-top-center relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 md:w-[var(--radix-navigation-menu-viewport-width)]\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  </div>\n))\nNavigationMenuViewport.displayName =\n  NavigationMenuPrimitive.Viewport.displayName\n\nconst NavigationMenuIndicator = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Indicator>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Indicator>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Indicator\n    ref={ref}\n    className={cn(\n      \"top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in\",\n      className\n    )}\n    {...props}\n  >\n    <div className=\"relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm bg-border shadow-md\" />\n  </NavigationMenuPrimitive.Indicator>\n))\nNavigationMenuIndicator.displayName =\n  NavigationMenuPrimitive.Indicator.displayName\n\nexport {\n  navigationMenuTriggerStyle,\n  NavigationMenu,\n  NavigationMenuList,\n  NavigationMenuItem,\n  NavigationMenuContent,\n  NavigationMenuTrigger,\n  NavigationMenuLink,\n  NavigationMenuIndicator,\n  NavigationMenuViewport,\n}\n","size_bytes":5128},"client/src/components/ui/calendar.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight } from \"lucide-react\"\nimport { DayPicker } from \"react-day-picker\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nexport type CalendarProps = React.ComponentProps<typeof DayPicker>\n\nfunction Calendar({\n  className,\n  classNames,\n  showOutsideDays = true,\n  ...props\n}: CalendarProps) {\n  return (\n    <DayPicker\n      showOutsideDays={showOutsideDays}\n      className={cn(\"p-3\", className)}\n      classNames={{\n        months: \"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0\",\n        month: \"space-y-4\",\n        caption: \"flex justify-center pt-1 relative items-center\",\n        caption_label: \"text-sm font-medium\",\n        nav: \"space-x-1 flex items-center\",\n        nav_button: cn(\n          buttonVariants({ variant: \"outline\" }),\n          \"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100\"\n        ),\n        nav_button_previous: \"absolute left-1\",\n        nav_button_next: \"absolute right-1\",\n        table: \"w-full border-collapse space-y-1\",\n        head_row: \"flex\",\n        head_cell:\n          \"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]\",\n        row: \"flex w-full mt-2\",\n        cell: \"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20\",\n        day: cn(\n          buttonVariants({ variant: \"ghost\" }),\n          \"h-9 w-9 p-0 font-normal aria-selected:opacity-100\"\n        ),\n        day_range_end: \"day-range-end\",\n        day_selected:\n          \"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground\",\n        day_today: \"bg-accent text-accent-foreground\",\n        day_outside:\n          \"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground\",\n        day_disabled: \"text-muted-foreground opacity-50\",\n        day_range_middle:\n          \"aria-selected:bg-accent aria-selected:text-accent-foreground\",\n        day_hidden: \"invisible\",\n        ...classNames,\n      }}\n      components={{\n        IconLeft: ({ className, ...props }) => (\n          <ChevronLeft className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n        IconRight: ({ className, ...props }) => (\n          <ChevronRight className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n      }}\n      {...props}\n    />\n  )\n}\nCalendar.displayName = \"Calendar\"\n\nexport { Calendar }\n","size_bytes":2695},"client/src/components/ui/sidebar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, VariantProps } from \"class-variance-authority\"\nimport { PanelLeftIcon } from \"lucide-react\"\n\nimport { useIsMobile } from \"@/hooks/use-mobile\"\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\nimport { Input } from \"@/components/ui/input\"\nimport { Separator } from \"@/components/ui/separator\"\nimport {\n  Sheet,\n  SheetContent,\n  SheetDescription,\n  SheetHeader,\n  SheetTitle,\n} from \"@/components/ui/sheet\"\nimport { Skeleton } from \"@/components/ui/skeleton\"\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\"\n\nconst SIDEBAR_COOKIE_NAME = \"sidebar_state\"\nconst SIDEBAR_COOKIE_MAX_AGE = 60 * 60 * 24 * 7\nconst SIDEBAR_WIDTH = \"16rem\"\nconst SIDEBAR_WIDTH_MOBILE = \"18rem\"\nconst SIDEBAR_WIDTH_ICON = \"3rem\"\nconst SIDEBAR_KEYBOARD_SHORTCUT = \"b\"\n\ntype SidebarContextProps = {\n  state: \"expanded\" | \"collapsed\"\n  open: boolean\n  setOpen: (open: boolean) => void\n  openMobile: boolean\n  setOpenMobile: (open: boolean) => void\n  isMobile: boolean\n  toggleSidebar: () => void\n}\n\nconst SidebarContext = React.createContext<SidebarContextProps | null>(null)\n\nfunction useSidebar() {\n  const context = React.useContext(SidebarContext)\n  if (!context) {\n    throw new Error(\"useSidebar must be used within a SidebarProvider.\")\n  }\n\n  return context\n}\n\nfunction SidebarProvider({\n  defaultOpen = true,\n  open: openProp,\n  onOpenChange: setOpenProp,\n  className,\n  style,\n  children,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  defaultOpen?: boolean\n  open?: boolean\n  onOpenChange?: (open: boolean) => void\n}) {\n  const isMobile = useIsMobile()\n  const [openMobile, setOpenMobile] = React.useState(false)\n\n  // This is the internal state of the sidebar.\n  // We use openProp and setOpenProp for control from outside the component.\n  const [_open, _setOpen] = React.useState(defaultOpen)\n  const open = openProp ?? _open\n  const setOpen = React.useCallback(\n    (value: boolean | ((value: boolean) => boolean)) => {\n      const openState = typeof value === \"function\" ? value(open) : value\n      if (setOpenProp) {\n        setOpenProp(openState)\n      } else {\n        _setOpen(openState)\n      }\n\n      // This sets the cookie to keep the sidebar state.\n      document.cookie = `${SIDEBAR_COOKIE_NAME}=${openState}; path=/; max-age=${SIDEBAR_COOKIE_MAX_AGE}`\n    },\n    [setOpenProp, open]\n  )\n\n  // Helper to toggle the sidebar.\n  const toggleSidebar = React.useCallback(() => {\n    return isMobile ? setOpenMobile((open) => !open) : setOpen((open) => !open)\n  }, [isMobile, setOpen, setOpenMobile])\n\n  // Adds a keyboard shortcut to toggle the sidebar.\n  React.useEffect(() => {\n    const handleKeyDown = (event: KeyboardEvent) => {\n      if (\n        event.key === SIDEBAR_KEYBOARD_SHORTCUT &&\n        (event.metaKey || event.ctrlKey)\n      ) {\n        event.preventDefault()\n        toggleSidebar()\n      }\n    }\n\n    window.addEventListener(\"keydown\", handleKeyDown)\n    return () => window.removeEventListener(\"keydown\", handleKeyDown)\n  }, [toggleSidebar])\n\n  // We add a state so that we can do data-state=\"expanded\" or \"collapsed\".\n  // This makes it easier to style the sidebar with Tailwind classes.\n  const state = open ? \"expanded\" : \"collapsed\"\n\n  const contextValue = React.useMemo<SidebarContextProps>(\n    () => ({\n      state,\n      open,\n      setOpen,\n      isMobile,\n      openMobile,\n      setOpenMobile,\n      toggleSidebar,\n    }),\n    [state, open, setOpen, isMobile, openMobile, setOpenMobile, toggleSidebar]\n  )\n\n  return (\n    <SidebarContext.Provider value={contextValue}>\n      <TooltipProvider delayDuration={0}>\n        <div\n          data-slot=\"sidebar-wrapper\"\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH,\n              \"--sidebar-width-icon\": SIDEBAR_WIDTH_ICON,\n              ...style,\n            } as React.CSSProperties\n          }\n          className={cn(\n            \"group/sidebar-wrapper has-data-[variant=inset]:bg-sidebar flex min-h-svh w-full\",\n            className\n          )}\n          {...props}\n        >\n          {children}\n        </div>\n      </TooltipProvider>\n    </SidebarContext.Provider>\n  )\n}\n\nfunction Sidebar({\n  side = \"left\",\n  variant = \"sidebar\",\n  collapsible = \"offcanvas\",\n  className,\n  children,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  side?: \"left\" | \"right\"\n  variant?: \"sidebar\" | \"floating\" | \"inset\"\n  collapsible?: \"offcanvas\" | \"icon\" | \"none\"\n}) {\n  const { isMobile, state, openMobile, setOpenMobile } = useSidebar()\n\n  if (collapsible === \"none\") {\n    return (\n      <div\n        data-slot=\"sidebar\"\n        className={cn(\n          \"bg-sidebar text-sidebar-foreground flex h-full w-[var(--sidebar-width)] flex-col\",\n          className\n        )}\n        {...props}\n      >\n        {children}\n      </div>\n    )\n  }\n\n  if (isMobile) {\n    return (\n      <Sheet open={openMobile} onOpenChange={setOpenMobile} {...props}>\n        <SheetContent\n          data-sidebar=\"sidebar\"\n          data-slot=\"sidebar\"\n          data-mobile=\"true\"\n          className=\"bg-sidebar text-sidebar-foreground w-[var(--sidebar-width)] p-0 [&>button]:hidden\"\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH_MOBILE,\n            } as React.CSSProperties\n          }\n          side={side}\n        >\n          <SheetHeader className=\"sr-only\">\n            <SheetTitle>Sidebar</SheetTitle>\n            <SheetDescription>Displays the mobile sidebar.</SheetDescription>\n          </SheetHeader>\n          <div className=\"flex h-full w-full flex-col\">{children}</div>\n        </SheetContent>\n      </Sheet>\n    )\n  }\n\n  return (\n    <div\n      className=\"group peer text-sidebar-foreground hidden md:block\"\n      data-state={state}\n      data-collapsible={state === \"collapsed\" ? collapsible : \"\"}\n      data-variant={variant}\n      data-side={side}\n      data-slot=\"sidebar\"\n    >\n      {/* This is what handles the sidebar gap on desktop */}\n      <div\n        data-slot=\"sidebar-gap\"\n        className={cn(\n          \"relative w-[var(--sidebar-width)] bg-transparent transition-[width] duration-200 ease-linear\",\n          \"group-data-[collapsible=offcanvas]:w-0\",\n          \"group-data-[side=right]:rotate-180\",\n          variant === \"floating\" || variant === \"inset\"\n            ? \"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4))]\"\n            : \"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)]\"\n        )}\n      />\n      <div\n        data-slot=\"sidebar-container\"\n        className={cn(\n          \"fixed inset-y-0 z-10 hidden h-svh w-[var(--sidebar-width)] transition-[left,right,width] duration-200 ease-linear md:flex\",\n          side === \"left\"\n            ? \"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]\"\n            : \"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]\",\n          // Adjust the padding for floating and inset variants.\n          variant === \"floating\" || variant === \"inset\"\n            ? \"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4)+2px)]\"\n            : \"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)] group-data-[side=left]:border-r group-data-[side=right]:border-l\",\n          className\n        )}\n        {...props}\n      >\n        <div\n          data-sidebar=\"sidebar\"\n          data-slot=\"sidebar-inner\"\n          className=\"bg-sidebar group-data-[variant=floating]:border-sidebar-border flex h-full w-full flex-col group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:shadow-sm\"\n        >\n          {children}\n        </div>\n      </div>\n    </div>\n  )\n}\n\nfunction SidebarTrigger({\n  className,\n  onClick,\n  ...props\n}: React.ComponentProps<typeof Button>) {\n  const { toggleSidebar } = useSidebar()\n\n  return (\n    <Button\n      data-sidebar=\"trigger\"\n      data-slot=\"sidebar-trigger\"\n      variant=\"ghost\"\n      size=\"icon\"\n      className={cn(\"h-7 w-7\", className)}\n      onClick={(event) => {\n        onClick?.(event)\n        toggleSidebar()\n      }}\n      {...props}\n    >\n      <PanelLeftIcon />\n      <span className=\"sr-only\">Toggle Sidebar</span>\n    </Button>\n  )\n}\n\nfunction SidebarRail({ className, ...props }: React.ComponentProps<\"button\">) {\n  const { toggleSidebar } = useSidebar()\n\n  // Note: Tailwind v3.4 doesn't support \"in-\" selectors. So the rail won't work perfectly.\n  return (\n    <button\n      data-sidebar=\"rail\"\n      data-slot=\"sidebar-rail\"\n      aria-label=\"Toggle Sidebar\"\n      tabIndex={-1}\n      onClick={toggleSidebar}\n      title=\"Toggle Sidebar\"\n      className={cn(\n        \"hover:after:bg-sidebar-border absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear group-data-[side=left]:-right-4 group-data-[side=right]:left-0 after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] sm:flex\",\n        \"in-data-[side=left]:cursor-w-resize in-data-[side=right]:cursor-e-resize\",\n        \"[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize\",\n        \"hover:group-data-[collapsible=offcanvas]:bg-sidebar group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full\",\n        \"[[data-side=left][data-collapsible=offcanvas]_&]:-right-2\",\n        \"[[data-side=right][data-collapsible=offcanvas]_&]:-left-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarInset({ className, ...props }: React.ComponentProps<\"main\">) {\n  return (\n    <main\n      data-slot=\"sidebar-inset\"\n      className={cn(\n        \"bg-background relative flex w-full flex-1 flex-col\",\n        \"md:peer-data-[variant=inset]:m-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow-sm md:peer-data-[variant=inset]:peer-data-[state=collapsed]:ml-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarInput({\n  className,\n  ...props\n}: React.ComponentProps<typeof Input>) {\n  return (\n    <Input\n      data-slot=\"sidebar-input\"\n      data-sidebar=\"input\"\n      className={cn(\"bg-background h-8 w-full shadow-none\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-header\"\n      data-sidebar=\"header\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarFooter({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-footer\"\n      data-sidebar=\"footer\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarSeparator({\n  className,\n  ...props\n}: React.ComponentProps<typeof Separator>) {\n  return (\n    <Separator\n      data-slot=\"sidebar-separator\"\n      data-sidebar=\"separator\"\n      className={cn(\"bg-sidebar-border mx-2 w-auto\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-content\"\n      data-sidebar=\"content\"\n      className={cn(\n        \"flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroup({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-group\"\n      data-sidebar=\"group\"\n      className={cn(\"relative flex w-full min-w-0 flex-col p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupLabel({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"div\"> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"div\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-group-label\"\n      data-sidebar=\"group-label\"\n      className={cn(\n        \"text-sidebar-foreground/70 ring-sidebar-ring flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium outline-hidden transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:h-4 [&>svg]:w-4 [&>svg]:shrink-0\",\n        \"group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupAction({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"button\"> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-group-action\"\n      data-sidebar=\"group-action\"\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground absolute top-3.5 right-3 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 md:after:hidden\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupContent({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-group-content\"\n      data-sidebar=\"group-content\"\n      className={cn(\"w-full text-sm\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenu({ className, ...props }: React.ComponentProps<\"ul\">) {\n  return (\n    <ul\n      data-slot=\"sidebar-menu\"\n      data-sidebar=\"menu\"\n      className={cn(\"flex w-full min-w-0 flex-col gap-1\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuItem({ className, ...props }: React.ComponentProps<\"li\">) {\n  return (\n    <li\n      data-slot=\"sidebar-menu-item\"\n      data-sidebar=\"menu-item\"\n      className={cn(\"group/menu-item relative\", className)}\n      {...props}\n    />\n  )\n}\n\nconst sidebarMenuButtonVariants = cva(\n  \"peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-hidden ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:w-8! group-data-[collapsible=icon]:h-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground\",\n        outline:\n          \"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]\",\n      },\n      size: {\n        default: \"h-8 text-sm\",\n        sm: \"h-7 text-xs\",\n        lg: \"h-12 text-sm group-data-[collapsible=icon]:p-0!\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nfunction SidebarMenuButton({\n  asChild = false,\n  isActive = false,\n  variant = \"default\",\n  size = \"default\",\n  tooltip,\n  className,\n  ...props\n}: React.ComponentProps<\"button\"> & {\n  asChild?: boolean\n  isActive?: boolean\n  tooltip?: string | React.ComponentProps<typeof TooltipContent>\n} & VariantProps<typeof sidebarMenuButtonVariants>) {\n  const Comp = asChild ? Slot : \"button\"\n  const { isMobile, state } = useSidebar()\n\n  const button = (\n    <Comp\n      data-slot=\"sidebar-menu-button\"\n      data-sidebar=\"menu-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(sidebarMenuButtonVariants({ variant, size }), className)}\n      {...props}\n    />\n  )\n\n  if (!tooltip) {\n    return button\n  }\n\n  if (typeof tooltip === \"string\") {\n    tooltip = {\n      children: tooltip,\n    }\n  }\n\n  return (\n    <Tooltip>\n      <TooltipTrigger asChild>{button}</TooltipTrigger>\n      <TooltipContent\n        side=\"right\"\n        align=\"center\"\n        hidden={state !== \"collapsed\" || isMobile}\n        {...tooltip}\n      />\n    </Tooltip>\n  )\n}\n\nfunction SidebarMenuAction({\n  className,\n  asChild = false,\n  showOnHover = false,\n  ...props\n}: React.ComponentProps<\"button\"> & {\n  asChild?: boolean\n  showOnHover?: boolean\n}) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-menu-action\"\n      data-sidebar=\"menu-action\"\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer-hover/menu-button:text-sidebar-accent-foreground absolute top-1.5 right-1 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 md:after:hidden\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        showOnHover &&\n          \"peer-data-[active=true]/menu-button:text-sidebar-accent-foreground group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 md:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuBadge({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-menu-badge\"\n      data-sidebar=\"menu-badge\"\n      className={cn(\n        \"text-sidebar-foreground pointer-events-none absolute right-1 flex h-5 min-w-5 items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums select-none\",\n        \"peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSkeleton({\n  className,\n  showIcon = false,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  showIcon?: boolean\n}) {\n  // Random width between 50 to 90%.\n  const width = React.useMemo(() => {\n    return `${Math.floor(Math.random() * 40) + 50}%`\n  }, [])\n\n  return (\n    <div\n      data-slot=\"sidebar-menu-skeleton\"\n      data-sidebar=\"menu-skeleton\"\n      className={cn(\"flex h-8 items-center gap-2 rounded-md px-2\", className)}\n      {...props}\n    >\n      {showIcon && (\n        <Skeleton\n          className=\"size-4 rounded-md\"\n          data-sidebar=\"menu-skeleton-icon\"\n        />\n      )}\n      <Skeleton\n        className=\"h-4 max-w-[var(--skeleton-width)] flex-1\"\n        data-sidebar=\"menu-skeleton-text\"\n        style={\n          {\n            \"--skeleton-width\": width,\n          } as React.CSSProperties\n        }\n      />\n    </div>\n  )\n}\n\nfunction SidebarMenuSub({ className, ...props }: React.ComponentProps<\"ul\">) {\n  return (\n    <ul\n      data-slot=\"sidebar-menu-sub\"\n      data-sidebar=\"menu-sub\"\n      className={cn(\n        \"border-sidebar-border mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l px-2.5 py-0.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSubItem({\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) {\n  return (\n    <li\n      data-slot=\"sidebar-menu-sub-item\"\n      data-sidebar=\"menu-sub-item\"\n      className={cn(\"group/menu-sub-item relative\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSubButton({\n  asChild = false,\n  size = \"md\",\n  isActive = false,\n  className,\n  ...props\n}: React.ComponentProps<\"a\"> & {\n  asChild?: boolean\n  size?: \"sm\" | \"md\"\n  isActive?: boolean\n}) {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-menu-sub-button\"\n      data-sidebar=\"menu-sub-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground active:bg-sidebar-accent active:text-sidebar-accent-foreground [&>svg]:text-sidebar-accent-foreground flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 outline outline-2 outline-transparent outline-offset-2 focus-visible:ring-2 disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n        \"data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground\",\n        size === \"sm\" && \"text-xs\",\n        size === \"md\" && \"text-sm\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Sidebar,\n  SidebarContent,\n  SidebarFooter,\n  SidebarGroup,\n  SidebarGroupAction,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarHeader,\n  SidebarInput,\n  SidebarInset,\n  SidebarMenu,\n  SidebarMenuAction,\n  SidebarMenuBadge,\n  SidebarMenuButton,\n  SidebarMenuItem,\n  SidebarMenuSkeleton,\n  SidebarMenuSub,\n  SidebarMenuSubButton,\n  SidebarMenuSubItem,\n  SidebarProvider,\n  SidebarRail,\n  SidebarSeparator,\n  SidebarTrigger,\n  useSidebar,\n}\n","size_bytes":21846},"client/src/components/examples/AppSidebar.tsx":{"content":"import { SidebarProvider } from \"@/components/ui/sidebar\";\nimport { AppSidebar } from \"../app-sidebar\";\n\nexport default function AppSidebarExample() {\n  return (\n    <SidebarProvider>\n      <AppSidebar />\n    </SidebarProvider>\n  );\n}\n","size_bytes":235},"server/vite.ts":{"content":"import express, { type Express } from \"express\";\nimport fs from \"fs\";\nimport path from \"path\";\nimport { createServer as createViteServer, createLogger } from \"vite\";\nimport { type Server } from \"http\";\nimport viteConfig from \"../vite.config\";\nimport { nanoid } from \"nanoid\";\n\nconst viteLogger = createLogger();\n\nexport function log(message: string, source = \"express\") {\n  const formattedTime = new Date().toLocaleTimeString(\"en-US\", {\n    hour: \"numeric\",\n    minute: \"2-digit\",\n    second: \"2-digit\",\n    hour12: true,\n  });\n\n  console.log(`${formattedTime} [${source}] ${message}`);\n}\n\nexport async function setupVite(app: Express, server: Server) {\n  const serverOptions = {\n    middlewareMode: true,\n    hmr: { server },\n    allowedHosts: true as const,\n  };\n\n  const vite = await createViteServer({\n    ...viteConfig,\n    configFile: false,\n    customLogger: {\n      ...viteLogger,\n      error: (msg, options) => {\n        viteLogger.error(msg, options);\n        process.exit(1);\n      },\n    },\n    server: serverOptions,\n    appType: \"custom\",\n  });\n\n  app.use(vite.middlewares);\n  app.use(\"*\", async (req, res, next) => {\n    const url = req.originalUrl;\n\n    try {\n      const clientTemplate = path.resolve(\n        import.meta.dirname,\n        \"..\",\n        \"client\",\n        \"index.html\",\n      );\n\n      // always reload the index.html file from disk incase it changes\n      let template = await fs.promises.readFile(clientTemplate, \"utf-8\");\n      template = template.replace(\n        `src=\"/src/main.tsx\"`,\n        `src=\"/src/main.tsx?v=${nanoid()}\"`,\n      );\n      const page = await vite.transformIndexHtml(url, template);\n      res.status(200).set({ \"Content-Type\": \"text/html\" }).end(page);\n    } catch (e) {\n      vite.ssrFixStacktrace(e as Error);\n      next(e);\n    }\n  });\n}\n\nexport function serveStatic(app: Express) {\n  const distPath = path.resolve(import.meta.dirname, \"public\");\n\n  if (!fs.existsSync(distPath)) {\n    throw new Error(\n      `Could not find the build directory: ${distPath}, make sure to build the client first`,\n    );\n  }\n\n  app.use(express.static(distPath));\n\n  // fall through to index.html if the file doesn't exist\n  app.use(\"*\", (_req, res) => {\n    res.sendFile(path.resolve(distPath, \"index.html\"));\n  });\n}\n","size_bytes":2263},"vite.config.ts":{"content":"import { defineConfig } from \"vite\";\nimport react from \"@vitejs/plugin-react\";\nimport path from \"path\";\nimport runtimeErrorOverlay from \"@replit/vite-plugin-runtime-error-modal\";\n\nexport default defineConfig({\n  plugins: [\n    react(),\n    runtimeErrorOverlay(),\n    ...(process.env.NODE_ENV !== \"production\" &&\n    process.env.REPL_ID !== undefined\n      ? [\n          await import(\"@replit/vite-plugin-cartographer\").then((m) =>\n            m.cartographer(),\n          ),\n          await import(\"@replit/vite-plugin-dev-banner\").then((m) =>\n            m.devBanner(),\n          ),\n        ]\n      : []),\n  ],\n  resolve: {\n    alias: {\n      \"@\": path.resolve(import.meta.dirname, \"client\", \"src\"),\n      \"@shared\": path.resolve(import.meta.dirname, \"shared\"),\n      \"@assets\": path.resolve(import.meta.dirname, \"attached_assets\"),\n    },\n  },\n  root: path.resolve(import.meta.dirname, \"client\"),\n  build: {\n    outDir: path.resolve(import.meta.dirname, \"dist/public\"),\n    emptyOutDir: true,\n  },\n  server: {\n    fs: {\n      strict: true,\n      deny: [\"**/.*\"],\n    },\n  },\n});\n","size_bytes":1080},"client/src/components/ui/tabs.tsx":{"content":"import * as React from \"react\"\nimport * as TabsPrimitive from \"@radix-ui/react-tabs\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Tabs = TabsPrimitive.Root\n\nconst TabsList = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.List\n    ref={ref}\n    className={cn(\n      \"inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsList.displayName = TabsPrimitive.List.displayName\n\nconst TabsTrigger = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsTrigger.displayName = TabsPrimitive.Trigger.displayName\n\nconst TabsContent = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsContent.displayName = TabsPrimitive.Content.displayName\n\nexport { Tabs, TabsList, TabsTrigger, TabsContent }\n","size_bytes":1883},"client/src/components/ui/toaster.tsx":{"content":"import { useToast } from \"@/hooks/use-toast\"\nimport {\n  Toast,\n  ToastClose,\n  ToastDescription,\n  ToastProvider,\n  ToastTitle,\n  ToastViewport,\n} from \"@/components/ui/toast\"\n\nexport function Toaster() {\n  const { toasts } = useToast()\n\n  return (\n    <ToastProvider>\n      {toasts.map(function ({ id, title, description, action, ...props }) {\n        return (\n          <Toast key={id} {...props}>\n            <div className=\"grid gap-1\">\n              {title && <ToastTitle>{title}</ToastTitle>}\n              {description && (\n                <ToastDescription>{description}</ToastDescription>\n              )}\n            </div>\n            {action}\n            <ToastClose />\n          </Toast>\n        )\n      })}\n      <ToastViewport />\n    </ToastProvider>\n  )\n}\n","size_bytes":772},"client/src/components/theme-toggle.tsx":{"content":"import { Moon, Sun } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { useEffect, useState } from \"react\";\n\nexport function ThemeToggle() {\n  const [theme, setTheme] = useState<\"light\" | \"dark\">(\"dark\");\n\n  useEffect(() => {\n    const stored = localStorage.getItem(\"theme\") as \"light\" | \"dark\" | null;\n    const initial = stored || \"dark\";\n    setTheme(initial);\n    document.documentElement.classList.toggle(\"dark\", initial === \"dark\");\n  }, []);\n\n  const toggleTheme = () => {\n    const newTheme = theme === \"dark\" ? \"light\" : \"dark\";\n    setTheme(newTheme);\n    localStorage.setItem(\"theme\", newTheme);\n    document.documentElement.classList.toggle(\"dark\", newTheme === \"dark\");\n  };\n\n  return (\n    <Button\n      variant=\"ghost\"\n      size=\"icon\"\n      onClick={toggleTheme}\n      data-testid=\"button-theme-toggle\"\n    >\n      {theme === \"dark\" ? <Sun className=\"h-5 w-5\" /> : <Moon className=\"h-5 w-5\" />}\n    </Button>\n  );\n}\n","size_bytes":961},"client/src/components/ui/carousel.tsx":{"content":"import * as React from \"react\"\nimport useEmblaCarousel, {\n  type UseEmblaCarouselType,\n} from \"embla-carousel-react\"\nimport { ArrowLeft, ArrowRight } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\n\ntype CarouselApi = UseEmblaCarouselType[1]\ntype UseCarouselParameters = Parameters<typeof useEmblaCarousel>\ntype CarouselOptions = UseCarouselParameters[0]\ntype CarouselPlugin = UseCarouselParameters[1]\n\ntype CarouselProps = {\n  opts?: CarouselOptions\n  plugins?: CarouselPlugin\n  orientation?: \"horizontal\" | \"vertical\"\n  setApi?: (api: CarouselApi) => void\n}\n\ntype CarouselContextProps = {\n  carouselRef: ReturnType<typeof useEmblaCarousel>[0]\n  api: ReturnType<typeof useEmblaCarousel>[1]\n  scrollPrev: () => void\n  scrollNext: () => void\n  canScrollPrev: boolean\n  canScrollNext: boolean\n} & CarouselProps\n\nconst CarouselContext = React.createContext<CarouselContextProps | null>(null)\n\nfunction useCarousel() {\n  const context = React.useContext(CarouselContext)\n\n  if (!context) {\n    throw new Error(\"useCarousel must be used within a <Carousel />\")\n  }\n\n  return context\n}\n\nconst Carousel = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & CarouselProps\n>(\n  (\n    {\n      orientation = \"horizontal\",\n      opts,\n      setApi,\n      plugins,\n      className,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const [carouselRef, api] = useEmblaCarousel(\n      {\n        ...opts,\n        axis: orientation === \"horizontal\" ? \"x\" : \"y\",\n      },\n      plugins\n    )\n    const [canScrollPrev, setCanScrollPrev] = React.useState(false)\n    const [canScrollNext, setCanScrollNext] = React.useState(false)\n\n    const onSelect = React.useCallback((api: CarouselApi) => {\n      if (!api) {\n        return\n      }\n\n      setCanScrollPrev(api.canScrollPrev())\n      setCanScrollNext(api.canScrollNext())\n    }, [])\n\n    const scrollPrev = React.useCallback(() => {\n      api?.scrollPrev()\n    }, [api])\n\n    const scrollNext = React.useCallback(() => {\n      api?.scrollNext()\n    }, [api])\n\n    const handleKeyDown = React.useCallback(\n      (event: React.KeyboardEvent<HTMLDivElement>) => {\n        if (event.key === \"ArrowLeft\") {\n          event.preventDefault()\n          scrollPrev()\n        } else if (event.key === \"ArrowRight\") {\n          event.preventDefault()\n          scrollNext()\n        }\n      },\n      [scrollPrev, scrollNext]\n    )\n\n    React.useEffect(() => {\n      if (!api || !setApi) {\n        return\n      }\n\n      setApi(api)\n    }, [api, setApi])\n\n    React.useEffect(() => {\n      if (!api) {\n        return\n      }\n\n      onSelect(api)\n      api.on(\"reInit\", onSelect)\n      api.on(\"select\", onSelect)\n\n      return () => {\n        api?.off(\"select\", onSelect)\n      }\n    }, [api, onSelect])\n\n    return (\n      <CarouselContext.Provider\n        value={{\n          carouselRef,\n          api: api,\n          opts,\n          orientation:\n            orientation || (opts?.axis === \"y\" ? \"vertical\" : \"horizontal\"),\n          scrollPrev,\n          scrollNext,\n          canScrollPrev,\n          canScrollNext,\n        }}\n      >\n        <div\n          ref={ref}\n          onKeyDownCapture={handleKeyDown}\n          className={cn(\"relative\", className)}\n          role=\"region\"\n          aria-roledescription=\"carousel\"\n          {...props}\n        >\n          {children}\n        </div>\n      </CarouselContext.Provider>\n    )\n  }\n)\nCarousel.displayName = \"Carousel\"\n\nconst CarouselContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { carouselRef, orientation } = useCarousel()\n\n  return (\n    <div ref={carouselRef} className=\"overflow-hidden\">\n      <div\n        ref={ref}\n        className={cn(\n          \"flex\",\n          orientation === \"horizontal\" ? \"-ml-4\" : \"-mt-4 flex-col\",\n          className\n        )}\n        {...props}\n      />\n    </div>\n  )\n})\nCarouselContent.displayName = \"CarouselContent\"\n\nconst CarouselItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { orientation } = useCarousel()\n\n  return (\n    <div\n      ref={ref}\n      role=\"group\"\n      aria-roledescription=\"slide\"\n      className={cn(\n        \"min-w-0 shrink-0 grow-0 basis-full\",\n        orientation === \"horizontal\" ? \"pl-4\" : \"pt-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nCarouselItem.displayName = \"CarouselItem\"\n\nconst CarouselPrevious = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollPrev, canScrollPrev } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute  h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-left-12 top-1/2 -translate-y-1/2\"\n          : \"-top-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollPrev}\n      onClick={scrollPrev}\n      {...props}\n    >\n      <ArrowLeft className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Previous slide</span>\n    </Button>\n  )\n})\nCarouselPrevious.displayName = \"CarouselPrevious\"\n\nconst CarouselNext = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollNext, canScrollNext } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-right-12 top-1/2 -translate-y-1/2\"\n          : \"-bottom-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollNext}\n      onClick={scrollNext}\n      {...props}\n    >\n      <ArrowRight className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Next slide</span>\n    </Button>\n  )\n})\nCarouselNext.displayName = \"CarouselNext\"\n\nexport {\n  type CarouselApi,\n  Carousel,\n  CarouselContent,\n  CarouselItem,\n  CarouselPrevious,\n  CarouselNext,\n}\n","size_bytes":6210},"client/src/components/ui/tooltip.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as TooltipPrimitive from \"@radix-ui/react-tooltip\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst TooltipProvider = TooltipPrimitive.Provider\n\nconst Tooltip = TooltipPrimitive.Root\n\nconst TooltipTrigger = TooltipPrimitive.Trigger\n\nconst TooltipContent = React.forwardRef<\n  React.ElementRef<typeof TooltipPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TooltipPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <TooltipPrimitive.Content\n    ref={ref}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nTooltipContent.displayName = TooltipPrimitive.Content.displayName\n\nexport { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider }\n","size_bytes":1209},"client/src/components/examples/ThemeToggle.tsx":{"content":"import { ThemeToggle } from \"../theme-toggle\";\n\nexport default function ThemeToggleExample() {\n  return (\n    <div className=\"flex items-center justify-center p-6 bg-background\">\n      <ThemeToggle />\n    </div>\n  );\n}\n","size_bytes":219},"client/src/components/ui/menubar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as MenubarPrimitive from \"@radix-ui/react-menubar\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction MenubarMenu({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Menu>) {\n  return <MenubarPrimitive.Menu {...props} />\n}\n\nfunction MenubarGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Group>) {\n  return <MenubarPrimitive.Group {...props} />\n}\n\nfunction MenubarPortal({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Portal>) {\n  return <MenubarPrimitive.Portal {...props} />\n}\n\nfunction MenubarRadioGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.RadioGroup>) {\n  return <MenubarPrimitive.RadioGroup {...props} />\n}\n\nfunction MenubarSub({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Sub>) {\n  return <MenubarPrimitive.Sub data-slot=\"menubar-sub\" {...props} />\n}\n\nconst Menubar = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"flex h-10 items-center space-x-1 rounded-md border bg-background p-1\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubar.displayName = MenubarPrimitive.Root.displayName\n\nconst MenubarTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-3 py-1.5 text-sm font-medium outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarTrigger.displayName = MenubarPrimitive.Trigger.displayName\n\nconst MenubarSubTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <MenubarPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </MenubarPrimitive.SubTrigger>\n))\nMenubarSubTrigger.displayName = MenubarPrimitive.SubTrigger.displayName\n\nconst MenubarSubContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarSubContent.displayName = MenubarPrimitive.SubContent.displayName\n\nconst MenubarContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Content>\n>(\n  (\n    { className, align = \"start\", alignOffset = -4, sideOffset = 8, ...props },\n    ref\n  ) => (\n    <MenubarPrimitive.Portal>\n      <MenubarPrimitive.Content\n        ref={ref}\n        align={align}\n        alignOffset={alignOffset}\n        sideOffset={sideOffset}\n        className={cn(\n          \"z-50 min-w-[12rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n          className\n        )}\n        {...props}\n      />\n    </MenubarPrimitive.Portal>\n  )\n)\nMenubarContent.displayName = MenubarPrimitive.Content.displayName\n\nconst MenubarItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarItem.displayName = MenubarPrimitive.Item.displayName\n\nconst MenubarCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <MenubarPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.CheckboxItem>\n))\nMenubarCheckboxItem.displayName = MenubarPrimitive.CheckboxItem.displayName\n\nconst MenubarRadioItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <MenubarPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.RadioItem>\n))\nMenubarRadioItem.displayName = MenubarPrimitive.RadioItem.displayName\n\nconst MenubarLabel = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarLabel.displayName = MenubarPrimitive.Label.displayName\n\nconst MenubarSeparator = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nMenubarSeparator.displayName = MenubarPrimitive.Separator.displayName\n\nconst MenubarShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nMenubarShortcut.displayname = \"MenubarShortcut\"\n\nexport {\n  Menubar,\n  MenubarMenu,\n  MenubarTrigger,\n  MenubarContent,\n  MenubarItem,\n  MenubarSeparator,\n  MenubarLabel,\n  MenubarCheckboxItem,\n  MenubarRadioGroup,\n  MenubarRadioItem,\n  MenubarPortal,\n  MenubarSubContent,\n  MenubarSubTrigger,\n  MenubarGroup,\n  MenubarSub,\n  MenubarShortcut,\n}\n","size_bytes":8605},"client/src/components/ui/toast.tsx":{"content":"import * as React from \"react\"\nimport * as ToastPrimitives from \"@radix-ui/react-toast\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ToastProvider = ToastPrimitives.Provider\n\nconst ToastViewport = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Viewport>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Viewport>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Viewport\n    ref={ref}\n    className={cn(\n      \"fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]\",\n      className\n    )}\n    {...props}\n  />\n))\nToastViewport.displayName = ToastPrimitives.Viewport.displayName\n\nconst toastVariants = cva(\n  \"group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full\",\n  {\n    variants: {\n      variant: {\n        default: \"border bg-background text-foreground\",\n        destructive:\n          \"destructive group border-destructive bg-destructive text-destructive-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Toast = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Root> &\n    VariantProps<typeof toastVariants>\n>(({ className, variant, ...props }, ref) => {\n  return (\n    <ToastPrimitives.Root\n      ref={ref}\n      className={cn(toastVariants({ variant }), className)}\n      {...props}\n    />\n  )\n})\nToast.displayName = ToastPrimitives.Root.displayName\n\nconst ToastAction = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Action>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Action>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Action\n    ref={ref}\n    className={cn(\n      \"inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive\",\n      className\n    )}\n    {...props}\n  />\n))\nToastAction.displayName = ToastPrimitives.Action.displayName\n\nconst ToastClose = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Close>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Close>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Close\n    ref={ref}\n    className={cn(\n      \"absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600\",\n      className\n    )}\n    toast-close=\"\"\n    {...props}\n  >\n    <X className=\"h-4 w-4\" />\n  </ToastPrimitives.Close>\n))\nToastClose.displayName = ToastPrimitives.Close.displayName\n\nconst ToastTitle = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Title>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Title>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Title\n    ref={ref}\n    className={cn(\"text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nToastTitle.displayName = ToastPrimitives.Title.displayName\n\nconst ToastDescription = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Description>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Description>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Description\n    ref={ref}\n    className={cn(\"text-sm opacity-90\", className)}\n    {...props}\n  />\n))\nToastDescription.displayName = ToastPrimitives.Description.displayName\n\ntype ToastProps = React.ComponentPropsWithoutRef<typeof Toast>\n\ntype ToastActionElement = React.ReactElement<typeof ToastAction>\n\nexport {\n  type ToastProps,\n  type ToastActionElement,\n  ToastProvider,\n  ToastViewport,\n  Toast,\n  ToastTitle,\n  ToastDescription,\n  ToastClose,\n  ToastAction,\n}\n","size_bytes":4845},"client/src/hooks/use-toast.ts":{"content":"import * as React from \"react\"\n\nimport type {\n  ToastActionElement,\n  ToastProps,\n} from \"@/components/ui/toast\"\n\nconst TOAST_LIMIT = 1\nconst TOAST_REMOVE_DELAY = 1000000\n\ntype ToasterToast = ToastProps & {\n  id: string\n  title?: React.ReactNode\n  description?: React.ReactNode\n  action?: ToastActionElement\n}\n\nconst actionTypes = {\n  ADD_TOAST: \"ADD_TOAST\",\n  UPDATE_TOAST: \"UPDATE_TOAST\",\n  DISMISS_TOAST: \"DISMISS_TOAST\",\n  REMOVE_TOAST: \"REMOVE_TOAST\",\n} as const\n\nlet count = 0\n\nfunction genId() {\n  count = (count + 1) % Number.MAX_SAFE_INTEGER\n  return count.toString()\n}\n\ntype ActionType = typeof actionTypes\n\ntype Action =\n  | {\n      type: ActionType[\"ADD_TOAST\"]\n      toast: ToasterToast\n    }\n  | {\n      type: ActionType[\"UPDATE_TOAST\"]\n      toast: Partial<ToasterToast>\n    }\n  | {\n      type: ActionType[\"DISMISS_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n  | {\n      type: ActionType[\"REMOVE_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n\ninterface State {\n  toasts: ToasterToast[]\n}\n\nconst toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>()\n\nconst addToRemoveQueue = (toastId: string) => {\n  if (toastTimeouts.has(toastId)) {\n    return\n  }\n\n  const timeout = setTimeout(() => {\n    toastTimeouts.delete(toastId)\n    dispatch({\n      type: \"REMOVE_TOAST\",\n      toastId: toastId,\n    })\n  }, TOAST_REMOVE_DELAY)\n\n  toastTimeouts.set(toastId, timeout)\n}\n\nexport const reducer = (state: State, action: Action): State => {\n  switch (action.type) {\n    case \"ADD_TOAST\":\n      return {\n        ...state,\n        toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),\n      }\n\n    case \"UPDATE_TOAST\":\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === action.toast.id ? { ...t, ...action.toast } : t\n        ),\n      }\n\n    case \"DISMISS_TOAST\": {\n      const { toastId } = action\n\n      // ! Side effects ! - This could be extracted into a dismissToast() action,\n      // but I'll keep it here for simplicity\n      if (toastId) {\n        addToRemoveQueue(toastId)\n      } else {\n        state.toasts.forEach((toast) => {\n          addToRemoveQueue(toast.id)\n        })\n      }\n\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === toastId || toastId === undefined\n            ? {\n                ...t,\n                open: false,\n              }\n            : t\n        ),\n      }\n    }\n    case \"REMOVE_TOAST\":\n      if (action.toastId === undefined) {\n        return {\n          ...state,\n          toasts: [],\n        }\n      }\n      return {\n        ...state,\n        toasts: state.toasts.filter((t) => t.id !== action.toastId),\n      }\n  }\n}\n\nconst listeners: Array<(state: State) => void> = []\n\nlet memoryState: State = { toasts: [] }\n\nfunction dispatch(action: Action) {\n  memoryState = reducer(memoryState, action)\n  listeners.forEach((listener) => {\n    listener(memoryState)\n  })\n}\n\ntype Toast = Omit<ToasterToast, \"id\">\n\nfunction toast({ ...props }: Toast) {\n  const id = genId()\n\n  const update = (props: ToasterToast) =>\n    dispatch({\n      type: \"UPDATE_TOAST\",\n      toast: { ...props, id },\n    })\n  const dismiss = () => dispatch({ type: \"DISMISS_TOAST\", toastId: id })\n\n  dispatch({\n    type: \"ADD_TOAST\",\n    toast: {\n      ...props,\n      id,\n      open: true,\n      onOpenChange: (open) => {\n        if (!open) dismiss()\n      },\n    },\n  })\n\n  return {\n    id: id,\n    dismiss,\n    update,\n  }\n}\n\nfunction useToast() {\n  const [state, setState] = React.useState<State>(memoryState)\n\n  React.useEffect(() => {\n    listeners.push(setState)\n    return () => {\n      const index = listeners.indexOf(setState)\n      if (index > -1) {\n        listeners.splice(index, 1)\n      }\n    }\n  }, [state])\n\n  return {\n    ...state,\n    toast,\n    dismiss: (toastId?: string) => dispatch({ type: \"DISMISS_TOAST\", toastId }),\n  }\n}\n\nexport { useToast, toast }\n","size_bytes":3895},"client/src/components/ui/table.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Table = React.forwardRef<\n  HTMLTableElement,\n  React.HTMLAttributes<HTMLTableElement>\n>(({ className, ...props }, ref) => (\n  <div className=\"relative w-full overflow-auto\">\n    <table\n      ref={ref}\n      className={cn(\"w-full caption-bottom text-sm\", className)}\n      {...props}\n    />\n  </div>\n))\nTable.displayName = \"Table\"\n\nconst TableHeader = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <thead ref={ref} className={cn(\"[&_tr]:border-b\", className)} {...props} />\n))\nTableHeader.displayName = \"TableHeader\"\n\nconst TableBody = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tbody\n    ref={ref}\n    className={cn(\"[&_tr:last-child]:border-0\", className)}\n    {...props}\n  />\n))\nTableBody.displayName = \"TableBody\"\n\nconst TableFooter = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tfoot\n    ref={ref}\n    className={cn(\n      \"border-t bg-muted/50 font-medium [&>tr]:last:border-b-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableFooter.displayName = \"TableFooter\"\n\nconst TableRow = React.forwardRef<\n  HTMLTableRowElement,\n  React.HTMLAttributes<HTMLTableRowElement>\n>(({ className, ...props }, ref) => (\n  <tr\n    ref={ref}\n    className={cn(\n      \"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nTableRow.displayName = \"TableRow\"\n\nconst TableHead = React.forwardRef<\n  HTMLTableCellElement,\n  React.ThHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <th\n    ref={ref}\n    className={cn(\n      \"h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableHead.displayName = \"TableHead\"\n\nconst TableCell = React.forwardRef<\n  HTMLTableCellElement,\n  React.TdHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <td\n    ref={ref}\n    className={cn(\"p-4 align-middle [&:has([role=checkbox])]:pr-0\", className)}\n    {...props}\n  />\n))\nTableCell.displayName = \"TableCell\"\n\nconst TableCaption = React.forwardRef<\n  HTMLTableCaptionElement,\n  React.HTMLAttributes<HTMLTableCaptionElement>\n>(({ className, ...props }, ref) => (\n  <caption\n    ref={ref}\n    className={cn(\"mt-4 text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nTableCaption.displayName = \"TableCaption\"\n\nexport {\n  Table,\n  TableHeader,\n  TableBody,\n  TableFooter,\n  TableHead,\n  TableRow,\n  TableCell,\n  TableCaption,\n}\n","size_bytes":2765},"client/src/pages/staff.tsx":{"content":"import { StaffCard } from \"@/components/staff-card\";\nimport { StaffDialog } from \"@/components/staff-dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Plus, Search } from \"lucide-react\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport { useState } from \"react\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { isUnauthorizedError } from \"@/lib/authUtils\";\nimport type { Staff as StaffType, Tenant } from \"@shared/schema\";\nimport { Badge } from \"@/components/ui/badge\";\n\nexport default function Staff() {\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [roleFilter, setRoleFilter] = useState(\"all\");\n  const [dialogOpen, setDialogOpen] = useState(false);\n  const [selectedStaff, setSelectedStaff] = useState<StaffType | undefined>();\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  const { data: staffMembers = [], isLoading } = useQuery<StaffType[]>({\n    queryKey: [\"/api/staff\"],\n  });\n\n  const { data: tenant } = useQuery<Tenant>({\n    queryKey: [\"/api/tenant\"],\n  });\n\n  // Calculate staff limit based on subscription plan\n  const planLimits: Record<string, number> = {\n    starter: 10,\n    growth: 50,\n    enterprise: Infinity,\n  };\n  const currentPlan = tenant?.subscriptionPlan || 'starter';\n  const staffLimit = planLimits[currentPlan] ?? 10;\n  const staffCount = staffMembers.length;\n\n  const deleteMutation = useMutation({\n    mutationFn: async (id: string) => {\n      return await apiRequest(`/api/staff/${id}`, \"DELETE\");\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/staff\"] });\n      toast({\n        title: \"Success\",\n        description: \"Staff member deleted successfully\",\n      });\n    },\n    onError: (error: Error) => {\n      if (isUnauthorizedError(error)) {\n        toast({\n          title: \"Unauthorized\",\n          description: \"You are logged out. Logging in again...\",\n          variant: \"destructive\",\n        });\n        setTimeout(() => {\n          window.location.href = \"/login\";\n        }, 500);\n        return;\n      }\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to delete staff member\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const toggleStatusMutation = useMutation({\n    mutationFn: async ({ id, status }: { id: string; status: string }) => {\n      return await apiRequest(`/api/staff/${id}`, \"PATCH\", {\n        status: status === \"active\" ? \"suspended\" : \"active\",\n      });\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/staff\"] });\n      toast({\n        title: \"Success\",\n        description: \"Staff status updated successfully\",\n      });\n    },\n    onError: (error: Error) => {\n      if (isUnauthorizedError(error)) {\n        toast({\n          title: \"Unauthorized\",\n          description: \"You are logged out. Logging in again...\",\n          variant: \"destructive\",\n        });\n        setTimeout(() => {\n          window.location.href = \"/login\";\n        }, 500);\n        return;\n      }\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to update staff status\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const filteredStaff = staffMembers.filter(staff => {\n    const matchesSearch = staff.name.toLowerCase().includes(searchQuery.toLowerCase()) ||\n                         staff.email.toLowerCase().includes(searchQuery.toLowerCase());\n    const matchesRole = roleFilter === \"all\" || staff.role.toLowerCase() === roleFilter.toLowerCase();\n    return matchesSearch && matchesRole;\n  });\n\n  const handleEdit = (staff: StaffType) => {\n    setSelectedStaff(staff);\n    setDialogOpen(true);\n  };\n\n  const handleAdd = () => {\n    setSelectedStaff(undefined);\n    setDialogOpen(true);\n  };\n\n  const handleDialogClose = (open: boolean) => {\n    setDialogOpen(open);\n    if (!open) {\n      setSelectedStaff(undefined);\n    }\n  };\n\n  return (\n    <div className=\"p-6 space-y-6\">\n      <div className=\"flex items-center justify-between gap-4\">\n        <div>\n          <div className=\"flex items-center gap-3 mb-1\">\n            <h1 className=\"text-3xl font-heading font-bold\" data-testid=\"text-staff-title\">\n              Staff Management\n            </h1>\n            <Badge variant=\"outline\" data-testid=\"badge-staff-limit\">\n              {staffCount} / {staffLimit === Infinity ? '' : staffLimit} staff\n            </Badge>\n          </div>\n          <p className=\"text-muted-foreground\">Manage your club's staff members and their permissions</p>\n        </div>\n        <Button onClick={handleAdd} data-testid=\"button-add-staff\">\n          <Plus className=\"w-4 h-4 mr-2\" />\n          Add Staff\n        </Button>\n      </div>\n\n      <div className=\"flex flex-col sm:flex-row gap-4\">\n        <div className=\"relative flex-1\">\n          <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground\" />\n          <Input\n            placeholder=\"Search by name or email...\"\n            className=\"pl-9\"\n            value={searchQuery}\n            onChange={(e) => setSearchQuery(e.target.value)}\n            data-testid=\"input-search-staff\"\n          />\n        </div>\n        <Select value={roleFilter} onValueChange={setRoleFilter}>\n          <SelectTrigger className=\"w-full sm:w-48\" data-testid=\"select-role-filter\">\n            <SelectValue placeholder=\"Filter by role\" />\n          </SelectTrigger>\n          <SelectContent>\n            <SelectItem value=\"all\">All Roles</SelectItem>\n            <SelectItem value=\"owner\">Owner</SelectItem>\n            <SelectItem value=\"admin\">Admin</SelectItem>\n            <SelectItem value=\"manager\">Manager</SelectItem>\n            <SelectItem value=\"staff\">Staff</SelectItem>\n            <SelectItem value=\"player\">Player</SelectItem>\n            <SelectItem value=\"marcom\">Marketing</SelectItem>\n            <SelectItem value=\"analyst\">Analyst</SelectItem>\n            <SelectItem value=\"finance\">Finance</SelectItem>\n          </SelectContent>\n        </Select>\n      </div>\n\n      {isLoading ? (\n        <div className=\"text-center py-12\">\n          <div className=\"inline-block h-8 w-8 animate-spin rounded-full border-4 border-solid border-primary border-r-transparent\"></div>\n          <p className=\"mt-4 text-muted-foreground\">Loading staff...</p>\n        </div>\n      ) : filteredStaff.length > 0 ? (\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n          {filteredStaff.map((staff) => (\n            <StaffCard\n              key={staff.id}\n              {...staff}\n              onEdit={() => handleEdit(staff)}\n              onDelete={() => deleteMutation.mutate(staff.id)}\n              onToggleStatus={() => toggleStatusMutation.mutate({ id: staff.id, status: staff.status })}\n            />\n          ))}\n        </div>\n      ) : (\n        <div className=\"text-center py-12\">\n          <p className=\"text-muted-foreground\">\n            {searchQuery || roleFilter !== \"all\" ? \"No staff members found matching your filters\" : \"No staff members yet\"}\n          </p>\n          {!searchQuery && roleFilter === \"all\" && (\n            <Button onClick={handleAdd} className=\"mt-4\" data-testid=\"button-add-first-staff\">\n              <Plus className=\"w-4 h-4 mr-2\" />\n              Add Your First Staff Member\n            </Button>\n          )}\n        </div>\n      )}\n\n      <StaffDialog\n        open={dialogOpen}\n        onOpenChange={handleDialogClose}\n        staff={selectedStaff}\n      />\n    </div>\n  );\n}\n","size_bytes":7756},"client/src/components/examples/MatchCard.tsx":{"content":"import { MatchCard } from \"../match-card\";\n\nexport default function MatchCardExample() {\n  return (\n    <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 p-6 bg-background\">\n      <MatchCard\n        id=\"1\"\n        teamA=\"Nexus Valorant\"\n        teamB=\"Team Phoenix\"\n        scoreA={2}\n        scoreB={1}\n        date={new Date('2024-10-08T18:00:00')}\n        tournament=\"VCT Champions\"\n        game=\"Valorant\"\n        venue=\"Online\"\n        status=\"completed\"\n      />\n      <MatchCard\n        id=\"2\"\n        teamA=\"Nexus League\"\n        teamB=\"Storm Esports\"\n        date={new Date('2024-10-12T20:00:00')}\n        tournament=\"LCS Summer Split\"\n        game=\"League of Legends\"\n        venue=\"LA Studio\"\n        status=\"upcoming\"\n      />\n      <MatchCard\n        id=\"3\"\n        teamA=\"Nexus PUBG\"\n        teamB=\"Elite Squad\"\n        scoreA={3}\n        scoreB={3}\n        date={new Date('2024-10-11T16:00:00')}\n        tournament=\"PGC Qualifiers\"\n        game=\"PUBG\"\n        status=\"live\"\n      />\n    </div>\n  );\n}\n","size_bytes":1035},"postcss.config.js":{"content":"export default {\n  plugins: {\n    tailwindcss: {},\n    autoprefixer: {},\n  },\n}\n","size_bytes":80},"client/src/pages/contracts.tsx":{"content":"import { ContractRow } from \"@/components/contract-row\";\nimport { ContractDialog } from \"@/components/contract-dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Upload, FileText, AlertTriangle, CheckCircle, Edit, Trash2, MoreHorizontal } from \"lucide-react\";\nimport { useState } from \"react\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { isUnauthorizedError } from \"@/lib/authUtils\";\nimport type { Contract as ContractType } from \"@shared/schema\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuTrigger,\n} from \"@/components/ui/dropdown-menu\";\n\nexport default function Contracts() {\n  const [dialogOpen, setDialogOpen] = useState(false);\n  const [selectedContract, setSelectedContract] = useState<ContractType | undefined>();\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  const { data: contracts = [], isLoading } = useQuery<ContractType[]>({\n    queryKey: [\"/api/contracts\"],\n  });\n\n  const deleteMutation = useMutation({\n    mutationFn: async (id: string) => {\n      return await apiRequest(`/api/contracts/${id}`, \"DELETE\");\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/contracts\"] });\n      toast({\n        title: \"Success\",\n        description: \"Contract deleted successfully\",\n      });\n    },\n    onError: (error: Error) => {\n      if (isUnauthorizedError(error)) {\n        toast({\n          title: \"Unauthorized\",\n          description: \"You are logged out. Logging in again...\",\n          variant: \"destructive\",\n        });\n        setTimeout(() => {\n          window.location.href = \"/login\";\n        }, 500);\n        return;\n      }\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to delete contract\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const activeContracts = contracts.filter(c => c.status === 'active').length;\n  const expiringContracts = contracts.filter(c => c.status === 'expiring').length;\n  const expiredContracts = contracts.filter(c => c.status === 'expired').length;\n\n  const handleEdit = (contract: ContractType) => {\n    setSelectedContract(contract);\n    setDialogOpen(true);\n  };\n\n  const handleAdd = () => {\n    setSelectedContract(undefined);\n    setDialogOpen(true);\n  };\n\n  const handleDelete = async (id: string) => {\n    if (confirm(\"Are you sure you want to delete this contract?\")) {\n      await deleteMutation.mutateAsync(id);\n    }\n  };\n\n  return (\n    <div className=\"p-6 space-y-6\">\n      <div className=\"flex items-center justify-between gap-4\">\n        <div>\n          <h1 className=\"text-3xl font-heading font-bold mb-1\" data-testid=\"text-contracts-title\">\n            Contracts Management\n          </h1>\n          <p className=\"text-muted-foreground\">Manage player, staff, and sponsor contracts</p>\n        </div>\n        <Button onClick={handleAdd} data-testid=\"button-upload-contract\">\n          <Upload className=\"w-4 h-4 mr-2\" />\n          Upload Contract\n        </Button>\n      </div>\n\n      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium text-muted-foreground\">Active Contracts</CardTitle>\n            <CheckCircle className=\"h-4 w-4 text-chart-2\" />\n          </CardHeader>\n          <CardContent>\n            {isLoading ? (\n              <Skeleton className=\"h-10 w-16\" />\n            ) : (\n              <>\n                <div className=\"text-3xl font-bold font-mono text-chart-2\" data-testid=\"stat-active-contracts\">\n                  {activeContracts}\n                </div>\n                <p className=\"text-xs text-muted-foreground mt-1\">Currently valid</p>\n              </>\n            )}\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium text-muted-foreground\">Expiring Soon</CardTitle>\n            <AlertTriangle className=\"h-4 w-4 text-chart-4\" />\n          </CardHeader>\n          <CardContent>\n            {isLoading ? (\n              <Skeleton className=\"h-10 w-16\" />\n            ) : (\n              <>\n                <div className=\"text-3xl font-bold font-mono text-chart-4\">\n                  {expiringContracts}\n                </div>\n                <p className=\"text-xs text-muted-foreground mt-1\">Within 30 days</p>\n              </>\n            )}\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium text-muted-foreground\">Expired</CardTitle>\n            <FileText className=\"h-4 w-4 text-chart-5\" />\n          </CardHeader>\n          <CardContent>\n            {isLoading ? (\n              <Skeleton className=\"h-10 w-16\" />\n            ) : (\n              <>\n                <div className=\"text-3xl font-bold font-mono text-chart-5\">\n                  {expiredContracts}\n                </div>\n                <p className=\"text-xs text-muted-foreground mt-1\">Needs renewal</p>\n              </>\n            )}\n          </CardContent>\n        </Card>\n      </div>\n\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"text-lg font-heading\">All Contracts</CardTitle>\n        </CardHeader>\n        <CardContent className=\"space-y-3\">\n          {isLoading ? (\n            <div className=\"space-y-3\">\n              {[1, 2, 3, 4].map((i) => (\n                <Skeleton key={i} className=\"h-16 w-full\" />\n              ))}\n            </div>\n          ) : contracts.length === 0 ? (\n            <div className=\"text-center py-8 text-muted-foreground\">\n              No contracts yet. Upload your first contract to get started.\n            </div>\n          ) : (\n            contracts.map((contract) => (\n              <div key={contract.id} className=\"flex items-center gap-3 group\">\n                <div className=\"flex-1\">\n                  <ContractRow\n                    {...contract}\n                    expirationDate={new Date(contract.expirationDate)}\n                  />\n                </div>\n                <DropdownMenu>\n                  <DropdownMenuTrigger asChild>\n                    <Button variant=\"ghost\" size=\"icon\" className=\"opacity-0 group-hover:opacity-100 transition-opacity\" data-testid={`button-menu-contract-${contract.id}`}>\n                      <MoreHorizontal className=\"h-4 w-4\" />\n                    </Button>\n                  </DropdownMenuTrigger>\n                  <DropdownMenuContent align=\"end\">\n                    <DropdownMenuItem onClick={() => handleEdit(contract)} data-testid={`button-edit-contract-${contract.id}`}>\n                      <Edit className=\"h-4 w-4 mr-2\" />\n                      Edit\n                    </DropdownMenuItem>\n                    <DropdownMenuItem\n                      onClick={() => handleDelete(contract.id)}\n                      className=\"text-destructive\"\n                      data-testid={`button-delete-contract-${contract.id}`}\n                    >\n                      <Trash2 className=\"h-4 w-4 mr-2\" />\n                      Delete\n                    </DropdownMenuItem>\n                  </DropdownMenuContent>\n                </DropdownMenu>\n              </div>\n            ))\n          )}\n        </CardContent>\n      </Card>\n\n      <ContractDialog\n        open={dialogOpen}\n        onOpenChange={setDialogOpen}\n        contract={selectedContract}\n      />\n    </div>\n  );\n}\n","size_bytes":7914},"client/src/components/ui/form.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport {\n  Controller,\n  FormProvider,\n  useFormContext,\n  type ControllerProps,\n  type FieldPath,\n  type FieldValues,\n} from \"react-hook-form\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Label } from \"@/components/ui/label\"\n\nconst Form = FormProvider\n\ntype FormFieldContextValue<\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n> = {\n  name: TName\n}\n\nconst FormFieldContext = React.createContext<FormFieldContextValue>(\n  {} as FormFieldContextValue\n)\n\nconst FormField = <\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n>({\n  ...props\n}: ControllerProps<TFieldValues, TName>) => {\n  return (\n    <FormFieldContext.Provider value={{ name: props.name }}>\n      <Controller {...props} />\n    </FormFieldContext.Provider>\n  )\n}\n\nconst useFormField = () => {\n  const fieldContext = React.useContext(FormFieldContext)\n  const itemContext = React.useContext(FormItemContext)\n  const { getFieldState, formState } = useFormContext()\n\n  const fieldState = getFieldState(fieldContext.name, formState)\n\n  if (!fieldContext) {\n    throw new Error(\"useFormField should be used within <FormField>\")\n  }\n\n  const { id } = itemContext\n\n  return {\n    id,\n    name: fieldContext.name,\n    formItemId: `${id}-form-item`,\n    formDescriptionId: `${id}-form-item-description`,\n    formMessageId: `${id}-form-item-message`,\n    ...fieldState,\n  }\n}\n\ntype FormItemContextValue = {\n  id: string\n}\n\nconst FormItemContext = React.createContext<FormItemContextValue>(\n  {} as FormItemContextValue\n)\n\nconst FormItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const id = React.useId()\n\n  return (\n    <FormItemContext.Provider value={{ id }}>\n      <div ref={ref} className={cn(\"space-y-2\", className)} {...props} />\n    </FormItemContext.Provider>\n  )\n})\nFormItem.displayName = \"FormItem\"\n\nconst FormLabel = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  const { error, formItemId } = useFormField()\n\n  return (\n    <Label\n      ref={ref}\n      className={cn(error && \"text-destructive\", className)}\n      htmlFor={formItemId}\n      {...props}\n    />\n  )\n})\nFormLabel.displayName = \"FormLabel\"\n\nconst FormControl = React.forwardRef<\n  React.ElementRef<typeof Slot>,\n  React.ComponentPropsWithoutRef<typeof Slot>\n>(({ ...props }, ref) => {\n  const { error, formItemId, formDescriptionId, formMessageId } = useFormField()\n\n  return (\n    <Slot\n      ref={ref}\n      id={formItemId}\n      aria-describedby={\n        !error\n          ? `${formDescriptionId}`\n          : `${formDescriptionId} ${formMessageId}`\n      }\n      aria-invalid={!!error}\n      {...props}\n    />\n  )\n})\nFormControl.displayName = \"FormControl\"\n\nconst FormDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => {\n  const { formDescriptionId } = useFormField()\n\n  return (\n    <p\n      ref={ref}\n      id={formDescriptionId}\n      className={cn(\"text-sm text-muted-foreground\", className)}\n      {...props}\n    />\n  )\n})\nFormDescription.displayName = \"FormDescription\"\n\nconst FormMessage = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, children, ...props }, ref) => {\n  const { error, formMessageId } = useFormField()\n  const body = error ? String(error?.message ?? \"\") : children\n\n  if (!body) {\n    return null\n  }\n\n  return (\n    <p\n      ref={ref}\n      id={formMessageId}\n      className={cn(\"text-sm font-medium text-destructive\", className)}\n      {...props}\n    >\n      {body}\n    </p>\n  )\n})\nFormMessage.displayName = \"FormMessage\"\n\nexport {\n  useFormField,\n  Form,\n  FormItem,\n  FormLabel,\n  FormControl,\n  FormDescription,\n  FormMessage,\n  FormField,\n}\n","size_bytes":4120},"client/src/components/ui/input.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Input = React.forwardRef<HTMLInputElement, React.ComponentProps<\"input\">>(\n  ({ className, type, ...props }, ref) => {\n    // h-9 to match icon buttons and default buttons.\n    return (\n      <input\n        type={type}\n        className={cn(\n          \"flex h-9 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nInput.displayName = \"Input\"\n\nexport { Input }\n","size_bytes":844},"client/src/components/ui/scroll-area.tsx":{"content":"import * as React from \"react\"\nimport * as ScrollAreaPrimitive from \"@radix-ui/react-scroll-area\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ScrollArea = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <ScrollAreaPrimitive.Root\n    ref={ref}\n    className={cn(\"relative overflow-hidden\", className)}\n    {...props}\n  >\n    <ScrollAreaPrimitive.Viewport className=\"h-full w-full rounded-[inherit]\">\n      {children}\n    </ScrollAreaPrimitive.Viewport>\n    <ScrollBar />\n    <ScrollAreaPrimitive.Corner />\n  </ScrollAreaPrimitive.Root>\n))\nScrollArea.displayName = ScrollAreaPrimitive.Root.displayName\n\nconst ScrollBar = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>\n>(({ className, orientation = \"vertical\", ...props }, ref) => (\n  <ScrollAreaPrimitive.ScrollAreaScrollbar\n    ref={ref}\n    orientation={orientation}\n    className={cn(\n      \"flex touch-none select-none transition-colors\",\n      orientation === \"vertical\" &&\n        \"h-full w-2.5 border-l border-l-transparent p-[1px]\",\n      orientation === \"horizontal\" &&\n        \"h-2.5 flex-col border-t border-t-transparent p-[1px]\",\n      className\n    )}\n    {...props}\n  >\n    <ScrollAreaPrimitive.ScrollAreaThumb className=\"relative flex-1 rounded-full bg-border\" />\n  </ScrollAreaPrimitive.ScrollAreaScrollbar>\n))\nScrollBar.displayName = ScrollAreaPrimitive.ScrollAreaScrollbar.displayName\n\nexport { ScrollArea, ScrollBar }\n","size_bytes":1642},"client/src/components/ui/textarea.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Textarea = React.forwardRef<\n  HTMLTextAreaElement,\n  React.ComponentProps<\"textarea\">\n>(({ className, ...props }, ref) => {\n  return (\n    <textarea\n      className={cn(\n        \"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  )\n})\nTextarea.displayName = \"Textarea\"\n\nexport { Textarea }\n","size_bytes":689},"client/src/pages/dashboard.tsx":{"content":"import { StatCard } from \"@/components/stat-card\";\nimport { MatchCard } from \"@/components/match-card\";\nimport { CampaignCard } from \"@/components/campaign-card\";\nimport { DollarSign, Users, Trophy, Megaphone, TrendingUp, Calendar } from \"lucide-react\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport type { Match, Campaign, AuditLog, Staff, Payroll } from \"@shared/schema\";\nimport { formatDistanceToNow } from \"date-fns\";\n\nexport default function Dashboard() {\n  const { data: matches = [] } = useQuery<Match[]>({\n    queryKey: [\"/api/matches\"],\n  });\n\n  const { data: campaigns = [] } = useQuery<Campaign[]>({\n    queryKey: [\"/api/campaigns\"],\n  });\n\n  const { data: auditLogs = [] } = useQuery<AuditLog[]>({\n    queryKey: [\"/api/audit-logs\"],\n  });\n\n  const { data: staff = [] } = useQuery<Staff[]>({\n    queryKey: [\"/api/staff\"],\n  });\n\n  const { data: payroll = [] } = useQuery<Payroll[]>({\n    queryKey: [\"/api/payroll\"],\n  });\n\n  const upcomingMatches = matches\n    .filter(m => m.status === \"upcoming\")\n    .sort((a, b) => new Date(a.date).getTime() - new Date(b.date).getTime())\n    .slice(0, 2)\n    .map(m => ({\n      ...m,\n      scoreA: m.scoreA ?? undefined,\n      scoreB: m.scoreB ?? undefined,\n      venue: m.venue ?? undefined,\n      status: m.status as \"upcoming\" | \"live\" | \"completed\",\n    }));\n\n  const activeCampaigns = campaigns\n    .filter(c => c.status === \"active\")\n    .slice(0, 3)\n    .map(c => ({\n      ...c,\n      platforms: c.platforms as Array<'twitter' | 'instagram' | 'youtube' | 'tiktok' | 'twitch'>,\n      reach: c.reach ?? undefined,\n      engagement: c.engagement ? parseFloat(c.engagement) : undefined,\n      status: c.status as \"active\" | \"completed\" | \"scheduled\",\n    }));\n\n  const recentActivity = auditLogs.slice(0, 4);\n\n  const totalRevenue = payroll\n    .filter(p => p.status === \"paid\")\n    .reduce((sum, p) => sum + parseFloat(p.amount), 0);\n\n  const activeStaffCount = staff.filter(s => s.status === \"active\").length;\n\n  const completedMatches = matches.filter(m => m.status === \"completed\");\n  const wonMatches = completedMatches.filter(m => \n    (m.scoreA && m.scoreB && m.scoreA > m.scoreB)\n  ).length;\n  const winRate = completedMatches.length > 0 \n    ? Math.round((wonMatches / completedMatches.length) * 100) \n    : 0;\n\n  const thisWeekMatches = matches.filter(m => {\n    const matchDate = new Date(m.date);\n    const now = new Date();\n    const weekFromNow = new Date(now.getTime() + 7 * 24 * 60 * 60 * 1000);\n    return matchDate >= now && matchDate <= weekFromNow;\n  }).length;\n\n  return (\n    <div className=\"p-6 space-y-6\">\n      <div>\n        <h1 className=\"text-3xl font-heading font-bold mb-1\" data-testid=\"text-dashboard-title\">\n          Dashboard\n        </h1>\n        <p className=\"text-muted-foreground\">Welcome back! Here's what's happening with your esports club.</p>\n      </div>\n\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\n        <StatCard\n          title=\"Total Revenue\"\n          value={`$${totalRevenue.toLocaleString()}`}\n          icon={DollarSign}\n          subtitle=\"Paid this month\"\n        />\n        <StatCard\n          title=\"Active Staff\"\n          value={activeStaffCount.toString()}\n          icon={Users}\n          subtitle=\"Team members\"\n        />\n        <StatCard\n          title=\"Win Rate\"\n          value={`${winRate}%`}\n          icon={Trophy}\n          subtitle={`${wonMatches}/${completedMatches.length} matches`}\n        />\n        <StatCard\n          title=\"Active Campaigns\"\n          value={activeCampaigns.length.toString()}\n          icon={Megaphone}\n          subtitle=\"Marketing campaigns\"\n        />\n      </div>\n\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-3\">\n            <CardTitle className=\"text-lg font-heading\">Upcoming Matches</CardTitle>\n            <Button variant=\"ghost\" size=\"sm\" data-testid=\"button-view-all-matches\">\n              View All\n            </Button>\n          </CardHeader>\n          <CardContent className=\"space-y-3\">\n            {upcomingMatches.length > 0 ? (\n              upcomingMatches.map((match) => (\n                <MatchCard key={match.id} {...match} />\n              ))\n            ) : (\n              <p className=\"text-sm text-muted-foreground text-center py-4\">No upcoming matches</p>\n            )}\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-3\">\n            <CardTitle className=\"text-lg font-heading\">Recent Activity</CardTitle>\n            <Button variant=\"ghost\" size=\"sm\" data-testid=\"button-view-audit-log\">\n              View All\n            </Button>\n          </CardHeader>\n          <CardContent>\n            <div className=\"space-y-3\">\n              {recentActivity.length > 0 ? (\n                recentActivity.map((activity) => (\n                  <div key={activity.id} className=\"flex items-start gap-3 p-3 rounded-lg hover-elevate\">\n                    <div className=\"w-2 h-2 rounded-full bg-primary mt-2 shrink-0\" />\n                    <div className=\"flex-1 min-w-0\">\n                      <p className=\"text-sm\">{activity.action}</p>\n                      <p className=\"text-xs text-muted-foreground mt-1\">\n                        {formatDistanceToNow(new Date(activity.timestamp!), { addSuffix: true })}\n                      </p>\n                    </div>\n                  </div>\n                ))\n              ) : (\n                <p className=\"text-sm text-muted-foreground text-center py-4\">No recent activity</p>\n              )}\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n\n      <Card>\n        <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0\">\n          <CardTitle className=\"text-lg font-heading\">Active Marketing Campaigns</CardTitle>\n          <Button variant=\"ghost\" size=\"sm\" data-testid=\"button-view-all-campaigns\">\n            View All\n          </Button>\n        </CardHeader>\n        <CardContent>\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n            {activeCampaigns.length > 0 ? (\n              activeCampaigns.map((campaign) => (\n                <CampaignCard key={campaign.id} {...campaign} />\n              ))\n            ) : (\n              <p className=\"text-sm text-muted-foreground text-center py-4 col-span-full\">No active campaigns</p>\n            )}\n          </div>\n        </CardContent>\n      </Card>\n\n      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n        <Card className=\"hover-elevate active-elevate-2 cursor-pointer\">\n          <CardContent className=\"pt-6\">\n            <div className=\"flex items-center gap-3\">\n              <div className=\"w-12 h-12 rounded-lg bg-chart-2/10 flex items-center justify-center\">\n                <TrendingUp className=\"w-6 h-6 text-chart-2\" />\n              </div>\n              <div>\n                <p className=\"text-2xl font-bold font-mono\">{wonMatches}</p>\n                <p className=\"text-sm text-muted-foreground\">Total Wins</p>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card className=\"hover-elevate active-elevate-2 cursor-pointer\">\n          <CardContent className=\"pt-6\">\n            <div className=\"flex items-center gap-3\">\n              <div className=\"w-12 h-12 rounded-lg bg-primary/10 flex items-center justify-center\">\n                <Calendar className=\"w-6 h-6 text-primary\" />\n              </div>\n              <div>\n                <p className=\"text-2xl font-bold font-mono\">{thisWeekMatches}</p>\n                <p className=\"text-sm text-muted-foreground\">Matches This Week</p>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card className=\"hover-elevate active-elevate-2 cursor-pointer\">\n          <CardContent className=\"pt-6\">\n            <div className=\"flex items-center gap-3\">\n              <div className=\"w-12 h-12 rounded-lg bg-chart-4/10 flex items-center justify-center\">\n                <Users className=\"w-6 h-6 text-chart-4\" />\n              </div>\n              <div>\n                <p className=\"text-2xl font-bold font-mono\">{activeStaffCount}</p>\n                <p className=\"text-sm text-muted-foreground\">Total Staff Members</p>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}\n","size_bytes":8659},"server/db.ts":{"content":"import { Pool, neonConfig } from '@neondatabase/serverless';\nimport { drizzle } from 'drizzle-orm/neon-serverless';\nimport ws from \"ws\";\nimport * as schema from \"@shared/schema\";\n\nneonConfig.webSocketConstructor = ws;\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\n    \"DATABASE_URL must be set. Did you forget to provision a database?\",\n  );\n}\n\nexport const pool = new Pool({ connectionString: process.env.DATABASE_URL });\nexport const db = drizzle({ client: pool, schema });\n","size_bytes":483},"client/src/pages/landing.tsx":{"content":"import { Button } from \"@/components/ui/button\";\nimport { Card } from \"@/components/ui/card\";\nimport { Trophy, Users, DollarSign, Calendar, FileText, BarChart3, Shield, Zap } from \"lucide-react\";\n\nexport default function Landing() {\n  const features = [\n    {\n      icon: Users,\n      title: \"Staff Management\",\n      description: \"Manage your esports team roster with role-based permissions and instant updates\"\n    },\n    {\n      icon: DollarSign,\n      title: \"Payroll System\",\n      description: \"Track salaries, bonuses, and payments with automated calculations and export features\"\n    },\n    {\n      icon: Calendar,\n      title: \"Match Scheduling\",\n      description: \"Organize tournaments and matches with calendar and list views, live score updates\"\n    },\n    {\n      icon: BarChart3,\n      title: \"Analytics Dashboard\",\n      description: \"Real-time insights into team performance, revenue, and campaign effectiveness\"\n    },\n    {\n      icon: FileText,\n      title: \"Contract Management\",\n      description: \"Store and manage player, staff, and sponsor contracts with expiration tracking\"\n    },\n    {\n      icon: Shield,\n      title: \"Audit Logging\",\n      description: \"Complete audit trail of all changes with before/after values for compliance\"\n    }\n  ];\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      {/* Hero Section */}\n      <div className=\"relative overflow-hidden\">\n        <div className=\"absolute inset-0 bg-gradient-to-br from-primary/20 via-transparent to-primary/10\" />\n        \n        <div className=\"container relative mx-auto px-4 py-20\">\n          <div className=\"flex flex-col items-center text-center gap-8 max-w-4xl mx-auto\">\n            <div className=\"inline-flex items-center gap-2 px-4 py-2 rounded-full bg-primary/10 border border-primary/20\">\n              <Zap className=\"w-4 h-4 text-primary\" />\n              <span className=\"text-sm font-medium text-primary\">The Future of Esports Management</span>\n            </div>\n            \n            <h1 className=\"text-5xl md:text-7xl font-bold tracking-tight\">\n              <span className=\"bg-gradient-to-r from-primary via-primary/80 to-primary/60 bg-clip-text text-transparent\">\n                Nexus Esports Suite\n              </span>\n            </h1>\n            \n            <p className=\"text-xl md:text-2xl text-muted-foreground max-w-2xl\">\n              Comprehensive multi-tenant SaaS platform for professional esports club management. \n              Track rosters, manage payroll, schedule matches, and drive growthall in one place.\n            </p>\n            \n            <div className=\"flex flex-col sm:flex-row gap-4 mt-4\">\n              <Button \n                size=\"lg\" \n                className=\"text-lg px-8\"\n                data-testid=\"button-login\"\n                onClick={() => window.location.href = \"/login\"}\n              >\n                <Trophy className=\"w-5 h-5 mr-2\" />\n                Get Started\n              </Button>\n              <Button \n                size=\"lg\" \n                variant=\"outline\" \n                className=\"text-lg px-8\"\n                data-testid=\"button-learn-more\"\n              >\n                Learn More\n              </Button>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Features Grid */}\n      <div className=\"container mx-auto px-4 py-20\">\n        <div className=\"text-center mb-16\">\n          <h2 className=\"text-3xl md:text-4xl font-bold mb-4\">\n            Everything You Need to Manage Your Esports Club\n          </h2>\n          <p className=\"text-lg text-muted-foreground max-w-2xl mx-auto\">\n            Built for teams of all sizes, from amateur to professional. Secure, scalable, and easy to use.\n          </p>\n        </div>\n\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n          {features.map((feature, index) => (\n            <Card \n              key={index} \n              className=\"p-6 hover-elevate transition-all\"\n              data-testid={`card-feature-${index}`}\n            >\n              <feature.icon className=\"w-12 h-12 text-primary mb-4\" />\n              <h3 className=\"text-xl font-semibold mb-2\">{feature.title}</h3>\n              <p className=\"text-muted-foreground\">{feature.description}</p>\n            </Card>\n          ))}\n        </div>\n      </div>\n\n      {/* CTA Section */}\n      <div className=\"container mx-auto px-4 py-20\">\n        <Card className=\"p-12 text-center bg-gradient-to-br from-primary/10 to-primary/5 border-primary/20\">\n          <h2 className=\"text-3xl md:text-4xl font-bold mb-4\">\n            Ready to Elevate Your Esports Club?\n          </h2>\n          <p className=\"text-lg text-muted-foreground mb-8 max-w-2xl mx-auto\">\n            Join leading esports organizations using Nexus to streamline operations and accelerate growth.\n          </p>\n          <Button \n            size=\"lg\" \n            className=\"text-lg px-8\"\n            data-testid=\"button-get-started-bottom\"\n            onClick={() => window.location.href = \"/login\"}\n          >\n            <Trophy className=\"w-5 h-5 mr-2\" />\n            Get Started Now\n          </Button>\n        </Card>\n      </div>\n    </div>\n  );\n}\n","size_bytes":5205},"client/src/lib/utils.ts":{"content":"import { clsx, type ClassValue } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n","size_bytes":166},"client/src/components/ui/checkbox.tsx":{"content":"import * as React from \"react\"\nimport * as CheckboxPrimitive from \"@radix-ui/react-checkbox\"\nimport { Check } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Checkbox = React.forwardRef<\n  React.ElementRef<typeof CheckboxPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <CheckboxPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground\",\n      className\n    )}\n    {...props}\n  >\n    <CheckboxPrimitive.Indicator\n      className={cn(\"flex items-center justify-center text-current\")}\n    >\n      <Check className=\"h-4 w-4\" />\n    </CheckboxPrimitive.Indicator>\n  </CheckboxPrimitive.Root>\n))\nCheckbox.displayName = CheckboxPrimitive.Root.displayName\n\nexport { Checkbox }\n","size_bytes":1056},"client/src/components/ui/drawer.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { Drawer as DrawerPrimitive } from \"vaul\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Drawer = ({\n  shouldScaleBackground = true,\n  ...props\n}: React.ComponentProps<typeof DrawerPrimitive.Root>) => (\n  <DrawerPrimitive.Root\n    shouldScaleBackground={shouldScaleBackground}\n    {...props}\n  />\n)\nDrawer.displayName = \"Drawer\"\n\nconst DrawerTrigger = DrawerPrimitive.Trigger\n\nconst DrawerPortal = DrawerPrimitive.Portal\n\nconst DrawerClose = DrawerPrimitive.Close\n\nconst DrawerOverlay = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Overlay\n    ref={ref}\n    className={cn(\"fixed inset-0 z-50 bg-black/80\", className)}\n    {...props}\n  />\n))\nDrawerOverlay.displayName = DrawerPrimitive.Overlay.displayName\n\nconst DrawerContent = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DrawerPortal>\n    <DrawerOverlay />\n    <DrawerPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background\",\n        className\n      )}\n      {...props}\n    >\n      <div className=\"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted\" />\n      {children}\n    </DrawerPrimitive.Content>\n  </DrawerPortal>\n))\nDrawerContent.displayName = \"DrawerContent\"\n\nconst DrawerHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"grid gap-1.5 p-4 text-center sm:text-left\", className)}\n    {...props}\n  />\n)\nDrawerHeader.displayName = \"DrawerHeader\"\n\nconst DrawerFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"mt-auto flex flex-col gap-2 p-4\", className)}\n    {...props}\n  />\n)\nDrawerFooter.displayName = \"DrawerFooter\"\n\nconst DrawerTitle = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDrawerTitle.displayName = DrawerPrimitive.Title.displayName\n\nconst DrawerDescription = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDrawerDescription.displayName = DrawerPrimitive.Description.displayName\n\nexport {\n  Drawer,\n  DrawerPortal,\n  DrawerOverlay,\n  DrawerTrigger,\n  DrawerClose,\n  DrawerContent,\n  DrawerHeader,\n  DrawerFooter,\n  DrawerTitle,\n  DrawerDescription,\n}\n","size_bytes":3021},"client/src/components/ui/separator.tsx":{"content":"import * as React from \"react\"\nimport * as SeparatorPrimitive from \"@radix-ui/react-separator\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Separator = React.forwardRef<\n  React.ElementRef<typeof SeparatorPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SeparatorPrimitive.Root>\n>(\n  (\n    { className, orientation = \"horizontal\", decorative = true, ...props },\n    ref\n  ) => (\n    <SeparatorPrimitive.Root\n      ref={ref}\n      decorative={decorative}\n      orientation={orientation}\n      className={cn(\n        \"shrink-0 bg-border\",\n        orientation === \"horizontal\" ? \"h-[1px] w-full\" : \"h-full w-[1px]\",\n        className\n      )}\n      {...props}\n    />\n  )\n)\nSeparator.displayName = SeparatorPrimitive.Root.displayName\n\nexport { Separator }\n","size_bytes":756},"client/src/components/staff-card.tsx":{"content":"import { Card, CardContent, CardFooter } from \"@/components/ui/card\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { MoreVertical, Mail, Phone } from \"lucide-react\";\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuTrigger,\n} from \"@/components/ui/dropdown-menu\";\n\ninterface StaffCardProps {\n  id: string;\n  name: string;\n  role: string;\n  email: string;\n  phone?: string;\n  avatar?: string;\n  permissions: string[];\n  status: \"active\" | \"suspended\";\n  onEdit?: () => void;\n  onDelete?: () => void;\n  onToggleStatus?: () => void;\n}\n\nexport function StaffCard({ id, name, role, email, phone, avatar, permissions, status, onEdit, onDelete, onToggleStatus }: StaffCardProps) {\n  const initials = name.split(' ').map(n => n[0]).join('').toUpperCase();\n  const roleColors: Record<string, string> = {\n    'Owner': 'bg-primary text-primary-foreground',\n    'Admin': 'bg-chart-3 text-primary-foreground',\n    'Manager': 'bg-chart-2 text-primary-foreground',\n    'Staff': 'bg-secondary text-secondary-foreground',\n    'Player': 'bg-accent text-accent-foreground',\n  };\n\n  return (\n    <Card className=\"hover-elevate\" data-testid={`card-staff-${id}`}>\n      <CardContent className=\"pt-6\">\n        <div className=\"flex items-start justify-between\">\n          <div className=\"flex items-start gap-3 flex-1\">\n            <Avatar className=\"w-12 h-12\">\n              {avatar && <AvatarImage src={avatar} alt={name} />}\n              <AvatarFallback className=\"bg-primary text-primary-foreground\">{initials}</AvatarFallback>\n            </Avatar>\n            <div className=\"flex-1 min-w-0\">\n              <h3 className=\"font-semibold text-base truncate\" data-testid={`text-name-${id}`}>{name}</h3>\n              <Badge className={`${roleColors[role] || roleColors['Staff']} text-xs mt-1`}>\n                {role}\n              </Badge>\n              <div className=\"flex flex-col gap-1 mt-2\">\n                <div className=\"flex items-center gap-1 text-xs text-muted-foreground\">\n                  <Mail className=\"w-3 h-3\" />\n                  <span className=\"truncate\">{email}</span>\n                </div>\n                {phone && (\n                  <div className=\"flex items-center gap-1 text-xs text-muted-foreground\">\n                    <Phone className=\"w-3 h-3\" />\n                    <span>{phone}</span>\n                  </div>\n                )}\n              </div>\n            </div>\n          </div>\n          <DropdownMenu>\n            <DropdownMenuTrigger asChild>\n              <Button variant=\"ghost\" size=\"icon\" data-testid={`button-menu-${id}`}>\n                <MoreVertical className=\"h-4 w-4\" />\n              </Button>\n            </DropdownMenuTrigger>\n            <DropdownMenuContent align=\"end\">\n              <DropdownMenuItem onClick={onEdit} data-testid={`button-edit-${id}`}>Edit Details</DropdownMenuItem>\n              <DropdownMenuItem onClick={onToggleStatus}>\n                {status === 'active' ? 'Suspend Account' : 'Activate Account'}\n              </DropdownMenuItem>\n              <DropdownMenuItem onClick={onDelete} className=\"text-destructive\">Delete</DropdownMenuItem>\n            </DropdownMenuContent>\n          </DropdownMenu>\n        </div>\n      </CardContent>\n      <CardFooter className=\"pt-0 pb-4 px-6\">\n        <div className=\"flex items-center gap-2 text-xs text-muted-foreground\">\n          <span className=\"font-medium\">{permissions.length} modules</span>\n          <span></span>\n          <span className={status === 'active' ? 'text-chart-2' : 'text-chart-5'}>\n            {status === 'active' ? 'Active' : 'Suspended'}\n          </span>\n        </div>\n      </CardFooter>\n    </Card>\n  );\n}\n","size_bytes":3818},"client/src/components/examples/ContractRow.tsx":{"content":"import { ContractRow } from \"../contract-row\";\n\nexport default function ContractRowExample() {\n  return (\n    <div className=\"flex flex-col gap-3 p-6 bg-background\">\n      <ContractRow\n        id=\"1\"\n        fileName=\"player_contract_alex_rivera.pdf\"\n        type=\"Player\"\n        linkedPerson=\"Alex Rivera\"\n        expirationDate={new Date('2025-12-31')}\n        status=\"active\"\n      />\n      <ContractRow\n        id=\"2\"\n        fileName=\"staff_agreement_sarah_johnson.pdf\"\n        type=\"Staff\"\n        linkedPerson=\"Sarah Johnson\"\n        expirationDate={new Date('2024-11-15')}\n        status=\"expiring\"\n      />\n      <ContractRow\n        id=\"3\"\n        fileName=\"sponsor_contract_techgear_inc.pdf\"\n        type=\"Sponsor\"\n        linkedPerson=\"TechGear Inc.\"\n        expirationDate={new Date('2024-09-30')}\n        status=\"expired\"\n      />\n    </div>\n  );\n}\n","size_bytes":864},"tailwind.config.ts":{"content":"import type { Config } from \"tailwindcss\";\n\nexport default {\n  darkMode: [\"class\"],\n  content: [\"./client/index.html\", \"./client/src/**/*.{js,jsx,ts,tsx}\"],\n  theme: {\n    extend: {\n      borderRadius: {\n        lg: \".5625rem\", /* 9px */\n        md: \".375rem\", /* 6px */\n        sm: \".1875rem\", /* 3px */\n      },\n      colors: {\n        // Flat / base colors (regular buttons)\n        background: \"hsl(var(--background) / <alpha-value>)\",\n        foreground: \"hsl(var(--foreground) / <alpha-value>)\",\n        border: \"hsl(var(--border) / <alpha-value>)\",\n        input: \"hsl(var(--input) / <alpha-value>)\",\n        card: {\n          DEFAULT: \"hsl(var(--card) / <alpha-value>)\",\n          foreground: \"hsl(var(--card-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--card-border) / <alpha-value>)\",\n        },\n        popover: {\n          DEFAULT: \"hsl(var(--popover) / <alpha-value>)\",\n          foreground: \"hsl(var(--popover-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--popover-border) / <alpha-value>)\",\n        },\n        primary: {\n          DEFAULT: \"hsl(var(--primary) / <alpha-value>)\",\n          foreground: \"hsl(var(--primary-foreground) / <alpha-value>)\",\n          border: \"var(--primary-border)\",\n        },\n        secondary: {\n          DEFAULT: \"hsl(var(--secondary) / <alpha-value>)\",\n          foreground: \"hsl(var(--secondary-foreground) / <alpha-value>)\",\n          border: \"var(--secondary-border)\",\n        },\n        muted: {\n          DEFAULT: \"hsl(var(--muted) / <alpha-value>)\",\n          foreground: \"hsl(var(--muted-foreground) / <alpha-value>)\",\n          border: \"var(--muted-border)\",\n        },\n        accent: {\n          DEFAULT: \"hsl(var(--accent) / <alpha-value>)\",\n          foreground: \"hsl(var(--accent-foreground) / <alpha-value>)\",\n          border: \"var(--accent-border)\",\n        },\n        destructive: {\n          DEFAULT: \"hsl(var(--destructive) / <alpha-value>)\",\n          foreground: \"hsl(var(--destructive-foreground) / <alpha-value>)\",\n          border: \"var(--destructive-border)\",\n        },\n        ring: \"hsl(var(--ring) / <alpha-value>)\",\n        chart: {\n          \"1\": \"hsl(var(--chart-1) / <alpha-value>)\",\n          \"2\": \"hsl(var(--chart-2) / <alpha-value>)\",\n          \"3\": \"hsl(var(--chart-3) / <alpha-value>)\",\n          \"4\": \"hsl(var(--chart-4) / <alpha-value>)\",\n          \"5\": \"hsl(var(--chart-5) / <alpha-value>)\",\n        },\n        sidebar: {\n          ring: \"hsl(var(--sidebar-ring) / <alpha-value>)\",\n          DEFAULT: \"hsl(var(--sidebar) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--sidebar-border) / <alpha-value>)\",\n        },\n        \"sidebar-primary\": {\n          DEFAULT: \"hsl(var(--sidebar-primary) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-primary-foreground) / <alpha-value>)\",\n          border: \"var(--sidebar-primary-border)\",\n        },\n        \"sidebar-accent\": {\n          DEFAULT: \"hsl(var(--sidebar-accent) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-accent-foreground) / <alpha-value>)\",\n          border: \"var(--sidebar-accent-border)\"\n        },\n        status: {\n          online: \"rgb(34 197 94)\",\n          away: \"rgb(245 158 11)\",\n          busy: \"rgb(239 68 68)\",\n          offline: \"rgb(156 163 175)\",\n        },\n      },\n      fontFamily: {\n        sans: [\"Inter\", \"var(--font-sans)\"],\n        heading: [\"Space Grotesk\", \"sans-serif\"],\n        mono: [\"JetBrains Mono\", \"var(--font-mono)\"],\n      },\n      keyframes: {\n        \"accordion-down\": {\n          from: { height: \"0\" },\n          to: { height: \"var(--radix-accordion-content-height)\" },\n        },\n        \"accordion-up\": {\n          from: { height: \"var(--radix-accordion-content-height)\" },\n          to: { height: \"0\" },\n        },\n      },\n      animation: {\n        \"accordion-down\": \"accordion-down 0.2s ease-out\",\n        \"accordion-up\": \"accordion-up 0.2s ease-out\",\n      },\n    },\n  },\n  plugins: [require(\"tailwindcss-animate\"), require(\"@tailwindcss/typography\")],\n} satisfies Config;\n","size_bytes":4089},"client/src/components/ui/alert.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst alertVariants = cva(\n  \"relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-background text-foreground\",\n        destructive:\n          \"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Alert = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>\n>(({ className, variant, ...props }, ref) => (\n  <div\n    ref={ref}\n    role=\"alert\"\n    className={cn(alertVariants({ variant }), className)}\n    {...props}\n  />\n))\nAlert.displayName = \"Alert\"\n\nconst AlertTitle = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h5\n    ref={ref}\n    className={cn(\"mb-1 font-medium leading-none tracking-tight\", className)}\n    {...props}\n  />\n))\nAlertTitle.displayName = \"AlertTitle\"\n\nconst AlertDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm [&_p]:leading-relaxed\", className)}\n    {...props}\n  />\n))\nAlertDescription.displayName = \"AlertDescription\"\n\nexport { Alert, AlertTitle, AlertDescription }\n","size_bytes":1584},"client/src/components/ui/resizable.tsx":{"content":"\"use client\"\n\nimport { GripVertical } from \"lucide-react\"\nimport * as ResizablePrimitive from \"react-resizable-panels\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ResizablePanelGroup = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelGroup>) => (\n  <ResizablePrimitive.PanelGroup\n    className={cn(\n      \"flex h-full w-full data-[panel-group-direction=vertical]:flex-col\",\n      className\n    )}\n    {...props}\n  />\n)\n\nconst ResizablePanel = ResizablePrimitive.Panel\n\nconst ResizableHandle = ({\n  withHandle,\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelResizeHandle> & {\n  withHandle?: boolean\n}) => (\n  <ResizablePrimitive.PanelResizeHandle\n    className={cn(\n      \"relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90\",\n      className\n    )}\n    {...props}\n  >\n    {withHandle && (\n      <div className=\"z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border\">\n        <GripVertical className=\"h-2.5 w-2.5\" />\n      </div>\n    )}\n  </ResizablePrimitive.PanelResizeHandle>\n)\n\nexport { ResizablePanelGroup, ResizablePanel, ResizableHandle }\n","size_bytes":1723},"client/src/components/ui/switch.tsx":{"content":"import * as React from \"react\"\nimport * as SwitchPrimitives from \"@radix-ui/react-switch\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Switch = React.forwardRef<\n  React.ElementRef<typeof SwitchPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>\n>(({ className, ...props }, ref) => (\n  <SwitchPrimitives.Root\n    className={cn(\n      \"peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  >\n    <SwitchPrimitives.Thumb\n      className={cn(\n        \"pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0\"\n      )}\n    />\n  </SwitchPrimitives.Root>\n))\nSwitch.displayName = SwitchPrimitives.Root.displayName\n\nexport { Switch }\n","size_bytes":1139},"client/src/components/ui/accordion.tsx":{"content":"import * as React from \"react\"\nimport * as AccordionPrimitive from \"@radix-ui/react-accordion\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Accordion = AccordionPrimitive.Root\n\nconst AccordionItem = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <AccordionPrimitive.Item\n    ref={ref}\n    className={cn(\"border-b\", className)}\n    {...props}\n  />\n))\nAccordionItem.displayName = \"AccordionItem\"\n\nconst AccordionTrigger = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Header className=\"flex\">\n    <AccordionPrimitive.Trigger\n      ref={ref}\n      className={cn(\n        \"flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <ChevronDown className=\"h-4 w-4 shrink-0 transition-transform duration-200\" />\n    </AccordionPrimitive.Trigger>\n  </AccordionPrimitive.Header>\n))\nAccordionTrigger.displayName = AccordionPrimitive.Trigger.displayName\n\nconst AccordionContent = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Content\n    ref={ref}\n    className=\"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down\"\n    {...props}\n  >\n    <div className={cn(\"pb-4 pt-0\", className)}>{children}</div>\n  </AccordionPrimitive.Content>\n))\n\nAccordionContent.displayName = AccordionPrimitive.Content.displayName\n\nexport { Accordion, AccordionItem, AccordionTrigger, AccordionContent }\n","size_bytes":1977},"client/src/hooks/use-mobile.tsx":{"content":"import * as React from \"react\"\n\nconst MOBILE_BREAKPOINT = 768\n\nexport function useIsMobile() {\n  const [isMobile, setIsMobile] = React.useState<boolean | undefined>(undefined)\n\n  React.useEffect(() => {\n    const mql = window.matchMedia(`(max-width: ${MOBILE_BREAKPOINT - 1}px)`)\n    const onChange = () => {\n      setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    }\n    mql.addEventListener(\"change\", onChange)\n    setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    return () => mql.removeEventListener(\"change\", onChange)\n  }, [])\n\n  return !!isMobile\n}\n","size_bytes":565},"client/src/pages/payroll.tsx":{"content":"import { PayrollDialog } from \"@/components/payroll-dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Plus, Download, DollarSign, TrendingUp, TrendingDown, Edit, Trash2 } from \"lucide-react\";\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from \"@/components/ui/table\";\nimport { useState } from \"react\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { isUnauthorizedError } from \"@/lib/authUtils\";\nimport type { Payroll as PayrollType } from \"@shared/schema\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuTrigger,\n} from \"@/components/ui/dropdown-menu\";\nimport { MoreHorizontal } from \"lucide-react\";\n\nexport default function Payroll() {\n  const [dialogOpen, setDialogOpen] = useState(false);\n  const [selectedPayroll, setSelectedPayroll] = useState<PayrollType | undefined>();\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  const { data: payrollEntries = [], isLoading } = useQuery<PayrollType[]>({\n    queryKey: [\"/api/payroll\"],\n  });\n\n  const deleteMutation = useMutation({\n    mutationFn: async (id: string) => {\n      return await apiRequest(`/api/payroll/${id}`, \"DELETE\");\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/payroll\"] });\n      toast({\n        title: \"Success\",\n        description: \"Payroll entry deleted successfully\",\n      });\n    },\n    onError: (error: Error) => {\n      if (isUnauthorizedError(error)) {\n        toast({\n          title: \"Unauthorized\",\n          description: \"You are logged out. Logging in again...\",\n          variant: \"destructive\",\n        });\n        setTimeout(() => {\n          window.location.href = \"/login\";\n        }, 500);\n        return;\n      }\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to delete payroll entry\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const totalSalaries = payrollEntries.reduce((sum, entry) => sum + Number(entry.amount), 0);\n  const paidAmount = payrollEntries.filter(e => e.status === 'paid').reduce((sum, e) => sum + Number(e.amount), 0);\n  const pendingAmount = payrollEntries.filter(e => e.status === 'pending').reduce((sum, e) => sum + Number(e.amount), 0);\n\n  const handleEdit = (payroll: PayrollType) => {\n    setSelectedPayroll(payroll);\n    setDialogOpen(true);\n  };\n\n  const handleAdd = () => {\n    setSelectedPayroll(undefined);\n    setDialogOpen(true);\n  };\n\n  const handleDelete = async (id: string) => {\n    if (confirm(\"Are you sure you want to delete this payroll entry?\")) {\n      await deleteMutation.mutateAsync(id);\n    }\n  };\n\n  return (\n    <div className=\"p-6 space-y-6\">\n      <div className=\"flex items-center justify-between gap-4\">\n        <div>\n          <h1 className=\"text-3xl font-heading font-bold mb-1\" data-testid=\"text-payroll-title\">\n            Payroll & Finance\n          </h1>\n          <p className=\"text-muted-foreground\">Manage staff salaries and financial transactions</p>\n        </div>\n        <div className=\"flex gap-2\">\n          <Button variant=\"outline\" data-testid=\"button-export\">\n            <Download className=\"w-4 h-4 mr-2\" />\n            Export CSV\n          </Button>\n          <Button onClick={handleAdd} data-testid=\"button-add-payroll\">\n            <Plus className=\"w-4 h-4 mr-2\" />\n            Add Payment\n          </Button>\n        </div>\n      </div>\n\n      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium text-muted-foreground\">Total Payroll</CardTitle>\n            <DollarSign className=\"h-4 w-4 text-muted-foreground\" />\n          </CardHeader>\n          <CardContent>\n            {isLoading ? (\n              <Skeleton className=\"h-10 w-32\" />\n            ) : (\n              <>\n                <div className=\"text-3xl font-bold font-mono\" data-testid=\"stat-total-payroll\">\n                  ${totalSalaries.toLocaleString()}\n                </div>\n                <p className=\"text-xs text-muted-foreground mt-1\">Total payroll</p>\n              </>\n            )}\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium text-muted-foreground\">Paid</CardTitle>\n            <TrendingUp className=\"h-4 w-4 text-chart-2\" />\n          </CardHeader>\n          <CardContent>\n            {isLoading ? (\n              <Skeleton className=\"h-10 w-32\" />\n            ) : (\n              <>\n                <div className=\"text-3xl font-bold font-mono text-chart-2\">\n                  ${paidAmount.toLocaleString()}\n                </div>\n                <p className=\"text-xs text-muted-foreground mt-1\">{payrollEntries.filter(e => e.status === 'paid').length} transactions</p>\n              </>\n            )}\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium text-muted-foreground\">Pending</CardTitle>\n            <TrendingDown className=\"h-4 w-4 text-chart-4\" />\n          </CardHeader>\n          <CardContent>\n            {isLoading ? (\n              <Skeleton className=\"h-10 w-32\" />\n            ) : (\n              <>\n                <div className=\"text-3xl font-bold font-mono text-chart-4\">\n                  ${pendingAmount.toLocaleString()}\n                </div>\n                <p className=\"text-xs text-muted-foreground mt-1\">{payrollEntries.filter(e => e.status === 'pending').length} transactions</p>\n              </>\n            )}\n          </CardContent>\n        </Card>\n      </div>\n\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"text-lg font-heading\">Payment History</CardTitle>\n        </CardHeader>\n        <CardContent>\n          {isLoading ? (\n            <div className=\"space-y-2\">\n              {[1, 2, 3, 4, 5].map((i) => (\n                <Skeleton key={i} className=\"h-12 w-full\" />\n              ))}\n            </div>\n          ) : payrollEntries.length === 0 ? (\n            <div className=\"text-center py-8 text-muted-foreground\">\n              No payroll entries yet. Add your first payment to get started.\n            </div>\n          ) : (\n            <Table>\n              <TableHeader>\n                <TableRow>\n                  <TableHead>Name</TableHead>\n                  <TableHead>Role</TableHead>\n                  <TableHead>Type</TableHead>\n                  <TableHead>Amount</TableHead>\n                  <TableHead>Date</TableHead>\n                  <TableHead>Status</TableHead>\n                  <TableHead className=\"w-12\"></TableHead>\n                </TableRow>\n              </TableHeader>\n              <TableBody>\n                {payrollEntries.map((entry) => (\n                  <TableRow key={entry.id} className=\"hover-elevate\" data-testid={`row-payroll-${entry.id}`}>\n                    <TableCell className=\"font-medium\">{entry.name}</TableCell>\n                    <TableCell className=\"text-muted-foreground\">{entry.role}</TableCell>\n                    <TableCell>\n                      <Badge variant={entry.type === 'monthly' ? 'secondary' : 'outline'} className=\"text-xs\">\n                        {entry.type.charAt(0).toUpperCase() + entry.type.slice(1)}\n                      </Badge>\n                    </TableCell>\n                    <TableCell className=\"font-mono font-semibold\">\n                      ${Number(entry.amount).toLocaleString()}\n                    </TableCell>\n                    <TableCell className=\"text-muted-foreground text-sm\">\n                      {new Date(entry.date).toLocaleDateString()}\n                    </TableCell>\n                    <TableCell>\n                      <Badge className={entry.status === 'paid' ? 'bg-chart-2 text-primary-foreground' : 'bg-chart-4 text-primary-foreground'}>\n                        {entry.status.charAt(0).toUpperCase() + entry.status.slice(1)}\n                      </Badge>\n                    </TableCell>\n                    <TableCell>\n                      <DropdownMenu>\n                        <DropdownMenuTrigger asChild>\n                          <Button variant=\"ghost\" size=\"icon\" data-testid={`button-menu-payroll-${entry.id}`}>\n                            <MoreHorizontal className=\"h-4 w-4\" />\n                          </Button>\n                        </DropdownMenuTrigger>\n                        <DropdownMenuContent align=\"end\">\n                          <DropdownMenuItem onClick={() => handleEdit(entry)} data-testid={`button-edit-payroll-${entry.id}`}>\n                            <Edit className=\"h-4 w-4 mr-2\" />\n                            Edit\n                          </DropdownMenuItem>\n                          <DropdownMenuItem\n                            onClick={() => handleDelete(entry.id)}\n                            className=\"text-destructive\"\n                            data-testid={`button-delete-payroll-${entry.id}`}\n                          >\n                            <Trash2 className=\"h-4 w-4 mr-2\" />\n                            Delete\n                          </DropdownMenuItem>\n                        </DropdownMenuContent>\n                      </DropdownMenu>\n                    </TableCell>\n                  </TableRow>\n                ))}\n              </TableBody>\n            </Table>\n          )}\n        </CardContent>\n      </Card>\n\n      <PayrollDialog\n        open={dialogOpen}\n        onOpenChange={setDialogOpen}\n        payroll={selectedPayroll}\n      />\n    </div>\n  );\n}\n","size_bytes":10084},"client/src/components/ui/button.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\" +\n  \" hover-elevate active-elevate-2\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"bg-primary text-primary-foreground border border-primary-border\",\n        destructive:\n          \"bg-destructive text-destructive-foreground border border-destructive-border\",\n        outline:\n          // Shows the background color of whatever card / sidebar / accent background it is inside of.\n          // Inherits the current text color.\n          \" border [border-color:var(--button-outline)]  shadow-xs active:shadow-none \",\n        secondary: \"border bg-secondary text-secondary-foreground border border-secondary-border \",\n        // Add a transparent border so that when someone toggles a border on later, it doesn't shift layout/size.\n        ghost: \"border border-transparent\",\n      },\n      // Heights are set as \"min\" heights, because sometimes Ai will place large amount of content\n      // inside buttons. With a min-height they will look appropriate with small amounts of content,\n      // but will expand to fit large amounts of content.\n      size: {\n        default: \"min-h-9 px-4 py-2\",\n        sm: \"min-h-8 rounded-md px-3 text-xs\",\n        lg: \"min-h-10 rounded-md px-8\",\n        icon: \"h-9 w-9\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  },\n)\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"button\"\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size, className }))}\n        ref={ref}\n        {...props}\n      />\n    )\n  },\n)\nButton.displayName = \"Button\"\n\nexport { Button, buttonVariants }\n","size_bytes":2359},"server/routes.ts":{"content":"import type { Express, Request } from \"express\";\nimport { createServer, type Server } from \"http\";\nimport { storage } from \"./storage\";\nimport { setupAuth, isAuthenticated } from \"./auth\";\nimport {\n  insertStaffSchema,\n  insertPayrollSchema,\n  insertMatchSchema,\n  insertCampaignSchema,\n  insertContractSchema,\n  insertTenantSchema,\n  insertInviteSchema,\n  insertSocialAccountSchema,\n  insertTransactionSchema,\n  insertTournamentSchema,\n  insertTournamentRoundSchema,\n} from \"@shared/schema\";\nimport { randomBytes } from \"crypto\";\nimport Stripe from \"stripe\";\nimport bcrypt from \"bcrypt\";\nimport { getOAuthConfig, isOAuthConfigured, OAUTH_PLATFORMS } from \"./oauth-config\";\n\n// Initialize Stripe with testing keys (production keys can be added later)\nconst stripeKey = process.env.TESTING_STRIPE_SECRET_KEY || process.env.STRIPE_SECRET_KEY;\nif (!stripeKey) {\n  throw new Error(\"Missing Stripe secret key (TESTING_STRIPE_SECRET_KEY or STRIPE_SECRET_KEY)\");\n}\nconst stripe = new Stripe(stripeKey, {\n  apiVersion: \"2025-09-30.clover\",\n});\n\n// Helper to get tenant ID from authenticated user\nasync function getTenantId(req: any): Promise<string> {\n  const userId = req.user.claims.sub;\n  const user = await storage.getUser(userId);\n  if (!user || !user.tenantId) {\n    throw new Error(\"User tenant not found\");\n  }\n  return user.tenantId;\n}\n\n// Helper to check if user is super admin\nasync function isSuperAdmin(req: any): Promise<boolean> {\n  const userId = req.user.claims.sub;\n  const user = await storage.getUser(userId);\n  return user?.isSuperAdmin || false;\n}\n\n// Middleware to require super admin\nasync function requireSuperAdmin(req: any, res: any, next: any) {\n  try {\n    const superAdmin = await isSuperAdmin(req);\n    if (!superAdmin) {\n      return res.status(403).json({ message: \"Super admin access required\" });\n    }\n    next();\n  } catch (error) {\n    res.status(500).json({ message: \"Authorization check failed\" });\n  }\n}\n\n// Middleware to check if tenant is suspended\nasync function checkTenantSuspension(req: any, res: any, next: any) {\n  try {\n    // Skip check for super admins\n    const superAdmin = await isSuperAdmin(req);\n    if (superAdmin) {\n      return next();\n    }\n\n    const userId = req.user.claims.sub;\n    const user = await storage.getUser(userId);\n    \n    if (!user || !user.tenantId) {\n      return next();\n    }\n\n    const tenant = await storage.getTenant(user.tenantId);\n    \n    if (tenant && tenant.subscriptionStatus === \"suspended\") {\n      return res.status(403).json({\n        message: \"Your account has been suspended\",\n        reason: tenant.suspensionReason || \"Please contact support for more information\",\n        suspendedAt: tenant.suspendedAt,\n      });\n    }\n\n    next();\n  } catch (error) {\n    console.error(\"Error checking tenant suspension:\", error);\n    next();\n  }\n}\n\n// Helper to create audit log\nasync function createAuditLog(\n  tenantId: string,\n  userId: string,\n  userName: string,\n  action: string,\n  entity: string,\n  entityId?: string,\n  oldValue?: any,\n  newValue?: any,\n  actionType: \"create\" | \"update\" | \"delete\" = \"update\"\n) {\n  await storage.createAuditLog({\n    tenantId,\n    userId,\n    userName,\n    action,\n    entity,\n    entityId,\n    oldValue: oldValue ? JSON.stringify(oldValue) : null,\n    newValue: newValue ? JSON.stringify(newValue) : null,\n    actionType,\n  });\n}\n\nexport async function registerRoutes(app: Express): Promise<Server> {\n  // Auth middleware\n  await setupAuth(app);\n\n  // Custom Authentication Routes\n  app.post(\"/api/auth/login\", async (req, res) => {\n    try {\n      const { email, password } = req.body;\n\n      if (!email || !password) {\n        return res.status(400).json({ message: \"Email and password are required\" });\n      }\n\n      const user = await storage.getUserByEmail(email);\n      \n      if (!user || !user.password) {\n        return res.status(401).json({ message: \"Invalid email or password\" });\n      }\n\n      const passwordMatch = await bcrypt.compare(password, user.password);\n      \n      if (!passwordMatch) {\n        return res.status(401).json({ message: \"Invalid email or password\" });\n      }\n\n      // Regenerate session to prevent fixation attacks\n      await new Promise((resolve, reject) => {\n        (req as any).session.regenerate((err: any) => {\n          if (err) reject(err);\n          else resolve(true);\n        });\n      });\n\n      // Set session data compatible with existing middleware (req.user.claims.sub)\n      (req as any).session.passport = { \n        user: { \n          claims: { sub: user.id }\n        }\n      };\n      \n      await new Promise((resolve, reject) => {\n        (req as any).session.save((err: any) => {\n          if (err) reject(err);\n          else resolve(true);\n        });\n      });\n\n      res.json({ \n        user: {\n          id: user.id,\n          email: user.email,\n          firstName: user.firstName,\n          lastName: user.lastName,\n          tenantId: user.tenantId,\n          role: user.role,\n          isSuperAdmin: user.isSuperAdmin,\n          isTemporaryPassword: user.isTemporaryPassword,\n        }\n      });\n    } catch (error) {\n      console.error(\"Login error:\", error);\n      res.status(500).json({ message: \"Login failed\" });\n    }\n  });\n\n  app.post(\"/api/auth/register\", async (req, res) => {\n    try {\n      const { email, password, firstName, lastName, tenantName } = req.body;\n\n      if (!email || !password) {\n        return res.status(400).json({ message: \"Email and password are required\" });\n      }\n\n      const existingUser = await storage.getUserByEmail(email);\n      if (existingUser) {\n        return res.status(400).json({ message: \"Email already exists\" });\n      }\n\n      const hashedPassword = await bcrypt.hash(password, 10);\n\n      let tenant;\n      let user;\n\n      try {\n        // Create tenant for new user\n        tenant = await storage.createTenant({\n          name: tenantName || `${firstName || email}'s Club`,\n          subscriptionPlan: \"starter\",\n          subscriptionStatus: \"trial\",\n          trialEndsAt: new Date(Date.now() + 14 * 24 * 60 * 60 * 1000), // 14 days trial\n        });\n\n        // Create user\n        user = await storage.createUser({\n          email,\n          password: hashedPassword,\n          firstName,\n          lastName,\n          tenantId: tenant.id,\n          role: \"owner\",\n          isTemporaryPassword: false,\n          lastPasswordChange: new Date(),\n        });\n      } catch (error) {\n        // Cleanup tenant if user creation failed\n        if (tenant) {\n          try {\n            await storage.deleteTenant(tenant.id);\n          } catch (cleanupError) {\n            console.error(\"Failed to cleanup tenant after registration error:\", cleanupError);\n          }\n        }\n        throw error;\n      }\n\n      // Regenerate session to prevent fixation attacks\n      await new Promise((resolve, reject) => {\n        (req as any).session.regenerate((err: any) => {\n          if (err) reject(err);\n          else resolve(true);\n        });\n      });\n\n      // Set session data compatible with existing middleware\n      (req as any).session.passport = { \n        user: { \n          claims: { sub: user.id }\n        }\n      };\n      \n      await new Promise((resolve, reject) => {\n        (req as any).session.save((err: any) => {\n          if (err) reject(err);\n          else resolve(true);\n        });\n      });\n\n      res.json({ \n        user: {\n          id: user.id,\n          email: user.email,\n          firstName: user.firstName,\n          lastName: user.lastName,\n          tenantId: user.tenantId,\n          role: user.role,\n          isSuperAdmin: user.isSuperAdmin,\n        }\n      });\n    } catch (error) {\n      console.error(\"Registration error:\", error);\n      res.status(500).json({ message: \"Registration failed\" });\n    }\n  });\n\n  app.post(\"/api/auth/logout\", (req, res) => {\n    req.session.destroy((err) => {\n      if (err) {\n        console.error(\"Logout error:\", err);\n        return res.status(500).json({ message: \"Logout failed\" });\n      }\n      res.clearCookie(\"connect.sid\");\n      res.json({ message: \"Logged out successfully\" });\n    });\n  });\n\n  app.post(\"/api/auth/change-password\", isAuthenticated, checkTenantSuspension, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const { currentPassword, newPassword } = req.body;\n\n      if (!currentPassword || !newPassword) {\n        return res.status(400).json({ message: \"Current and new passwords are required\" });\n      }\n\n      const user = await storage.getUser(userId);\n      \n      if (!user || !user.password) {\n        return res.status(400).json({ message: \"User not found\" });\n      }\n\n      const passwordMatch = await bcrypt.compare(currentPassword, user.password);\n      \n      if (!passwordMatch) {\n        return res.status(401).json({ message: \"Current password is incorrect\" });\n      }\n\n      const hashedPassword = await bcrypt.hash(newPassword, 10);\n      \n      await storage.updateUser(userId, {\n        password: hashedPassword,\n        isTemporaryPassword: false,\n        lastPasswordChange: new Date(),\n      });\n\n      res.json({ message: \"Password changed successfully\" });\n    } catch (error) {\n      console.error(\"Change password error:\", error);\n      res.status(500).json({ message: \"Failed to change password\" });\n    }\n  });\n\n  // Auth routes\n  app.get(\"/api/auth/user\", isAuthenticated, checkTenantSuspension, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      res.json(user);\n    } catch (error) {\n      console.error(\"Error fetching user:\", error);\n      res.status(500).json({ message: \"Failed to fetch user\" });\n    }\n  });\n\n  // Tenant routes\n  app.get(\"/api/tenant\", isAuthenticated, checkTenantSuspension, async (req: any, res) => {\n    try {\n      const tenantId = await getTenantId(req);\n      const tenant = await storage.getTenant(tenantId);\n      res.json(tenant);\n    } catch (error) {\n      console.error(\"Error fetching tenant:\", error);\n      res.status(500).json({ message: \"Failed to fetch tenant\" });\n    }\n  });\n\n  app.patch(\"/api/tenant\", isAuthenticated, checkTenantSuspension, async (req: any, res) => {\n    try {\n      const tenantId = await getTenantId(req);\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      \n      const validatedData = insertTenantSchema.partial().parse(req.body);\n      const oldTenant = await storage.getTenant(tenantId);\n      const updatedTenant = await storage.updateTenant(tenantId, validatedData);\n      \n      await createAuditLog(\n        tenantId,\n        userId,\n        `${user?.firstName || ''} ${user?.lastName || ''}`.trim() || user?.email || 'Unknown',\n        \"Updated club settings\",\n        \"tenant\",\n        tenantId,\n        oldTenant,\n        updatedTenant,\n        \"update\"\n      );\n      \n      res.json(updatedTenant);\n    } catch (error) {\n      console.error(\"Error updating tenant:\", error);\n      res.status(500).json({ message: \"Failed to update tenant\" });\n    }\n  });\n\n  // Staff routes\n  app.get(\"/api/staff\", isAuthenticated, checkTenantSuspension, async (req: any, res) => {\n    try {\n      const tenantId = await getTenantId(req);\n      const staffList = await storage.getStaffByTenant(tenantId);\n      res.json(staffList);\n    } catch (error) {\n      console.error(\"Error fetching staff:\", error);\n      res.status(500).json({ message: \"Failed to fetch staff\" });\n    }\n  });\n\n  app.post(\"/api/staff\", isAuthenticated, checkTenantSuspension, async (req: any, res) => {\n    try {\n      const tenantId = await getTenantId(req);\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      \n      // Check subscription plan limits\n      const tenant = await storage.getTenant(tenantId);\n      if (!tenant) {\n        return res.status(404).json({ message: \"Tenant not found\" });\n      }\n      \n      const currentStaffCount = await storage.getStaffByTenant(tenantId);\n      const staffCount = currentStaffCount.length;\n      \n      // Define plan limits\n      const planLimits: Record<string, number> = {\n        starter: 10,\n        growth: 50,\n        enterprise: Infinity, // Unlimited\n      };\n      \n      const currentPlan = tenant.subscriptionPlan || 'starter';\n      const limit = planLimits[currentPlan] || 10;\n      \n      if (staffCount >= limit) {\n        return res.status(403).json({ \n          message: `Staff limit reached for ${currentPlan} plan. Upgrade to add more staff members.`,\n          limit,\n          current: staffCount\n        });\n      }\n      \n      const validatedData = insertStaffSchema.parse({ ...req.body, tenantId });\n      const newStaff = await storage.createStaff(validatedData);\n      \n      await createAuditLog(\n        tenantId,\n        userId,\n        `${user?.firstName || ''} ${user?.lastName || ''}`.trim() || user?.email || 'Unknown',\n        `Added staff member ${newStaff.name}`,\n        \"staff\",\n        newStaff.id,\n        undefined,\n        newStaff,\n        \"create\"\n      );\n      \n      res.json(newStaff);\n    } catch (error) {\n      console.error(\"Error creating staff:\", error);\n      res.status(500).json({ message: \"Failed to create staff\" });\n    }\n  });\n\n  app.patch(\"/api/staff/:id\", isAuthenticated, checkTenantSuspension, async (req: any, res) => {\n    try {\n      const tenantId = await getTenantId(req);\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      \n      const oldStaff = await storage.getStaff(req.params.id, tenantId);\n      if (!oldStaff) {\n        return res.status(404).json({ message: \"Staff member not found\" });\n      }\n      \n      const validatedData = insertStaffSchema.partial().parse(req.body);\n      const updatedStaff = await storage.updateStaff(req.params.id, tenantId, validatedData);\n      \n      await createAuditLog(\n        tenantId,\n        userId,\n        `${user?.firstName || ''} ${user?.lastName || ''}`.trim() || user?.email || 'Unknown',\n        `Updated staff member ${updatedStaff.name}`,\n        \"staff\",\n        updatedStaff.id,\n        oldStaff,\n        updatedStaff,\n        \"update\"\n      );\n      \n      res.json(updatedStaff);\n    } catch (error) {\n      console.error(\"Error updating staff:\", error);\n      res.status(500).json({ message: \"Failed to update staff\" });\n    }\n  });\n\n  app.delete(\"/api/staff/:id\", isAuthenticated, checkTenantSuspension, async (req: any, res) => {\n    try {\n      const tenantId = await getTenantId(req);\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      \n      const staff = await storage.getStaff(req.params.id, tenantId);\n      if (!staff) {\n        return res.status(404).json({ message: \"Staff member not found\" });\n      }\n      \n      await storage.deleteStaff(req.params.id, tenantId);\n      \n      await createAuditLog(\n        tenantId,\n        userId,\n        `${user?.firstName || ''} ${user?.lastName || ''}`.trim() || user?.email || 'Unknown',\n        `Removed staff member ${staff?.name || 'Unknown'}`,\n        \"staff\",\n        req.params.id,\n        staff,\n        undefined,\n        \"delete\"\n      );\n      \n      res.json({ success: true });\n    } catch (error) {\n      console.error(\"Error deleting staff:\", error);\n      res.status(500).json({ message: \"Failed to delete staff\" });\n    }\n  });\n\n  // Payroll routes\n  app.get(\"/api/payroll\", isAuthenticated, checkTenantSuspension, async (req: any, res) => {\n    try {\n      const tenantId = await getTenantId(req);\n      const payrollList = await storage.getPayrollByTenant(tenantId);\n      res.json(payrollList);\n    } catch (error) {\n      console.error(\"Error fetching payroll:\", error);\n      res.status(500).json({ message: \"Failed to fetch payroll\" });\n    }\n  });\n\n  app.post(\"/api/payroll\", isAuthenticated, checkTenantSuspension, async (req: any, res) => {\n    try {\n      const tenantId = await getTenantId(req);\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      \n      const validatedData = insertPayrollSchema.parse({ ...req.body, tenantId });\n      const newPayroll = await storage.createPayroll(validatedData);\n      \n      await createAuditLog(\n        tenantId,\n        userId,\n        `${user?.firstName || ''} ${user?.lastName || ''}`.trim() || user?.email || 'Unknown',\n        `Added payroll entry for ${newPayroll.name}`,\n        \"payroll\",\n        newPayroll.id,\n        undefined,\n        newPayroll,\n        \"create\"\n      );\n      \n      res.json(newPayroll);\n    } catch (error) {\n      console.error(\"Error creating payroll:\", error);\n      res.status(500).json({ message: \"Failed to create payroll\" });\n    }\n  });\n\n  app.patch(\"/api/payroll/:id\", isAuthenticated, checkTenantSuspension, async (req: any, res) => {\n    try {\n      const tenantId = await getTenantId(req);\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      \n      const oldPayroll = await storage.getPayroll(req.params.id, tenantId);\n      if (!oldPayroll) {\n        return res.status(404).json({ message: \"Payroll entry not found\" });\n      }\n      \n      const validatedData = insertPayrollSchema.partial().parse(req.body);\n      const updatedPayroll = await storage.updatePayroll(req.params.id, tenantId, validatedData);\n      \n      await createAuditLog(\n        tenantId,\n        userId,\n        `${user?.firstName || ''} ${user?.lastName || ''}`.trim() || user?.email || 'Unknown',\n        `Updated payroll for ${updatedPayroll.name}`,\n        \"payroll\",\n        updatedPayroll.id,\n        oldPayroll,\n        updatedPayroll,\n        \"update\"\n      );\n      \n      res.json(updatedPayroll);\n    } catch (error) {\n      console.error(\"Error updating payroll:\", error);\n      res.status(500).json({ message: \"Failed to update payroll\" });\n    }\n  });\n\n  app.delete(\"/api/payroll/:id\", isAuthenticated, checkTenantSuspension, async (req: any, res) => {\n    try {\n      const tenantId = await getTenantId(req);\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      \n      const payroll = await storage.getPayroll(req.params.id, tenantId);\n      if (!payroll) {\n        return res.status(404).json({ message: \"Payroll entry not found\" });\n      }\n      \n      await storage.deletePayroll(req.params.id, tenantId);\n      \n      await createAuditLog(\n        tenantId,\n        userId,\n        `${user?.firstName || ''} ${user?.lastName || ''}`.trim() || user?.email || 'Unknown',\n        `Deleted payroll for ${payroll.name}`,\n        \"payroll\",\n        req.params.id,\n        payroll,\n        undefined,\n        \"delete\"\n      );\n      \n      res.json({ success: true });\n    } catch (error) {\n      console.error(\"Error deleting payroll:\", error);\n      res.status(500).json({ message: \"Failed to delete payroll\" });\n    }\n  });\n\n  // ==================== Tournament Routes ====================\n  \n  // Get all tournaments for tenant\n  app.get(\"/api/tournaments\", isAuthenticated, checkTenantSuspension, async (req: any, res) => {\n    try {\n      const tenantId = await getTenantId(req);\n      const tournamentList = await storage.getTournamentsByTenant(tenantId);\n      res.json(tournamentList);\n    } catch (error) {\n      console.error(\"Error fetching tournaments:\", error);\n      res.status(500).json({ message: \"Failed to fetch tournaments\" });\n    }\n  });\n\n  // Get single tournament\n  app.get(\"/api/tournaments/:id\", isAuthenticated, checkTenantSuspension, async (req: any, res) => {\n    try {\n      const tenantId = await getTenantId(req);\n      const tournament = await storage.getTournament(req.params.id, tenantId);\n      if (!tournament) {\n        return res.status(404).json({ message: \"Tournament not found\" });\n      }\n      res.json(tournament);\n    } catch (error) {\n      console.error(\"Error fetching tournament:\", error);\n      res.status(500).json({ message: \"Failed to fetch tournament\" });\n    }\n  });\n\n  // Create tournament\n  app.post(\"/api/tournaments\", isAuthenticated, checkTenantSuspension, async (req: any, res) => {\n    try {\n      const tenantId = await getTenantId(req);\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      \n      const validatedData = insertTournamentSchema.parse({ ...req.body, tenantId });\n      const newTournament = await storage.createTournament(validatedData);\n      \n      await createAuditLog(\n        tenantId,\n        userId,\n        `${user?.firstName || ''} ${user?.lastName || ''}`.trim() || user?.email || 'Unknown',\n        `Created tournament: ${newTournament.name}`,\n        \"tournament\",\n        newTournament.id,\n        undefined,\n        newTournament,\n        \"create\"\n      );\n      \n      res.json(newTournament);\n    } catch (error) {\n      console.error(\"Error creating tournament:\", error);\n      res.status(500).json({ message: \"Failed to create tournament\" });\n    }\n  });\n\n  // Update tournament\n  app.patch(\"/api/tournaments/:id\", isAuthenticated, checkTenantSuspension, async (req: any, res) => {\n    try {\n      const tenantId = await getTenantId(req);\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      \n      const oldTournament = await storage.getTournament(req.params.id, tenantId);\n      if (!oldTournament) {\n        return res.status(404).json({ message: \"Tournament not found\" });\n      }\n      \n      const validatedData = insertTournamentSchema.partial().parse(req.body);\n      const updatedTournament = await storage.updateTournament(req.params.id, tenantId, validatedData);\n      \n      await createAuditLog(\n        tenantId,\n        userId,\n        `${user?.firstName || ''} ${user?.lastName || ''}`.trim() || user?.email || 'Unknown',\n        `Updated tournament: ${updatedTournament.name}`,\n        \"tournament\",\n        updatedTournament.id,\n        oldTournament,\n        updatedTournament,\n        \"update\"\n      );\n      \n      res.json(updatedTournament);\n    } catch (error) {\n      console.error(\"Error updating tournament:\", error);\n      res.status(500).json({ message: \"Failed to update tournament\" });\n    }\n  });\n\n  // Delete tournament\n  app.delete(\"/api/tournaments/:id\", isAuthenticated, checkTenantSuspension, async (req: any, res) => {\n    try {\n      const tenantId = await getTenantId(req);\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      \n      const tournament = await storage.getTournament(req.params.id, tenantId);\n      if (!tournament) {\n        return res.status(404).json({ message: \"Tournament not found\" });\n      }\n      \n      await storage.deleteTournament(req.params.id, tenantId);\n      \n      await createAuditLog(\n        tenantId,\n        userId,\n        `${user?.firstName || ''} ${user?.lastName || ''}`.trim() || user?.email || 'Unknown',\n        `Deleted tournament: ${tournament.name}`,\n        \"tournament\",\n        req.params.id,\n        tournament,\n        undefined,\n        \"delete\"\n      );\n      \n      res.json({ success: true });\n    } catch (error) {\n      console.error(\"Error deleting tournament:\", error);\n      res.status(500).json({ message: \"Failed to delete tournament\" });\n    }\n  });\n\n  // ==================== Tournament Round Routes ====================\n  \n  // Get rounds for a tournament\n  app.get(\"/api/tournaments/:tournamentId/rounds\", isAuthenticated, checkTenantSuspension, async (req: any, res) => {\n    try {\n      const rounds = await storage.getRoundsByTournament(req.params.tournamentId);\n      res.json(rounds);\n    } catch (error) {\n      console.error(\"Error fetching rounds:\", error);\n      res.status(500).json({ message: \"Failed to fetch rounds\" });\n    }\n  });\n\n  // Create round\n  app.post(\"/api/tournaments/:tournamentId/rounds\", isAuthenticated, checkTenantSuspension, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      const tenantId = await getTenantId(req);\n      \n      const validatedData = insertTournamentRoundSchema.parse({ \n        ...req.body, \n        tournamentId: req.params.tournamentId \n      });\n      const newRound = await storage.createRound(validatedData);\n      \n      await createAuditLog(\n        tenantId,\n        userId,\n        `${user?.firstName || ''} ${user?.lastName || ''}`.trim() || user?.email || 'Unknown',\n        `Created tournament round: ${newRound.name}`,\n        \"tournament_round\",\n        newRound.id,\n        undefined,\n        newRound,\n        \"create\"\n      );\n      \n      res.json(newRound);\n    } catch (error) {\n      console.error(\"Error creating round:\", error);\n      res.status(500).json({ message: \"Failed to create round\" });\n    }\n  });\n\n  // Update round\n  app.patch(\"/api/rounds/:id\", isAuthenticated, checkTenantSuspension, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      const tenantId = await getTenantId(req);\n      \n      const { tournamentId } = req.body;\n      if (!tournamentId) {\n        return res.status(400).json({ message: \"Tournament ID is required\" });\n      }\n      \n      const oldRound = await storage.getRound(req.params.id, tournamentId);\n      if (!oldRound) {\n        return res.status(404).json({ message: \"Round not found\" });\n      }\n      \n      const validatedData = insertTournamentRoundSchema.partial().parse(req.body);\n      const updatedRound = await storage.updateRound(req.params.id, tournamentId, validatedData);\n      \n      await createAuditLog(\n        tenantId,\n        userId,\n        `${user?.firstName || ''} ${user?.lastName || ''}`.trim() || user?.email || 'Unknown',\n        `Updated tournament round: ${updatedRound.name}`,\n        \"tournament_round\",\n        updatedRound.id,\n        oldRound,\n        updatedRound,\n        \"update\"\n      );\n      \n      res.json(updatedRound);\n    } catch (error) {\n      console.error(\"Error updating round:\", error);\n      res.status(500).json({ message: \"Failed to update round\" });\n    }\n  });\n\n  // Delete round\n  app.delete(\"/api/rounds/:id\", isAuthenticated, checkTenantSuspension, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      const tenantId = await getTenantId(req);\n      \n      const { tournamentId } = req.query;\n      if (!tournamentId || typeof tournamentId !== 'string') {\n        return res.status(400).json({ message: \"Tournament ID is required\" });\n      }\n      \n      const round = await storage.getRound(req.params.id, tournamentId);\n      if (!round) {\n        return res.status(404).json({ message: \"Round not found\" });\n      }\n      \n      await storage.deleteRound(req.params.id, tournamentId);\n      \n      await createAuditLog(\n        tenantId,\n        userId,\n        `${user?.firstName || ''} ${user?.lastName || ''}`.trim() || user?.email || 'Unknown',\n        `Deleted tournament round: ${round.name}`,\n        \"tournament_round\",\n        req.params.id,\n        round,\n        undefined,\n        \"delete\"\n      );\n      \n      res.json({ success: true });\n    } catch (error) {\n      console.error(\"Error deleting round:\", error);\n      res.status(500).json({ message: \"Failed to delete round\" });\n    }\n  });\n\n  // ==================== Match Routes ====================\n  \n  // Match routes\n  app.get(\"/api/matches\", isAuthenticated, checkTenantSuspension, async (req: any, res) => {\n    try {\n      const tenantId = await getTenantId(req);\n      const matchList = await storage.getMatchesByTenant(tenantId);\n      res.json(matchList);\n    } catch (error) {\n      console.error(\"Error fetching matches:\", error);\n      res.status(500).json({ message: \"Failed to fetch matches\" });\n    }\n  });\n\n  app.post(\"/api/matches\", isAuthenticated, checkTenantSuspension, async (req: any, res) => {\n    try {\n      const tenantId = await getTenantId(req);\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      \n      const validatedData = insertMatchSchema.parse({ ...req.body, tenantId });\n      const newMatch = await storage.createMatch(validatedData);\n      \n      await createAuditLog(\n        tenantId,\n        userId,\n        `${user?.firstName || ''} ${user?.lastName || ''}`.trim() || user?.email || 'Unknown',\n        `Scheduled match ${newMatch.teamA} vs ${newMatch.teamB}`,\n        \"match\",\n        newMatch.id,\n        undefined,\n        newMatch,\n        \"create\"\n      );\n      \n      res.json(newMatch);\n    } catch (error) {\n      console.error(\"Error creating match:\", error);\n      res.status(500).json({ message: \"Failed to create match\" });\n    }\n  });\n\n  app.patch(\"/api/matches/:id\", isAuthenticated, checkTenantSuspension, async (req: any, res) => {\n    try {\n      const tenantId = await getTenantId(req);\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      \n      const oldMatch = await storage.getMatch(req.params.id, tenantId);\n      if (!oldMatch) {\n        return res.status(404).json({ message: \"Match not found\" });\n      }\n      \n      const validatedData = insertMatchSchema.partial().parse(req.body);\n      const updatedMatch = await storage.updateMatch(req.params.id, tenantId, validatedData);\n      \n      await createAuditLog(\n        tenantId,\n        userId,\n        `${user?.firstName || ''} ${user?.lastName || ''}`.trim() || user?.email || 'Unknown',\n        `Updated match ${updatedMatch.teamA} vs ${updatedMatch.teamB}`,\n        \"match\",\n        updatedMatch.id,\n        oldMatch,\n        updatedMatch,\n        \"update\"\n      );\n      \n      res.json(updatedMatch);\n    } catch (error) {\n      console.error(\"Error updating match:\", error);\n      res.status(500).json({ message: \"Failed to update match\" });\n    }\n  });\n\n  app.delete(\"/api/matches/:id\", isAuthenticated, checkTenantSuspension, async (req: any, res) => {\n    try {\n      const tenantId = await getTenantId(req);\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      \n      const match = await storage.getMatch(req.params.id, tenantId);\n      if (!match) {\n        return res.status(404).json({ message: \"Match not found\" });\n      }\n      \n      await storage.deleteMatch(req.params.id, tenantId);\n      \n      await createAuditLog(\n        tenantId,\n        userId,\n        `${user?.firstName || ''} ${user?.lastName || ''}`.trim() || user?.email || 'Unknown',\n        `Deleted match ${match?.teamA || 'Unknown'} vs ${match?.teamB || 'Unknown'}`,\n        \"match\",\n        req.params.id,\n        match,\n        undefined,\n        \"delete\"\n      );\n      \n      res.json({ success: true });\n    } catch (error) {\n      console.error(\"Error deleting match:\", error);\n      res.status(500).json({ message: \"Failed to delete match\" });\n    }\n  });\n\n  // Campaign routes\n  app.get(\"/api/campaigns\", isAuthenticated, checkTenantSuspension, async (req: any, res) => {\n    try {\n      const tenantId = await getTenantId(req);\n      const campaignList = await storage.getCampaignsByTenant(tenantId);\n      res.json(campaignList);\n    } catch (error) {\n      console.error(\"Error fetching campaigns:\", error);\n      res.status(500).json({ message: \"Failed to fetch campaigns\" });\n    }\n  });\n\n  app.post(\"/api/campaigns\", isAuthenticated, checkTenantSuspension, async (req: any, res) => {\n    try {\n      const tenantId = await getTenantId(req);\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      \n      const validatedData = insertCampaignSchema.parse({ ...req.body, tenantId });\n      const newCampaign = await storage.createCampaign(validatedData);\n      \n      await createAuditLog(\n        tenantId,\n        userId,\n        `${user?.firstName || ''} ${user?.lastName || ''}`.trim() || user?.email || 'Unknown',\n        `Created campaign ${newCampaign.title}`,\n        \"campaign\",\n        newCampaign.id,\n        undefined,\n        newCampaign,\n        \"create\"\n      );\n      \n      res.json(newCampaign);\n    } catch (error) {\n      console.error(\"Error creating campaign:\", error);\n      res.status(500).json({ message: \"Failed to create campaign\" });\n    }\n  });\n\n  app.patch(\"/api/campaigns/:id\", isAuthenticated, checkTenantSuspension, async (req: any, res) => {\n    try {\n      const tenantId = await getTenantId(req);\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      \n      const oldCampaign = await storage.getCampaign(req.params.id, tenantId);\n      if (!oldCampaign) {\n        return res.status(404).json({ message: \"Campaign not found\" });\n      }\n      \n      const validatedData = insertCampaignSchema.partial().parse(req.body);\n      const updatedCampaign = await storage.updateCampaign(req.params.id, tenantId, validatedData);\n      \n      await createAuditLog(\n        tenantId,\n        userId,\n        `${user?.firstName || ''} ${user?.lastName || ''}`.trim() || user?.email || 'Unknown',\n        `Updated campaign ${updatedCampaign.title}`,\n        \"campaign\",\n        updatedCampaign.id,\n        oldCampaign,\n        updatedCampaign,\n        \"update\"\n      );\n      \n      res.json(updatedCampaign);\n    } catch (error) {\n      console.error(\"Error updating campaign:\", error);\n      res.status(500).json({ message: \"Failed to update campaign\" });\n    }\n  });\n\n  app.delete(\"/api/campaigns/:id\", isAuthenticated, checkTenantSuspension, async (req: any, res) => {\n    try {\n      const tenantId = await getTenantId(req);\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      \n      const campaign = await storage.getCampaign(req.params.id, tenantId);\n      if (!campaign) {\n        return res.status(404).json({ message: \"Campaign not found\" });\n      }\n      \n      await storage.deleteCampaign(req.params.id, tenantId);\n      \n      await createAuditLog(\n        tenantId,\n        userId,\n        `${user?.firstName || ''} ${user?.lastName || ''}`.trim() || user?.email || 'Unknown',\n        `Deleted campaign ${campaign?.title || 'Unknown'}`,\n        \"campaign\",\n        req.params.id,\n        campaign,\n        undefined,\n        \"delete\"\n      );\n      \n      res.json({ success: true });\n    } catch (error) {\n      console.error(\"Error deleting campaign:\", error);\n      res.status(500).json({ message: \"Failed to delete campaign\" });\n    }\n  });\n\n  // Contract routes\n  app.get(\"/api/contracts\", isAuthenticated, checkTenantSuspension, async (req: any, res) => {\n    try {\n      const tenantId = await getTenantId(req);\n      const contractList = await storage.getContractsByTenant(tenantId);\n      res.json(contractList);\n    } catch (error) {\n      console.error(\"Error fetching contracts:\", error);\n      res.status(500).json({ message: \"Failed to fetch contracts\" });\n    }\n  });\n\n  app.post(\"/api/contracts\", isAuthenticated, checkTenantSuspension, async (req: any, res) => {\n    try {\n      const tenantId = await getTenantId(req);\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      \n      const validatedData = insertContractSchema.parse({ ...req.body, tenantId });\n      const newContract = await storage.createContract(validatedData);\n      \n      await createAuditLog(\n        tenantId,\n        userId,\n        `${user?.firstName || ''} ${user?.lastName || ''}`.trim() || user?.email || 'Unknown',\n        `Added contract ${newContract.fileName}`,\n        \"contract\",\n        newContract.id,\n        undefined,\n        newContract,\n        \"create\"\n      );\n      \n      res.json(newContract);\n    } catch (error) {\n      console.error(\"Error creating contract:\", error);\n      res.status(500).json({ message: \"Failed to create contract\" });\n    }\n  });\n\n  app.patch(\"/api/contracts/:id\", isAuthenticated, checkTenantSuspension, async (req: any, res) => {\n    try {\n      const tenantId = await getTenantId(req);\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      \n      const oldContract = await storage.getContract(req.params.id, tenantId);\n      if (!oldContract) {\n        return res.status(404).json({ message: \"Contract not found\" });\n      }\n      \n      const validatedData = insertContractSchema.partial().parse(req.body);\n      const updatedContract = await storage.updateContract(req.params.id, tenantId, validatedData);\n      \n      await createAuditLog(\n        tenantId,\n        userId,\n        `${user?.firstName || ''} ${user?.lastName || ''}`.trim() || user?.email || 'Unknown',\n        `Updated contract ${updatedContract.fileName}`,\n        \"contract\",\n        updatedContract.id,\n        oldContract,\n        updatedContract,\n        \"update\"\n      );\n      \n      res.json(updatedContract);\n    } catch (error) {\n      console.error(\"Error updating contract:\", error);\n      res.status(500).json({ message: \"Failed to update contract\" });\n    }\n  });\n\n  app.delete(\"/api/contracts/:id\", isAuthenticated, checkTenantSuspension, async (req: any, res) => {\n    try {\n      const tenantId = await getTenantId(req);\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      \n      const contract = await storage.getContract(req.params.id, tenantId);\n      if (!contract) {\n        return res.status(404).json({ message: \"Contract not found\" });\n      }\n      \n      await storage.deleteContract(req.params.id, tenantId);\n      \n      await createAuditLog(\n        tenantId,\n        userId,\n        `${user?.firstName || ''} ${user?.lastName || ''}`.trim() || user?.email || 'Unknown',\n        `Deleted contract ${contract?.fileName || 'Unknown'}`,\n        \"contract\",\n        req.params.id,\n        contract,\n        undefined,\n        \"delete\"\n      );\n      \n      res.json({ success: true });\n    } catch (error) {\n      console.error(\"Error deleting contract:\", error);\n      res.status(500).json({ message: \"Failed to delete contract\" });\n    }\n  });\n\n  // Audit log routes\n  app.get(\"/api/audit-logs\", isAuthenticated, checkTenantSuspension, async (req: any, res) => {\n    try {\n      const tenantId = await getTenantId(req);\n      const limit = req.query.limit ? parseInt(req.query.limit as string) : 100;\n      const auditLogs = await storage.getAuditLogsByTenant(tenantId, limit);\n      res.json(auditLogs);\n    } catch (error) {\n      console.error(\"Error fetching audit logs:\", error);\n      res.status(500).json({ message: \"Failed to fetch audit logs\" });\n    }\n  });\n\n  // Super Admin routes\n  app.get(\"/api/admin/clubs\", isAuthenticated, requireSuperAdmin, async (req: any, res) => {\n    try {\n      const clubs = await storage.getAllTenants();\n      res.json(clubs);\n    } catch (error) {\n      console.error(\"Error fetching clubs:\", error);\n      res.status(500).json({ message: \"Failed to fetch clubs\" });\n    }\n  });\n\n  app.post(\"/api/admin/clubs\", isAuthenticated, requireSuperAdmin, async (req: any, res) => {\n    try {\n      const validatedData = insertTenantSchema.parse(req.body);\n      const newClub = await storage.createTenant(validatedData);\n      res.json(newClub);\n    } catch (error) {\n      console.error(\"Error creating club:\", error);\n      res.status(500).json({ message: \"Failed to create club\" });\n    }\n  });\n\n  app.patch(\"/api/admin/clubs/:id\", isAuthenticated, requireSuperAdmin, async (req: any, res) => {\n    try {\n      const validatedData = insertTenantSchema.partial().parse(req.body);\n      const updatedClub = await storage.updateTenantAdmin(req.params.id, validatedData);\n      res.json(updatedClub);\n    } catch (error) {\n      console.error(\"Error updating club:\", error);\n      res.status(500).json({ message: \"Failed to update club\" });\n    }\n  });\n\n  app.delete(\"/api/admin/clubs/:id\", isAuthenticated, requireSuperAdmin, async (req: any, res) => {\n    try {\n      await storage.deleteTenant(req.params.id);\n      res.json({ success: true });\n    } catch (error) {\n      console.error(\"Error deleting club:\", error);\n      res.status(500).json({ message: \"Failed to delete club\" });\n    }\n  });\n\n  app.post(\"/api/admin/clubs/:id/suspend\", isAuthenticated, requireSuperAdmin, async (req: any, res) => {\n    try {\n      const { reason } = req.body;\n      const tenantId = req.params.id;\n      const userId = req.user.claims.sub;\n      \n      const tenant = await storage.getTenant(tenantId);\n      if (!tenant) {\n        return res.status(404).json({ message: \"Tenant not found\" });\n      }\n\n      const updatedTenant = await storage.updateTenantAdmin(tenantId, {\n        subscriptionStatus: \"suspended\",\n        suspendedAt: new Date(),\n        suspensionReason: reason || \"Suspended by administrator\",\n        suspendedBy: userId,\n      });\n\n      // Create audit log\n      const user = await storage.getUser(userId);\n      await createAuditLog(\n        tenantId,\n        userId,\n        `${user?.firstName || ''} ${user?.lastName || ''}`.trim() || user?.email || 'Super Admin',\n        `Suspended tenant: ${reason || 'No reason provided'}`,\n        \"tenant\",\n        tenantId,\n        { subscriptionStatus: tenant.subscriptionStatus },\n        { subscriptionStatus: \"suspended\", suspensionReason: reason },\n        \"update\"\n      );\n\n      res.json(updatedTenant);\n    } catch (error) {\n      console.error(\"Error suspending tenant:\", error);\n      res.status(500).json({ message: \"Failed to suspend tenant\" });\n    }\n  });\n\n  app.post(\"/api/admin/clubs/:id/reactivate\", isAuthenticated, requireSuperAdmin, async (req: any, res) => {\n    try {\n      const tenantId = req.params.id;\n      const userId = req.user.claims.sub;\n      \n      const tenant = await storage.getTenant(tenantId);\n      if (!tenant) {\n        return res.status(404).json({ message: \"Tenant not found\" });\n      }\n\n      const updatedTenant = await storage.updateTenantAdmin(tenantId, {\n        subscriptionStatus: \"active\",\n        suspendedAt: null,\n        suspensionReason: null,\n        suspendedBy: null,\n      });\n\n      // Create audit log\n      const user = await storage.getUser(userId);\n      await createAuditLog(\n        tenantId,\n        userId,\n        `${user?.firstName || ''} ${user?.lastName || ''}`.trim() || user?.email || 'Super Admin',\n        \"Reactivated suspended tenant\",\n        \"tenant\",\n        tenantId,\n        { subscriptionStatus: tenant.subscriptionStatus },\n        { subscriptionStatus: \"active\" },\n        \"update\"\n      );\n\n      res.json(updatedTenant);\n    } catch (error) {\n      console.error(\"Error reactivating tenant:\", error);\n      res.status(500).json({ message: \"Failed to reactivate tenant\" });\n    }\n  });\n\n  app.get(\"/api/admin/users\", isAuthenticated, requireSuperAdmin, async (req: any, res) => {\n    try {\n      const users = await storage.getAllUsers();\n      res.json(users);\n    } catch (error) {\n      console.error(\"Error fetching users:\", error);\n      res.status(500).json({ message: \"Failed to fetch users\" });\n    }\n  });\n\n  app.patch(\"/api/admin/users/:id\", isAuthenticated, requireSuperAdmin, async (req: any, res) => {\n    try {\n      const { isSuperAdmin, tenantId } = req.body;\n      const updatedUser = await storage.updateUserAdmin(req.params.id, { isSuperAdmin, tenantId });\n      res.json(updatedUser);\n    } catch (error) {\n      console.error(\"Error updating user:\", error);\n      res.status(500).json({ message: \"Failed to update user\" });\n    }\n  });\n\n  // Database export route (Super Admin only)\n  app.get(\"/api/admin/export-database\", isAuthenticated, requireSuperAdmin, async (req: any, res) => {\n    try {\n      // Export all database tables\n      const exportData = {\n        exportDate: new Date().toISOString(),\n        version: \"1.0\",\n        data: {\n          tenants: await storage.getAllTenants(),\n          users: await storage.getAllUsers(),\n          staff: await storage.getAllStaff(),\n          payroll: await storage.getAllPayroll(),\n          matches: await storage.getAllMatches(),\n          campaigns: await storage.getAllCampaigns(),\n          contracts: await storage.getAllContracts(),\n          auditLogs: await storage.getAllAuditLogs(10000),\n          invites: await storage.getAllInvites(),\n        }\n      };\n\n      // Set headers for file download\n      res.setHeader('Content-Type', 'application/json');\n      res.setHeader('Content-Disposition', `attachment; filename=\"nexus-database-export-${new Date().toISOString().split('T')[0]}.json\"`);\n      \n      res.json(exportData);\n    } catch (error) {\n      console.error(\"Error exporting database:\", error);\n      res.status(500).json({ message: \"Failed to export database\" });\n    }\n  });\n\n  // Invite routes\n  app.get(\"/api/invites\", isAuthenticated, checkTenantSuspension, async (req: any, res) => {\n    try {\n      const tenantId = await getTenantId(req);\n      const invitesList = await storage.getInvitesByTenant(tenantId);\n      res.json(invitesList);\n    } catch (error) {\n      console.error(\"Error fetching invites:\", error);\n      res.status(500).json({ message: \"Failed to fetch invites\" });\n    }\n  });\n\n  app.post(\"/api/invites\", isAuthenticated, checkTenantSuspension, async (req: any, res) => {\n    try {\n      const tenantId = await getTenantId(req);\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      \n      const token = randomBytes(32).toString('hex');\n      const expiresAt = new Date(Date.now() + 72 * 60 * 60 * 1000); // 72 hours\n      \n      const validatedData = insertInviteSchema.parse({\n        ...req.body,\n        tenantId,\n        token,\n        invitedBy: userId,\n        inviterName: `${user?.firstName || ''} ${user?.lastName || ''}`.trim() || user?.email || 'Unknown',\n        expiresAt,\n      });\n      \n      const newInvite = await storage.createInvite(validatedData);\n      res.json(newInvite);\n    } catch (error) {\n      console.error(\"Error creating invite:\", error);\n      res.status(500).json({ message: \"Failed to create invite\" });\n    }\n  });\n\n  app.get(\"/api/invites/verify/:token\", async (req: any, res) => {\n    try {\n      const invite = await storage.getInviteByToken(req.params.token);\n      \n      if (!invite) {\n        return res.status(404).json({ message: \"Invite not found\" });\n      }\n      \n      if (invite.status !== \"pending\") {\n        return res.status(400).json({ message: \"Invite already used or expired\" });\n      }\n      \n      if (new Date() > new Date(invite.expiresAt)) {\n        await storage.updateInviteStatus(req.params.token, \"expired\");\n        return res.status(400).json({ message: \"Invite has expired\" });\n      }\n      \n      res.json(invite);\n    } catch (error) {\n      console.error(\"Error verifying invite:\", error);\n      res.status(500).json({ message: \"Failed to verify invite\" });\n    }\n  });\n\n  app.post(\"/api/invites/accept/:token\", isAuthenticated, checkTenantSuspension, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const userEmail = req.user.claims.email;\n      const invite = await storage.getInviteByToken(req.params.token);\n      \n      if (!invite) {\n        return res.status(404).json({ message: \"Invite not found\" });\n      }\n      \n      // SECURITY: Verify the logged-in user's email matches the invite\n      if (invite.email.toLowerCase() !== userEmail?.toLowerCase()) {\n        return res.status(403).json({ message: \"This invite was sent to a different email address\" });\n      }\n      \n      if (invite.status !== \"pending\") {\n        return res.status(400).json({ message: \"Invite already used or expired\" });\n      }\n      \n      if (new Date() > new Date(invite.expiresAt)) {\n        await storage.updateInviteStatus(req.params.token, \"expired\");\n        return res.status(400).json({ message: \"Invite has expired\" });\n      }\n      \n      // Add user to tenant and create staff entry\n      await storage.updateUserAdmin(userId, { tenantId: invite.tenantId });\n      await storage.createStaff({\n        tenantId: invite.tenantId,\n        name: req.body.name || userEmail,\n        email: userEmail,\n        role: invite.role,\n        permissions: invite.permissions,\n      });\n      \n      await storage.updateInviteStatus(req.params.token, \"accepted\");\n      \n      await createAuditLog(\n        invite.tenantId,\n        userId,\n        userEmail || 'Unknown',\n        `Accepted invite and joined club`,\n        \"invite\",\n        invite.id,\n        undefined,\n        undefined,\n        \"create\"\n      );\n      \n      res.json({ success: true, tenantId: invite.tenantId });\n    } catch (error) {\n      console.error(\"Error accepting invite:\", error);\n      res.status(500).json({ message: \"Failed to accept invite\" });\n    }\n  });\n\n  app.delete(\"/api/invites/:id\", isAuthenticated, checkTenantSuspension, async (req: any, res) => {\n    try {\n      const tenantId = await getTenantId(req);\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      \n      // Verify invite exists and belongs to tenant before deleting\n      const invites = await storage.getInvitesByTenant(tenantId);\n      const invite = invites.find(inv => inv.id === req.params.id);\n      \n      if (!invite) {\n        return res.status(404).json({ message: \"Invite not found\" });\n      }\n      \n      await storage.deleteInvite(req.params.id, tenantId);\n      \n      await createAuditLog(\n        tenantId,\n        userId,\n        `${user?.firstName || ''} ${user?.lastName || ''}`.trim() || user?.email || 'Unknown',\n        `Deleted invite for ${invite.email}`,\n        \"invite\",\n        req.params.id,\n        invite,\n        undefined,\n        \"delete\"\n      );\n      \n      res.json({ success: true });\n    } catch (error) {\n      console.error(\"Error deleting invite:\", error);\n      res.status(500).json({ message: \"Failed to delete invite\" });\n    }\n  });\n\n  // ==================== Social Media Routes ====================\n  \n  // Get all connected social accounts\n  app.get(\"/api/social/accounts\", isAuthenticated, checkTenantSuspension, async (req: any, res) => {\n    try {\n      const tenantId = await getTenantId(req);\n      const accounts = await storage.getSocialAccountsByTenant(tenantId);\n      res.json(accounts);\n    } catch (error) {\n      console.error(\"Error fetching social accounts:\", error);\n      res.status(500).json({ message: \"Failed to fetch social accounts\" });\n    }\n  });\n\n  // Connect a new social account\n  app.post(\"/api/social/accounts\", isAuthenticated, checkTenantSuspension, async (req: any, res) => {\n    try {\n      const tenantId = await getTenantId(req);\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      \n      const validatedData = insertSocialAccountSchema.parse({\n        ...req.body,\n        tenantId,\n      });\n      \n      const newAccount = await storage.createSocialAccount(validatedData);\n      \n      await createAuditLog(\n        tenantId,\n        userId,\n        `${user?.firstName || ''} ${user?.lastName || ''}`.trim() || user?.email || 'Unknown',\n        `Connected ${req.body.platform} account: ${req.body.accountName}`,\n        \"socialAccount\",\n        newAccount.id,\n        undefined,\n        newAccount,\n        \"create\"\n      );\n      \n      res.json(newAccount);\n    } catch (error) {\n      console.error(\"Error creating social account:\", error);\n      res.status(500).json({ message: \"Failed to connect social account\" });\n    }\n  });\n\n  // Update social account\n  app.patch(\"/api/social/accounts/:id\", isAuthenticated, checkTenantSuspension, async (req: any, res) => {\n    try {\n      const tenantId = await getTenantId(req);\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      \n      const oldAccount = await storage.getSocialAccount(req.params.id, tenantId);\n      if (!oldAccount) {\n        return res.status(404).json({ message: \"Social account not found\" });\n      }\n      \n      const updatedAccount = await storage.updateSocialAccount(req.params.id, tenantId, req.body);\n      \n      await createAuditLog(\n        tenantId,\n        userId,\n        `${user?.firstName || ''} ${user?.lastName || ''}`.trim() || user?.email || 'Unknown',\n        `Updated ${updatedAccount.platform} account: ${updatedAccount.accountName}`,\n        \"socialAccount\",\n        req.params.id,\n        oldAccount,\n        updatedAccount,\n        \"update\"\n      );\n      \n      res.json(updatedAccount);\n    } catch (error) {\n      console.error(\"Error updating social account:\", error);\n      res.status(500).json({ message: \"Failed to update social account\" });\n    }\n  });\n\n  // Delete social account\n  app.delete(\"/api/social/accounts/:id\", isAuthenticated, checkTenantSuspension, async (req: any, res) => {\n    try {\n      const tenantId = await getTenantId(req);\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      \n      const account = await storage.getSocialAccount(req.params.id, tenantId);\n      if (!account) {\n        return res.status(404).json({ message: \"Social account not found\" });\n      }\n      \n      await storage.deleteSocialAccount(req.params.id, tenantId);\n      \n      await createAuditLog(\n        tenantId,\n        userId,\n        `${user?.firstName || ''} ${user?.lastName || ''}`.trim() || user?.email || 'Unknown',\n        `Disconnected ${account.platform} account: ${account.accountName}`,\n        \"socialAccount\",\n        req.params.id,\n        account,\n        undefined,\n        \"delete\"\n      );\n      \n      res.json({ success: true });\n    } catch (error) {\n      console.error(\"Error deleting social account:\", error);\n      res.status(500).json({ message: \"Failed to disconnect social account\" });\n    }\n  });\n\n  // Get social media analytics summary\n  app.get(\"/api/social/analytics\", isAuthenticated, checkTenantSuspension, async (req: any, res) => {\n    try {\n      const tenantId = await getTenantId(req);\n      const latestMetrics = await storage.getLatestMetricsByTenant(tenantId);\n      \n      // Aggregate metrics across all platforms\n      const summary = {\n        totalFollowers: latestMetrics.reduce((sum, m) => sum + (m.followers || 0), 0),\n        totalReach: latestMetrics.reduce((sum, m) => sum + (m.reach || 0), 0),\n        totalEngagement: latestMetrics.reduce((sum, m) => sum + Number(m.engagement || 0), 0),\n        avgEngagementRate: latestMetrics.length > 0 \n          ? latestMetrics.reduce((sum, m) => sum + Number(m.engagementRate || 0), 0) / latestMetrics.length \n          : 0,\n        platforms: latestMetrics.map(m => ({\n          platform: m.platform,\n          accountId: m.accountId,\n          followers: m.followers,\n          reach: m.reach,\n          engagement: m.engagement,\n          engagementRate: m.engagementRate,\n          posts: m.posts,\n          impressions: m.impressions,\n        })),\n      };\n      \n      res.json(summary);\n    } catch (error) {\n      console.error(\"Error fetching social analytics:\", error);\n      res.status(500).json({ message: \"Failed to fetch social analytics\" });\n    }\n  });\n\n  // Manual sync endpoint - fetch latest data from social platforms\n  app.post(\"/api/social/sync/:accountId\", isAuthenticated, checkTenantSuspension, async (req: any, res) => {\n    try {\n      const tenantId = await getTenantId(req);\n      const account = await storage.getSocialAccount(req.params.accountId, tenantId);\n      \n      if (!account) {\n        return res.status(404).json({ message: \"Social account not found\" });\n      }\n      \n      // TODO: Implement actual API calls to social platforms\n      // For now, create demo metrics\n      const demoMetric = await storage.createSocialMetric({\n        accountId: account.id,\n        tenantId,\n        platform: account.platform,\n        followers: Math.floor(Math.random() * 50000) + 10000,\n        following: Math.floor(Math.random() * 1000),\n        posts: Math.floor(Math.random() * 500) + 50,\n        reach: Math.floor(Math.random() * 100000) + 20000,\n        impressions: Math.floor(Math.random() * 200000) + 50000,\n        engagement: Math.floor(Math.random() * 5000) + 1000,\n        engagementRate: (Math.random() * 5).toFixed(2),\n        profileViews: Math.floor(Math.random() * 10000),\n        websiteClicks: Math.floor(Math.random() * 2000),\n        date: new Date(),\n      });\n      \n      await storage.updateSocialAccount(account.id, tenantId, {\n        lastSyncedAt: new Date(),\n      });\n      \n      res.json({ success: true, metric: demoMetric });\n    } catch (error) {\n      console.error(\"Error syncing social account:\", error);\n      res.status(500).json({ message: \"Failed to sync social account\" });\n    }\n  });\n\n  // ==================== OAuth Routes ====================\n  \n  // Check which OAuth platforms are configured\n  app.get(\"/api/oauth/status\", isAuthenticated, (req: any, res) => {\n    const status: Record<string, { configured: boolean; name: string; note?: string }> = {};\n    \n    Object.keys(OAUTH_PLATFORMS).forEach((platform) => {\n      const platformInfo = OAUTH_PLATFORMS[platform as keyof typeof OAUTH_PLATFORMS];\n      status[platform] = {\n        configured: isOAuthConfigured(platform),\n        name: platformInfo.name,\n        note: platformInfo.note,\n      };\n    });\n    \n    res.json(status);\n  });\n\n  // Initiate OAuth flow for a platform\n  app.get(\"/api/oauth/init/:platform\", isAuthenticated, async (req: any, res) => {\n    try {\n      const { platform } = req.params;\n      const config = getOAuthConfig(platform);\n      \n      if (!config) {\n        return res.status(400).json({ \n          message: `OAuth not configured for ${platform}. Please set ${platform.toUpperCase()}_CLIENT_ID and ${platform.toUpperCase()}_CLIENT_SECRET environment variables.` \n        });\n      }\n\n      const tenantId = await getTenantId(req);\n      const userId = req.user.claims.sub;\n      \n      // Generate state token for CSRF protection\n      const state = randomBytes(32).toString(\"hex\");\n      \n      // Store state in session for verification on callback\n      if (!req.session.oauthStates) {\n        req.session.oauthStates = {};\n      }\n      req.session.oauthStates[state] = {\n        platform,\n        tenantId,\n        userId,\n        timestamp: Date.now(),\n      };\n      \n      // Build authorization URL\n      const params = new URLSearchParams({\n        client_id: config.clientId,\n        redirect_uri: config.redirectUri,\n        response_type: \"code\",\n        scope: config.scope.join(\" \"),\n        state,\n      });\n      \n      const authUrl = `${config.authorizationUrl}?${params.toString()}`;\n      \n      res.json({ authUrl });\n    } catch (error) {\n      console.error(\"Error initiating OAuth:\", error);\n      res.status(500).json({ message: \"Failed to initiate OAuth flow\" });\n    }\n  });\n\n  // Handle OAuth callback from platform\n  app.get(\"/api/oauth/callback/:platform\", async (req: any, res) => {\n    try {\n      const { platform } = req.params;\n      const { code, state, error: oauthError } = req.query;\n      \n      // Check for OAuth errors from the platform\n      if (oauthError) {\n        return res.redirect(`/marcom?oauth_error=${encodeURIComponent(oauthError as string)}`);\n      }\n      \n      if (!code || !state) {\n        return res.redirect(\"/marcom?oauth_error=missing_parameters\");\n      }\n      \n      // Verify state token\n      const stateData = req.session?.oauthStates?.[state as string];\n      if (!stateData || stateData.platform !== platform) {\n        return res.redirect(\"/marcom?oauth_error=invalid_state\");\n      }\n      \n      // Check state is not expired (10 minutes)\n      if (Date.now() - stateData.timestamp > 10 * 60 * 1000) {\n        // Clean up expired state\n        delete req.session.oauthStates[state as string];\n        return res.redirect(\"/marcom?oauth_error=state_expired\");\n      }\n      \n      const config = getOAuthConfig(platform);\n      if (!config) {\n        delete req.session.oauthStates[state as string];\n        return res.redirect(\"/marcom?oauth_error=platform_not_configured\");\n      }\n      \n      // Exchange code for access token\n      let tokenResponse;\n      try {\n        tokenResponse = await fetch(config.tokenUrl, {\n          method: \"POST\",\n          headers: {\n            \"Content-Type\": \"application/x-www-form-urlencoded\",\n            Authorization: `Basic ${Buffer.from(`${config.clientId}:${config.clientSecret}`).toString(\"base64\")}`,\n          },\n          body: new URLSearchParams({\n            grant_type: \"authorization_code\",\n            code: code as string,\n            redirect_uri: config.redirectUri,\n          }).toString(),\n        });\n      } catch (fetchError) {\n        console.error(\"Token exchange network error:\", fetchError);\n        delete req.session.oauthStates[state as string];\n        return res.redirect(\"/marcom?oauth_error=network_error\");\n      }\n      \n      if (!tokenResponse.ok) {\n        const errorText = await tokenResponse.text();\n        console.error(\"Token exchange failed:\", errorText);\n        delete req.session.oauthStates[state as string];\n        return res.redirect(\"/marcom?oauth_error=token_exchange_failed\");\n      }\n      \n      let tokenData;\n      try {\n        tokenData = await tokenResponse.json();\n      } catch (parseError) {\n        console.error(\"Token response parse error:\", parseError);\n        delete req.session.oauthStates[state as string];\n        return res.redirect(\"/marcom?oauth_error=invalid_token_response\");\n      }\n      \n      const { access_token, refresh_token, expires_in } = tokenData;\n      \n      if (!access_token) {\n        console.error(\"No access token in response:\", tokenData);\n        delete req.session.oauthStates[state as string];\n        return res.redirect(\"/marcom?oauth_error=no_access_token\");\n      }\n      \n      // Fetch account info from the platform to get account details\n      let accountName = `${platform}_account`;\n      let accountId = \"\";\n      \n      // Platform-specific API calls to get account info\n      // (This would need to be implemented for each platform)\n      // For now, we'll use placeholder values\n      \n      // Create or update social account\n      const expiresAt = expires_in \n        ? new Date(Date.now() + expires_in * 1000)\n        : undefined;\n      \n      try {\n        const accountData = {\n          tenantId: stateData.tenantId,\n          platform,\n          accountName,\n          accountId: accountId || undefined,\n          apiKey: access_token,\n          refreshToken: refresh_token || undefined,\n          expiresAt,\n          isActive: true,\n        };\n        \n        await storage.createSocialAccount(accountData);\n        \n        // Create audit log\n        const userId = stateData.userId;\n        const user = await storage.getUser(userId);\n        await createAuditLog(\n          stateData.tenantId,\n          userId,\n          `${user?.firstName || ''} ${user?.lastName || ''}`.trim() || user?.email || 'Unknown',\n          `Connected ${platform} account via OAuth`,\n          \"socialAccount\",\n          undefined,\n          undefined,\n          accountData,\n          \"create\"\n        );\n        \n        // Clear used state\n        delete req.session.oauthStates[state as string];\n        \n        // Clean up other expired states\n        const now = Date.now();\n        if (req.session.oauthStates) {\n          Object.keys(req.session.oauthStates).forEach((key) => {\n            if (now - req.session.oauthStates[key].timestamp > 10 * 60 * 1000) {\n              delete req.session.oauthStates[key];\n            }\n          });\n        }\n        \n        // Redirect to marcom page with success message\n        res.redirect(\"/marcom?oauth_success=true\");\n      } catch (storageError) {\n        console.error(\"Error saving social account:\", storageError);\n        delete req.session.oauthStates[state as string];\n        return res.redirect(\"/marcom?oauth_error=save_failed\");\n      }\n    } catch (error) {\n      console.error(\"Error handling OAuth callback:\", error);\n      // Clean up state if it exists\n      if (req.query.state && req.session?.oauthStates?.[req.query.state as string]) {\n        delete req.session.oauthStates[req.query.state as string];\n      }\n      res.redirect(\"/marcom?oauth_error=callback_failed\");\n    }\n  });\n\n  // ==================== Finance Routes ====================\n  \n  // Get all transactions for tenant\n  app.get(\"/api/finance\", isAuthenticated, checkTenantSuspension, async (req: any, res) => {\n    try {\n      const tenantId = await getTenantId(req);\n      const transactionList = await storage.getTransactionsByTenant(tenantId);\n      res.json(transactionList);\n    } catch (error) {\n      console.error(\"Error fetching transactions:\", error);\n      res.status(500).json({ message: \"Failed to fetch transactions\" });\n    }\n  });\n\n  // Create a new transaction\n  app.post(\"/api/finance\", isAuthenticated, checkTenantSuspension, async (req: any, res) => {\n    try {\n      const tenantId = await getTenantId(req);\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      \n      const validatedData = insertTransactionSchema.parse({ \n        ...req.body, \n        tenantId,\n        createdBy: userId \n      });\n      const newTransaction = await storage.createTransaction(validatedData);\n      \n      await createAuditLog(\n        tenantId,\n        userId,\n        `${user?.firstName || ''} ${user?.lastName || ''}`.trim() || user?.email || 'Unknown',\n        `Added ${newTransaction.type} transaction: ${newTransaction.description || newTransaction.category}`,\n        \"transaction\",\n        newTransaction.id,\n        undefined,\n        newTransaction,\n        \"create\"\n      );\n      \n      res.json(newTransaction);\n    } catch (error) {\n      console.error(\"Error creating transaction:\", error);\n      res.status(500).json({ message: \"Failed to create transaction\" });\n    }\n  });\n\n  // Update a transaction\n  app.patch(\"/api/finance/:id\", isAuthenticated, checkTenantSuspension, async (req: any, res) => {\n    try {\n      const tenantId = await getTenantId(req);\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      \n      const oldTransaction = await storage.getTransaction(req.params.id, tenantId);\n      if (!oldTransaction) {\n        return res.status(404).json({ message: \"Transaction not found\" });\n      }\n      \n      const validatedData = insertTransactionSchema.partial().parse(req.body);\n      const updatedTransaction = await storage.updateTransaction(req.params.id, tenantId, validatedData);\n      \n      await createAuditLog(\n        tenantId,\n        userId,\n        `${user?.firstName || ''} ${user?.lastName || ''}`.trim() || user?.email || 'Unknown',\n        `Updated ${updatedTransaction.type} transaction: ${updatedTransaction.description || updatedTransaction.category}`,\n        \"transaction\",\n        updatedTransaction.id,\n        oldTransaction,\n        updatedTransaction,\n        \"update\"\n      );\n      \n      res.json(updatedTransaction);\n    } catch (error) {\n      console.error(\"Error updating transaction:\", error);\n      res.status(500).json({ message: \"Failed to update transaction\" });\n    }\n  });\n\n  // Delete a transaction\n  app.delete(\"/api/finance/:id\", isAuthenticated, checkTenantSuspension, async (req: any, res) => {\n    try {\n      const tenantId = await getTenantId(req);\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      \n      const transaction = await storage.getTransaction(req.params.id, tenantId);\n      if (!transaction) {\n        return res.status(404).json({ message: \"Transaction not found\" });\n      }\n      \n      await storage.deleteTransaction(req.params.id, tenantId);\n      \n      await createAuditLog(\n        tenantId,\n        userId,\n        `${user?.firstName || ''} ${user?.lastName || ''}`.trim() || user?.email || 'Unknown',\n        `Deleted ${transaction.type} transaction: ${transaction.description || transaction.category}`,\n        \"transaction\",\n        req.params.id,\n        transaction,\n        undefined,\n        \"delete\"\n      );\n      \n      res.json({ success: true });\n    } catch (error) {\n      console.error(\"Error deleting transaction:\", error);\n      res.status(500).json({ message: \"Failed to delete transaction\" });\n    }\n  });\n\n  // Get monthly aggregated transaction data\n  app.get(\"/api/finance/monthly\", isAuthenticated, checkTenantSuspension, async (req: any, res) => {\n    try {\n      const tenantId = await getTenantId(req);\n      const transactions = await storage.getTransactionsByTenant(tenantId);\n      \n      // Group transactions by month\n      const monthlyData: Record<string, { income: number; expenses: number }> = {};\n      \n      transactions.forEach(transaction => {\n        const date = new Date(transaction.date);\n        const monthKey = `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}`;\n        \n        if (!monthlyData[monthKey]) {\n          monthlyData[monthKey] = { income: 0, expenses: 0 };\n        }\n        \n        const amount = parseFloat(transaction.amount);\n        if (transaction.type === 'income') {\n          monthlyData[monthKey].income += amount;\n        } else {\n          monthlyData[monthKey].expenses += amount;\n        }\n      });\n      \n      // Convert to array and sort by date\n      const result = Object.entries(monthlyData)\n        .map(([month, data]) => ({\n          month,\n          income: data.income,\n          expenses: data.expenses,\n          profit: data.income - data.expenses\n        }))\n        .sort((a, b) => a.month.localeCompare(b.month));\n      \n      res.json(result);\n    } catch (error) {\n      console.error(\"Error fetching monthly data:\", error);\n      res.status(500).json({ message: \"Failed to fetch monthly data\" });\n    }\n  });\n\n  // Export transactions as CSV\n  app.get(\"/api/finance/export\", isAuthenticated, checkTenantSuspension, async (req: any, res) => {\n    try {\n      const tenantId = await getTenantId(req);\n      const transactions = await storage.getTransactionsByTenant(tenantId);\n      \n      // Create CSV header\n      const header = 'Date,Type,Category,Amount,Description,Payment Method,Reference\\n';\n      \n      // Create CSV rows\n      const rows = transactions\n        .sort((a, b) => new Date(b.date).getTime() - new Date(a.date).getTime())\n        .map(t => {\n          const date = new Date(t.date).toISOString().split('T')[0];\n          const description = (t.description || '').replace(/\"/g, '\"\"');\n          const paymentMethod = t.paymentMethod || '';\n          const reference = t.reference || '';\n          \n          return `${date},${t.type},${t.category},${t.amount},\"${description}\",${paymentMethod},${reference}`;\n        })\n        .join('\\n');\n      \n      const csv = header + rows;\n      \n      // Set headers for CSV download\n      res.setHeader('Content-Type', 'text/csv');\n      res.setHeader('Content-Disposition', 'attachment; filename=\"transactions.csv\"');\n      res.send(csv);\n    } catch (error) {\n      console.error(\"Error exporting transactions:\", error);\n      res.status(500).json({ message: \"Failed to export transactions\" });\n    }\n  });\n\n  // ==================== Stripe Subscription Routes ====================\n  \n  // Create Stripe checkout session for subscription\n  app.post(\"/api/subscriptions/create-checkout\", isAuthenticated, checkTenantSuspension, async (req: any, res) => {\n    try {\n      const tenantId = await getTenantId(req);\n      const tenant = await storage.getTenant(tenantId);\n      const { plan } = req.body; // starter, growth, enterprise\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      \n      if (!tenant) {\n        return res.status(404).json({ message: \"Tenant not found\" });\n      }\n      \n      if (!user || !user.email) {\n        return res.status(400).json({ message: \"User email not found\" });\n      }\n      \n      // Price mapping (in cents) - these should be configured in Stripe dashboard\n      const prices: Record<string, number> = {\n        starter: 2900,  // $29/month\n        growth: 9900,   // $99/month\n        enterprise: 29900, // $299/month\n      };\n      \n      if (!prices[plan]) {\n        return res.status(400).json({ message: \"Invalid plan selected\" });\n      }\n      \n      // Create or retrieve Stripe customer\n      let customerId = tenant.stripeCustomerId;\n      if (!customerId) {\n        const customer = await stripe.customers.create({\n          email: user.email, // Use authenticated user's email\n          name: tenant.name,\n          metadata: {\n            tenantId: tenant.id,\n            tenantName: tenant.name,\n            userId: user.id,\n          },\n        });\n        customerId = customer.id;\n        await storage.updateTenantStripe(tenantId, { stripeCustomerId: customerId });\n      }\n      \n      // Build base URL with proper scheme\n      const baseUrl = process.env.REPLIT_DEV_DOMAIN \n        ? (process.env.REPLIT_DEV_DOMAIN.startsWith('http') \n            ? process.env.REPLIT_DEV_DOMAIN \n            : `https://${process.env.REPLIT_DEV_DOMAIN}`)\n        : 'http://localhost:5000';\n      \n      // Create checkout session for subscription\n      const session = await stripe.checkout.sessions.create({\n        customer: customerId,\n        mode: \"subscription\",\n        payment_method_types: [\"card\"],\n        line_items: [\n          {\n            price_data: {\n              currency: \"usd\",\n              product_data: {\n                name: `${plan.charAt(0).toUpperCase() + plan.slice(1)} Plan`,\n                description: `Nexus Esports Suite - ${plan} subscription`,\n              },\n              unit_amount: prices[plan],\n              recurring: {\n                interval: \"month\",\n              },\n            },\n            quantity: 1,\n          },\n        ],\n        success_url: `${baseUrl}/settings?session_id={CHECKOUT_SESSION_ID}`,\n        cancel_url: `${baseUrl}/settings`,\n        metadata: {\n          tenantId: tenant.id,\n          plan,\n        },\n      });\n      \n      res.json({ url: session.url });\n    } catch (error: any) {\n      console.error(\"Error creating checkout session:\", error);\n      res.status(500).json({ message: \"Failed to create checkout session\", error: error.message });\n    }\n  });\n  \n  // Sync subscription from Stripe session (for environments where webhooks don't work)\n  app.post(\"/api/subscriptions/sync-session\", isAuthenticated, checkTenantSuspension, async (req: any, res) => {\n    try {\n      const tenantId = await getTenantId(req);\n      const { sessionId } = req.body;\n      \n      if (!sessionId) {\n        return res.status(400).json({ message: \"Session ID required\" });\n      }\n      \n      // Retrieve session from Stripe\n      const session = await stripe.checkout.sessions.retrieve(sessionId);\n      \n      // SECURITY: Validate session belongs to this tenant via customer ID\n      const tenant = await storage.getTenant(tenantId);\n      if (!tenant) {\n        return res.status(404).json({ message: \"Tenant not found\" });\n      }\n      \n      // Verify customer ID matches\n      if (session.customer !== tenant.stripeCustomerId) {\n        return res.status(403).json({ message: \"Session customer does not match tenant\" });\n      }\n      \n      if (session.payment_status !== 'paid') {\n        return res.status(400).json({ message: \"Payment not completed\" });\n      }\n      \n      // Get subscription from session\n      const subscriptionId = session.subscription as string;\n      if (!subscriptionId) {\n        return res.status(400).json({ message: \"No subscription found\" });\n      }\n      \n      const subscription = await stripe.subscriptions.retrieve(subscriptionId);\n      const plan = session.metadata?.plan || 'starter';\n      \n      // SECURITY: Verify the price matches the plan\n      const prices: Record<string, number> = {\n        starter: 2900,\n        growth: 9900,\n        enterprise: 29900,\n      };\n      \n      const expectedPrice = prices[plan];\n      const actualPrice = subscription.items.data[0]?.price.unit_amount || 0;\n      \n      if (actualPrice !== expectedPrice) {\n        return res.status(400).json({ message: \"Price mismatch - subscription verification failed\" });\n      }\n      \n      // Update tenant subscription\n      await storage.updateTenant(tenantId, {\n        subscriptionPlan: plan,\n        subscriptionStatus: 'active',\n        stripeSubscriptionId: subscriptionId,\n      });\n      \n      res.json({ success: true, plan });\n    } catch (error: any) {\n      console.error(\"Error syncing session:\", error);\n      res.status(500).json({ message: \"Failed to sync session\", error: error.message });\n    }\n  });\n  \n  // Create Stripe billing portal session\n  app.post(\"/api/subscriptions/create-portal\", isAuthenticated, checkTenantSuspension, async (req: any, res) => {\n    try {\n      const tenantId = await getTenantId(req);\n      const tenant = await storage.getTenant(tenantId);\n      \n      if (!tenant || !tenant.stripeCustomerId) {\n        return res.status(400).json({ message: \"No subscription found\" });\n      }\n      \n      // Build base URL with proper scheme\n      const baseUrl = process.env.REPLIT_DEV_DOMAIN \n        ? (process.env.REPLIT_DEV_DOMAIN.startsWith('http') \n            ? process.env.REPLIT_DEV_DOMAIN \n            : `https://${process.env.REPLIT_DEV_DOMAIN}`)\n        : 'http://localhost:5000';\n      \n      const session = await stripe.billingPortal.sessions.create({\n        customer: tenant.stripeCustomerId,\n        return_url: `${baseUrl}/settings`,\n      });\n      \n      res.json({ url: session.url });\n    } catch (error: any) {\n      console.error(\"Error creating portal session:\", error);\n      res.status(500).json({ message: \"Failed to create portal session\", error: error.message });\n    }\n  });\n  \n  // Webhook endpoint for Stripe events\n  app.post(\"/api/webhooks/stripe\", async (req, res) => {\n    const sig = req.headers['stripe-signature'];\n    \n    try {\n      const event = stripe.webhooks.constructEvent(\n        req.body,\n        sig as string,\n        process.env.STRIPE_WEBHOOK_SECRET || \"\"\n      );\n      \n      // Handle subscription events\n      switch (event.type) {\n        case 'checkout.session.completed': {\n          const session = event.data.object as any;\n          const tenantId = session.metadata.tenantId;\n          const plan = session.metadata.plan;\n          \n          if (tenantId && session.subscription) {\n            await storage.updateTenantStripe(tenantId, {\n              stripeSubscriptionId: session.subscription as string,\n              subscriptionPlan: plan,\n              subscriptionStatus: 'active',\n            });\n          }\n          break;\n        }\n        \n        case 'customer.subscription.updated': {\n          const subscription = event.data.object as any;\n          const customer = await stripe.customers.retrieve(subscription.customer);\n          const tenantId = (customer as any).metadata?.tenantId;\n          \n          if (tenantId) {\n            await storage.updateTenantStripe(tenantId, {\n              subscriptionStatus: subscription.status,\n            });\n          }\n          break;\n        }\n        \n        case 'customer.subscription.deleted': {\n          const subscription = event.data.object as any;\n          const customer = await stripe.customers.retrieve(subscription.customer);\n          const tenantId = (customer as any).metadata?.tenantId;\n          \n          if (tenantId) {\n            await storage.updateTenantStripe(tenantId, {\n              subscriptionStatus: 'canceled',\n            });\n          }\n          break;\n        }\n      }\n      \n      res.json({ received: true });\n    } catch (error: any) {\n      console.error(\"Webhook error:\", error.message);\n      res.status(400).json({ message: `Webhook Error: ${error.message}` });\n    }\n  });\n\n  const httpServer = createServer(app);\n  return httpServer;\n}\n","size_bytes":79935},"client/src/components/ui/select.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SelectPrimitive from \"@radix-ui/react-select\"\nimport { Check, ChevronDown, ChevronUp } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Select = SelectPrimitive.Root\n\nconst SelectGroup = SelectPrimitive.Group\n\nconst SelectValue = SelectPrimitive.Value\n\nconst SelectTrigger = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex h-9 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <SelectPrimitive.Icon asChild>\n      <ChevronDown className=\"h-4 w-4 opacity-50\" />\n    </SelectPrimitive.Icon>\n  </SelectPrimitive.Trigger>\n))\nSelectTrigger.displayName = SelectPrimitive.Trigger.displayName\n\nconst SelectScrollUpButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollUpButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronUp className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollUpButton>\n))\nSelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName\n\nconst SelectScrollDownButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollDownButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronDown className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollDownButton>\n))\nSelectScrollDownButton.displayName =\n  SelectPrimitive.ScrollDownButton.displayName\n\nconst SelectContent = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>\n>(({ className, children, position = \"popper\", ...props }, ref) => (\n  <SelectPrimitive.Portal>\n    <SelectPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]\",\n        position === \"popper\" &&\n          \"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1\",\n        className\n      )}\n      position={position}\n      {...props}\n    >\n      <SelectScrollUpButton />\n      <SelectPrimitive.Viewport\n        className={cn(\n          \"p-1\",\n          position === \"popper\" &&\n            \"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]\"\n        )}\n      >\n        {children}\n      </SelectPrimitive.Viewport>\n      <SelectScrollDownButton />\n    </SelectPrimitive.Content>\n  </SelectPrimitive.Portal>\n))\nSelectContent.displayName = SelectPrimitive.Content.displayName\n\nconst SelectLabel = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Label\n    ref={ref}\n    className={cn(\"py-1.5 pl-8 pr-2 text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nSelectLabel.displayName = SelectPrimitive.Label.displayName\n\nconst SelectItem = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <SelectPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </SelectPrimitive.ItemIndicator>\n    </span>\n\n    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\n  </SelectPrimitive.Item>\n))\nSelectItem.displayName = SelectPrimitive.Item.displayName\n\nconst SelectSeparator = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nSelectSeparator.displayName = SelectPrimitive.Separator.displayName\n\nexport {\n  Select,\n  SelectGroup,\n  SelectValue,\n  SelectTrigger,\n  SelectContent,\n  SelectLabel,\n  SelectItem,\n  SelectSeparator,\n  SelectScrollUpButton,\n  SelectScrollDownButton,\n}\n","size_bytes":5741},"client/src/components/ui/dropdown-menu.tsx":{"content":"import * as React from \"react\"\nimport * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst DropdownMenu = DropdownMenuPrimitive.Root\n\nconst DropdownMenuTrigger = DropdownMenuPrimitive.Trigger\n\nconst DropdownMenuGroup = DropdownMenuPrimitive.Group\n\nconst DropdownMenuPortal = DropdownMenuPrimitive.Portal\n\nconst DropdownMenuSub = DropdownMenuPrimitive.Sub\n\nconst DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup\n\nconst DropdownMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto\" />\n  </DropdownMenuPrimitive.SubTrigger>\n))\nDropdownMenuSubTrigger.displayName =\n  DropdownMenuPrimitive.SubTrigger.displayName\n\nconst DropdownMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuSubContent.displayName =\n  DropdownMenuPrimitive.SubContent.displayName\n\nconst DropdownMenuContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <DropdownMenuPrimitive.Portal>\n    <DropdownMenuPrimitive.Content\n      ref={ref}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </DropdownMenuPrimitive.Portal>\n))\nDropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName\n\nconst DropdownMenuItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName\n\nconst DropdownMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <DropdownMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.CheckboxItem>\n))\nDropdownMenuCheckboxItem.displayName =\n  DropdownMenuPrimitive.CheckboxItem.displayName\n\nconst DropdownMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.RadioItem>\n))\nDropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName\n\nconst DropdownMenuLabel = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName\n\nconst DropdownMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nDropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName\n\nconst DropdownMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\"ml-auto text-xs tracking-widest opacity-60\", className)}\n      {...props}\n    />\n  )\n}\nDropdownMenuShortcut.displayName = \"DropdownMenuShortcut\"\n\nexport {\n  DropdownMenu,\n  DropdownMenuTrigger,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuCheckboxItem,\n  DropdownMenuRadioItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuShortcut,\n  DropdownMenuGroup,\n  DropdownMenuPortal,\n  DropdownMenuSub,\n  DropdownMenuSubContent,\n  DropdownMenuSubTrigger,\n  DropdownMenuRadioGroup,\n}\n","size_bytes":7609},"drizzle.config.ts":{"content":"import { defineConfig } from \"drizzle-kit\";\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\"DATABASE_URL, ensure the database is provisioned\");\n}\n\nexport default defineConfig({\n  out: \"./migrations\",\n  schema: \"./shared/schema.ts\",\n  dialect: \"postgresql\",\n  dbCredentials: {\n    url: process.env.DATABASE_URL,\n  },\n});\n","size_bytes":325},"client/src/lib/authUtils.ts":{"content":"export function isUnauthorizedError(error: Error): boolean {\n  return /^401: .*Unauthorized/.test(error.message);\n}\n","size_bytes":116},"client/src/components/ui/dialog.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as DialogPrimitive from \"@radix-ui/react-dialog\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Dialog = DialogPrimitive.Root\n\nconst DialogTrigger = DialogPrimitive.Trigger\n\nconst DialogPortal = DialogPrimitive.Portal\n\nconst DialogClose = DialogPrimitive.Close\n\nconst DialogOverlay = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Overlay\n    ref={ref}\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogOverlay.displayName = DialogPrimitive.Overlay.displayName\n\nconst DialogContent = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DialogPortal>\n    <DialogOverlay />\n    <DialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <DialogPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </DialogPrimitive.Close>\n    </DialogPrimitive.Content>\n  </DialogPortal>\n))\nDialogContent.displayName = DialogPrimitive.Content.displayName\n\nconst DialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-1.5 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogHeader.displayName = \"DialogHeader\"\n\nconst DialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogFooter.displayName = \"DialogFooter\"\n\nconst DialogTitle = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogTitle.displayName = DialogPrimitive.Title.displayName\n\nconst DialogDescription = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDialogDescription.displayName = DialogPrimitive.Description.displayName\n\nexport {\n  Dialog,\n  DialogPortal,\n  DialogOverlay,\n  DialogClose,\n  DialogTrigger,\n  DialogContent,\n  DialogHeader,\n  DialogFooter,\n  DialogTitle,\n  DialogDescription,\n}\n","size_bytes":3848},"client/src/lib/queryClient.ts":{"content":"import { QueryClient, QueryFunction } from \"@tanstack/react-query\";\n\nasync function throwIfResNotOk(res: Response) {\n  if (!res.ok) {\n    const text = (await res.text()) || res.statusText;\n    \n    // Try to parse JSON error response\n    try {\n      const errorData = JSON.parse(text);\n      const error = new Error(errorData.message || text);\n      // Attach full error data for access in error handlers\n      (error as any).data = errorData;\n      throw error;\n    } catch {\n      // Not JSON, throw as plain text\n      throw new Error(`${res.status}: ${text}`);\n    }\n  }\n}\n\nexport async function apiRequest(\n  url: string,\n  method: string,\n  data?: unknown | undefined,\n): Promise<Response> {\n  const res = await fetch(url, {\n    method,\n    headers: data ? { \"Content-Type\": \"application/json\" } : {},\n    body: data ? JSON.stringify(data) : undefined,\n    credentials: \"include\",\n  });\n\n  await throwIfResNotOk(res);\n  return res;\n}\n\ntype UnauthorizedBehavior = \"returnNull\" | \"throw\";\nexport const getQueryFn: <T>(options: {\n  on401: UnauthorizedBehavior;\n}) => QueryFunction<T> =\n  ({ on401: unauthorizedBehavior }) =>\n  async ({ queryKey }) => {\n    const res = await fetch(queryKey.join(\"/\") as string, {\n      credentials: \"include\",\n    });\n\n    if (unauthorizedBehavior === \"returnNull\" && res.status === 401) {\n      return null;\n    }\n\n    await throwIfResNotOk(res);\n    return await res.json();\n  };\n\nexport const queryClient = new QueryClient({\n  defaultOptions: {\n    queries: {\n      queryFn: getQueryFn({ on401: \"throw\" }),\n      refetchInterval: false,\n      refetchOnWindowFocus: false,\n      staleTime: Infinity,\n      retry: false,\n    },\n    mutations: {\n      retry: false,\n    },\n  },\n});\n","size_bytes":1718},"client/src/components/campaign-card.tsx":{"content":"import { Card, CardContent, CardFooter, CardHeader } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { SiX, SiInstagram, SiYoutube, SiTiktok, SiTwitch } from \"react-icons/si\";\nimport { TrendingUp, Eye, Heart } from \"lucide-react\";\nimport { format } from \"date-fns\";\n\ninterface CampaignCardProps {\n  id: string;\n  title: string;\n  description: string;\n  startDate: Date;\n  endDate: Date;\n  platforms: Array<'twitter' | 'instagram' | 'youtube' | 'tiktok' | 'twitch'>;\n  reach?: number;\n  engagement?: number;\n  status: \"active\" | \"completed\" | \"scheduled\";\n}\n\nexport function CampaignCard({ id, title, description, startDate, endDate, platforms, reach, engagement, status }: CampaignCardProps) {\n  const platformIcons = {\n    twitter: SiX,\n    instagram: SiInstagram,\n    youtube: SiYoutube,\n    tiktok: SiTiktok,\n    twitch: SiTwitch,\n  };\n\n  const statusColors = {\n    active: 'bg-chart-2 text-primary-foreground',\n    completed: 'bg-secondary text-secondary-foreground',\n    scheduled: 'bg-chart-4 text-primary-foreground',\n  };\n\n  return (\n    <Card className=\"hover-elevate active-elevate-2 cursor-pointer\" data-testid={`card-campaign-${id}`}>\n      <CardHeader className=\"pb-3\">\n        <div className=\"flex items-start justify-between gap-2\">\n          <h3 className=\"font-semibold text-base line-clamp-1\" data-testid={`text-title-${id}`}>{title}</h3>\n          <Badge className={`${statusColors[status]} text-xs shrink-0`}>\n            {status.charAt(0).toUpperCase() + status.slice(1)}\n          </Badge>\n        </div>\n        <p className=\"text-sm text-muted-foreground line-clamp-2 mt-1\">{description}</p>\n      </CardHeader>\n      <CardContent className=\"pb-3\">\n        <div className=\"flex items-center gap-2 mb-3\">\n          {platforms.map((platform) => {\n            const Icon = platformIcons[platform];\n            return <Icon key={platform} className=\"w-4 h-4 text-muted-foreground\" />;\n          })}\n        </div>\n        {(reach !== undefined || engagement !== undefined) && (\n          <div className=\"grid grid-cols-2 gap-3\">\n            {reach !== undefined && (\n              <div className=\"flex items-center gap-2\">\n                <Eye className=\"w-4 h-4 text-chart-3\" />\n                <div>\n                  <p className=\"text-sm font-mono font-semibold\">{reach.toLocaleString()}</p>\n                  <p className=\"text-xs text-muted-foreground\">Reach</p>\n                </div>\n              </div>\n            )}\n            {engagement !== undefined && (\n              <div className=\"flex items-center gap-2\">\n                <Heart className=\"w-4 h-4 text-chart-5\" />\n                <div>\n                  <p className=\"text-sm font-mono font-semibold\">{engagement}%</p>\n                  <p className=\"text-xs text-muted-foreground\">Engagement</p>\n                </div>\n              </div>\n            )}\n          </div>\n        )}\n      </CardContent>\n      <CardFooter className=\"pt-0 pb-4 text-xs text-muted-foreground\">\n        {format(startDate, 'MMM dd')} - {format(endDate, 'MMM dd, yyyy')}\n      </CardFooter>\n    </Card>\n  );\n}\n","size_bytes":3116},"client/src/components/stat-card.tsx":{"content":"import { Card, CardContent, CardHeader } from \"@/components/ui/card\";\nimport { LucideIcon, TrendingUp, TrendingDown } from \"lucide-react\";\n\ninterface StatCardProps {\n  title: string;\n  value: string | number;\n  icon: LucideIcon;\n  trend?: number;\n  trendLabel?: string;\n  subtitle?: string;\n}\n\nexport function StatCard({ title, value, icon: Icon, trend, trendLabel, subtitle }: StatCardProps) {\n  const isPositive = trend !== undefined && trend > 0;\n  const isNegative = trend !== undefined && trend < 0;\n\n  return (\n    <Card className=\"hover-elevate\">\n      <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n        <h3 className=\"text-sm font-medium text-muted-foreground\">{title}</h3>\n        <Icon className=\"h-4 w-4 text-muted-foreground\" />\n      </CardHeader>\n      <CardContent>\n        <div className=\"text-3xl font-bold font-heading\" data-testid={`stat-${title.toLowerCase().replace(/\\s+/g, '-')}`}>\n          {value}\n        </div>\n        {trend !== undefined && (\n          <div className=\"flex items-center gap-1 mt-1\">\n            {isPositive && <TrendingUp className=\"h-3 w-3 text-chart-2\" />}\n            {isNegative && <TrendingDown className=\"h-3 w-3 text-chart-5\" />}\n            <span className={`text-xs font-medium ${isPositive ? 'text-chart-2' : isNegative ? 'text-chart-5' : 'text-muted-foreground'}`}>\n              {trend > 0 ? '+' : ''}{trend}%\n            </span>\n            {trendLabel && <span className=\"text-xs text-muted-foreground\">{trendLabel}</span>}\n          </div>\n        )}\n        {subtitle && <p className=\"text-xs text-muted-foreground mt-1\">{subtitle}</p>}\n      </CardContent>\n    </Card>\n  );\n}\n","size_bytes":1684},"client/src/index.css":{"content":"@tailwind base;\n@tailwind components;\n@tailwind utilities;\n\n/* LIGHT MODE */\n:root {\n  --button-outline: rgba(0,0,0, .10);\n  --badge-outline: rgba(0,0,0, .05);\n\n  /* Automatic computation of border around primary / danger buttons */\n  --opaque-button-border-intensity: -8; /* In terms of percentages */\n\n  /* Backgrounds applied on top of other backgrounds when hovered/active */\n  --elevate-1: rgba(0,0,0, .03);\n  --elevate-2: rgba(0,0,0, .08);\n\n  --background: 0 0% 98%;\n\n  --foreground: 222 25% 15%;\n\n  --border: 0 0% 90%;\n\n  --card: 0 0% 96%;\n\n  --card-foreground: 222 25% 18%;\n\n  --card-border: 0 0% 92%;\n\n  --sidebar: 0 0% 94%;\n\n  --sidebar-foreground: 222 25% 20%;\n\n  --sidebar-border: 0 0% 90%;\n\n  --sidebar-primary: 270 85% 65%;\n\n  --sidebar-primary-foreground: 0 0% 98%;\n\n  --sidebar-accent: 0 0% 90%;\n\n  --sidebar-accent-foreground: 222 25% 20%;\n\n  --sidebar-ring: 270 85% 65%;\n\n  --popover: 0 0% 93%;\n\n  --popover-foreground: 222 25% 20%;\n\n  --popover-border: 0 0% 88%;\n\n  --primary: 270 85% 65%;\n\n  --primary-foreground: 0 0% 98%;\n\n  --secondary: 0 0% 88%;\n\n  --secondary-foreground: 222 25% 22%;\n\n  --muted: 0 0% 90%;\n\n  --muted-foreground: 222 20% 35%;\n\n  --accent: 270 15% 88%;\n\n  --accent-foreground: 222 25% 22%;\n\n  --destructive: 0 75% 60%;\n\n  --destructive-foreground: 0 0% 98%;\n\n  --input: 0 0% 82%;\n  --ring: 270 85% 65%;\n  --chart-1: 270 85% 55%;\n  --chart-2: 142 70% 45%;\n  --chart-3: 200 85% 50%;\n  --chart-4: 35 90% 55%;\n  --chart-5: 0 75% 55%;\n\n  --font-sans: Inter, sans-serif;\n  --font-heading: Space Grotesk, sans-serif;\n  --font-mono: JetBrains Mono, monospace;\n  --radius: .5rem; /* 8px */\n  --shadow-2xs: 0px 2px 0px 0px hsl(0 0% 0% / 0.02);\n  --shadow-xs: 0px 2px 0px 0px hsl(0 0% 0% / 0.03);\n  --shadow-sm: 0px 2px 0px 0px hsl(0 0% 0% / 0.04), 0px 1px 2px -1px hsl(0 0% 0% / 0.05);\n  --shadow: 0px 2px 0px 0px hsl(0 0% 0% / 0.05), 0px 1px 2px -1px hsl(0 0% 0% / 0.06);\n  --shadow-md: 0px 2px 0px 0px hsl(0 0% 0% / 0.06), 0px 2px 4px -1px hsl(0 0% 0% / 0.07);\n  --shadow-lg: 0px 2px 0px 0px hsl(0 0% 0% / 0.08), 0px 4px 6px -1px hsl(0 0% 0% / 0.09);\n  --shadow-xl: 0px 2px 0px 0px hsl(0 0% 0% / 0.10), 0px 8px 10px -1px hsl(0 0% 0% / 0.11);\n  --shadow-2xl: 0px 2px 0px 0px hsl(0 0% 0% / 0.12);\n  --tracking-normal: 0em;\n  --spacing: 0.25rem;\n\n  /* Automatically computed borders - intensity can be controlled by the user by the --opaque-button-border-intensity setting */\n\n  /* Fallback for older browsers */\n  --sidebar-primary-border: hsl(var(--sidebar-primary));\n  --sidebar-primary-border: hsl(from hsl(var(--sidebar-primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --sidebar-accent-border: hsl(var(--sidebar-accent));\n  --sidebar-accent-border: hsl(from hsl(var(--sidebar-accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --primary-border: hsl(var(--primary));\n  --primary-border: hsl(from hsl(var(--primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --secondary-border: hsl(var(--secondary));\n  --secondary-border: hsl(from hsl(var(--secondary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --muted-border: hsl(var(--muted));\n  --muted-border: hsl(from hsl(var(--muted)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --accent-border: hsl(var(--accent));\n  --accent-border: hsl(from hsl(var(--accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --destructive-border: hsl(var(--destructive));\n  --destructive-border: hsl(from hsl(var(--destructive)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n}\n\n.dark {\n  --button-outline: rgba(255,255,255, .10);\n  --badge-outline: rgba(255,255,255, .05);\n\n  --opaque-button-border-intensity: 9;  /* In terms of percentages */\n\n  /* Backgrounds applied on top of other backgrounds when hovered/active */\n  --elevate-1: rgba(255,255,255, .04);\n  --elevate-2: rgba(255,255,255, .09);\n\n  --background: 222 25% 8%;\n\n  --foreground: 0 0% 95%;\n\n  --border: 222 22% 14%;\n\n  --card: 222 20% 10%;\n\n  --card-foreground: 0 0% 92%;\n\n  --card-border: 222 18% 13%;\n\n  --sidebar: 222 18% 12%;\n\n  --sidebar-foreground: 0 0% 90%;\n\n  --sidebar-border: 222 16% 15%;\n\n  --sidebar-primary: 270 85% 65%;\n\n  --sidebar-primary-foreground: 0 0% 98%;\n\n  --sidebar-accent: 222 16% 16%;\n\n  --sidebar-accent-foreground: 0 0% 88%;\n\n  --sidebar-ring: 270 85% 65%;\n\n  --popover: 222 18% 14%;\n\n  --popover-foreground: 0 0% 88%;\n\n  --popover-border: 222 16% 17%;\n\n  --primary: 270 85% 65%;\n\n  --primary-foreground: 0 0% 98%;\n\n  --secondary: 222 16% 18%;\n\n  --secondary-foreground: 0 0% 85%;\n\n  --muted: 222 14% 16%;\n\n  --muted-foreground: 0 0% 70%;\n\n  --accent: 270 18% 18%;\n\n  --accent-foreground: 0 0% 88%;\n\n  --destructive: 0 75% 60%;\n\n  --destructive-foreground: 0 0% 98%;\n\n  --input: 222 18% 24%;\n  --ring: 270 85% 65%;\n  --chart-1: 270 85% 70%;\n  --chart-2: 142 70% 55%;\n  --chart-3: 200 85% 60%;\n  --chart-4: 35 90% 65%;\n  --chart-5: 0 75% 65%;\n\n  --shadow-2xs: 0px 2px 0px 0px hsl(0 0% 0% / 0.15);\n  --shadow-xs: 0px 2px 0px 0px hsl(0 0% 0% / 0.20);\n  --shadow-sm: 0px 2px 0px 0px hsl(0 0% 0% / 0.25), 0px 1px 2px -1px hsl(0 0% 0% / 0.30);\n  --shadow: 0px 2px 0px 0px hsl(0 0% 0% / 0.30), 0px 1px 2px -1px hsl(0 0% 0% / 0.35);\n  --shadow-md: 0px 2px 0px 0px hsl(0 0% 0% / 0.35), 0px 2px 4px -1px hsl(0 0% 0% / 0.40);\n  --shadow-lg: 0px 2px 0px 0px hsl(0 0% 0% / 0.40), 0px 4px 6px -1px hsl(0 0% 0% / 0.45);\n  --shadow-xl: 0px 2px 0px 0px hsl(0 0% 0% / 0.45), 0px 8px 10px -1px hsl(0 0% 0% / 0.50);\n  --shadow-2xl: 0px 2px 0px 0px hsl(0 0% 0% / 0.55);\n\n  /* Fallback for older browsers */\n  --sidebar-primary-border: hsl(var(--sidebar-primary));\n  --sidebar-primary-border: hsl(from hsl(var(--sidebar-primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --sidebar-accent-border: hsl(var(--sidebar-accent));\n  --sidebar-accent-border: hsl(from hsl(var(--sidebar-accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --primary-border: hsl(var(--primary));\n  --primary-border: hsl(from hsl(var(--primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --secondary-border: hsl(var(--secondary));\n  --secondary-border: hsl(from hsl(var(--secondary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --muted-border: hsl(var(--muted));\n  --muted-border: hsl(from hsl(var(--muted)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --accent-border: hsl(var(--accent));\n  --accent-border: hsl(from hsl(var(--accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --destructive-border: hsl(var(--destructive));\n  --destructive-border: hsl(from hsl(var(--destructive)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n}\n\n@layer base {\n  * {\n    @apply border-border;\n  }\n\n  body {\n    @apply font-sans antialiased bg-background text-foreground;\n  }\n}\n\n@layer utilities {\n\n  /* Hide ugly search cancel button in Chrome until we can style it properly */\n  input[type=\"search\"]::-webkit-search-cancel-button {\n    @apply hidden;\n  }\n\n  /* Placeholder styling for contentEditable div */\n  [contenteditable][data-placeholder]:empty::before {\n    content: attr(data-placeholder);\n    color: hsl(var(--muted-foreground));\n    pointer-events: none;\n  }\n\n  .no-default-hover-elevate {}\n\n  .no-default-active-elevate {}\n\n  .toggle-elevate::before,\n  .toggle-elevate-2::before {\n    content: \"\";\n    pointer-events: none;\n    position: absolute;\n    inset: 0px;\n    border-radius: inherit;\n    z-index: -1;\n  }\n\n  .toggle-elevate.toggle-elevated::before {\n    background-color: var(--elevate-2);\n  }\n\n  .border.toggle-elevate::before {\n    inset: -1px;\n  }\n\n  .hover-elevate:not(.no-default-hover-elevate),\n  .active-elevate:not(.no-default-active-elevate),\n  .hover-elevate-2:not(.no-default-hover-elevate),\n  .active-elevate-2:not(.no-default-active-elevate) {\n    position: relative;\n    z-index: 0;\n  }\n\n  .hover-elevate:not(.no-default-hover-elevate)::after,\n  .active-elevate:not(.no-default-active-elevate)::after,\n  .hover-elevate-2:not(.no-default-hover-elevate)::after,\n  .active-elevate-2:not(.no-default-active-elevate)::after {\n    content: \"\";\n    pointer-events: none;\n    position: absolute;\n    inset: 0px;\n    border-radius: inherit;\n    z-index: 999;\n  }\n\n  .hover-elevate:hover:not(.no-default-hover-elevate)::after,\n  .active-elevate:active:not(.no-default-active-elevate)::after {\n    background-color: var(--elevate-1);\n  }\n\n  .hover-elevate-2:hover:not(.no-default-hover-elevate)::after,\n  .active-elevate-2:active:not(.no-default-active-elevate)::after {\n    background-color: var(--elevate-2);\n  }\n\n  .border.hover-elevate:not(.no-hover-interaction-elevate)::after,\n  .border.active-elevate:not(.no-active-interaction-elevate)::after,\n  .border.hover-elevate-2:not(.no-hover-interaction-elevate)::after,\n  .border.active-elevate-2:not(.no-active-interaction-elevate)::after,\n  .border.hover-elevate:not(.no-hover-interaction-elevate)::after {\n    inset: -1px;\n  }\n}","size_bytes":9425},"client/src/pages/not-found.tsx":{"content":"import { Card, CardContent } from \"@/components/ui/card\";\nimport { AlertCircle } from \"lucide-react\";\n\nexport default function NotFound() {\n  return (\n    <div className=\"min-h-screen w-full flex items-center justify-center bg-gray-50\">\n      <Card className=\"w-full max-w-md mx-4\">\n        <CardContent className=\"pt-6\">\n          <div className=\"flex mb-4 gap-2\">\n            <AlertCircle className=\"h-8 w-8 text-red-500\" />\n            <h1 className=\"text-2xl font-bold text-gray-900\">404 Page Not Found</h1>\n          </div>\n\n          <p className=\"mt-4 text-sm text-gray-600\">\n            Did you forget to add the page to the router?\n          </p>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":711},"client/src/App.tsx":{"content":"import { Switch, Route } from \"wouter\";\nimport { queryClient } from \"./lib/queryClient\";\nimport { QueryClientProvider } from \"@tanstack/react-query\";\nimport { Toaster } from \"@/components/ui/toaster\";\nimport { TooltipProvider } from \"@/components/ui/tooltip\";\nimport { SidebarProvider, SidebarTrigger } from \"@/components/ui/sidebar\";\nimport { AppSidebar } from \"@/components/app-sidebar\";\nimport { ThemeToggle } from \"@/components/theme-toggle\";\nimport { useAuth } from \"@/hooks/useAuth\";\nimport { Button } from \"@/components/ui/button\";\nimport { LogOut } from \"lucide-react\";\nimport { useEffect } from \"react\";\nimport Login from \"@/pages/login\";\nimport Register from \"@/pages/register\";\nimport Dashboard from \"@/pages/dashboard\";\nimport Staff from \"@/pages/staff\";\nimport Payroll from \"@/pages/payroll\";\nimport Analytics from \"@/pages/analytics\";\nimport Matches from \"@/pages/matches\";\nimport Tournaments from \"@/pages/tournaments\";\nimport Marcom from \"@/pages/marcom\";\nimport Finance from \"@/pages/finance\";\nimport Contracts from \"@/pages/contracts\";\nimport Audit from \"@/pages/audit\";\nimport Settings from \"@/pages/settings\";\nimport Admin from \"@/pages/admin\";\nimport InviteAccept from \"@/pages/invite-accept\";\n\nfunction Router() {\n  const { isAuthenticated, isLoading, user } = useAuth();\n\n  if (isLoading) {\n    return (\n      <div className=\"flex items-center justify-center h-screen\">\n        <div className=\"text-center\">\n          <div className=\"inline-block h-8 w-8 animate-spin rounded-full border-4 border-solid border-primary border-r-transparent\"></div>\n          <p className=\"mt-4 text-muted-foreground\">Loading...</p>\n        </div>\n      </div>\n    );\n  }\n\n  // Allow access to invite page without auth\n  if (window.location.pathname.startsWith('/invite/')) {\n    return (\n      <Switch>\n        <Route path=\"/invite/:token\" component={InviteAccept} />\n      </Switch>\n    );\n  }\n\n  if (!isAuthenticated) {\n    return (\n      <Switch>\n        <Route path=\"/register\" component={Register} />\n        <Route path=\"/login\" component={Login} />\n        <Route path=\"/\" component={Login} />\n      </Switch>\n    );\n  }\n\n  return (\n    <Switch>\n      <Route path=\"/\" component={user?.isSuperAdmin ? Admin : Dashboard} />\n      <Route path=\"/admin\" component={Admin} />\n      <Route path=\"/dashboard\" component={Dashboard} />\n      <Route path=\"/staff\" component={Staff} />\n      <Route path=\"/payroll\" component={Payroll} />\n      <Route path=\"/analytics\" component={Analytics} />\n      <Route path=\"/matches\" component={Matches} />\n      <Route path=\"/tournaments\" component={Tournaments} />\n      <Route path=\"/marcom\" component={Marcom} />\n      <Route path=\"/finance\" component={Finance} />\n      <Route path=\"/contracts\" component={Contracts} />\n      <Route path=\"/audit\" component={Audit} />\n      <Route path=\"/settings\" component={Settings} />\n    </Switch>\n  );\n}\n\nexport default function App() {\n  const style = {\n    \"--sidebar-width\": \"280px\",\n    \"--sidebar-width-icon\": \"80px\",\n  };\n\n  return (\n    <QueryClientProvider client={queryClient}>\n      <TooltipProvider>\n        <AuthenticatedApp style={style as React.CSSProperties} />\n        <Toaster />\n      </TooltipProvider>\n    </QueryClientProvider>\n  );\n}\n\nfunction AuthenticatedApp({ style }: { style: React.CSSProperties }) {\n  const { isAuthenticated, isLoading } = useAuth();\n\n  // Check for pending invite token after login - runs once when auth completes\n  useEffect(() => {\n    if (isAuthenticated && !isLoading) {\n      const pendingToken = sessionStorage.getItem(\"pendingInviteToken\");\n      if (pendingToken) {\n        // Redirect to invite page with token\n        window.location.href = `/invite/${pendingToken}`;\n      }\n    }\n  }, [isAuthenticated, isLoading]);\n\n  if (isLoading || !isAuthenticated) {\n    return <Router />;\n  }\n\n  return (\n    <SidebarProvider style={style}>\n      <div className=\"flex h-screen w-full\">\n        <AppSidebar />\n        <div className=\"flex flex-col flex-1 overflow-hidden\">\n          <header className=\"flex items-center justify-between p-4 border-b border-border bg-background\">\n            <SidebarTrigger data-testid=\"button-sidebar-toggle\" />\n            <div className=\"flex items-center gap-2\">\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                data-testid=\"button-logout\"\n                onClick={async () => {\n                  await fetch(\"/api/auth/logout\", { method: \"POST\" });\n                  window.location.href = \"/login\";\n                }}\n              >\n                <LogOut className=\"w-4 h-4 mr-2\" />\n                Logout\n              </Button>\n              <ThemeToggle />\n            </div>\n          </header>\n          <main className=\"flex-1 overflow-auto\">\n            <Router />\n          </main>\n        </div>\n      </div>\n    </SidebarProvider>\n  );\n}\n","size_bytes":4868},"client/src/components/audit-log-entry.tsx":{"content":"import { Avatar, AvatarFallback } from \"@/components/ui/avatar\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { formatDistanceToNow } from \"date-fns\";\n\ninterface AuditLogEntryProps {\n  id: string;\n  user: string;\n  action: string;\n  entity: string;\n  timestamp: Date;\n  oldValue?: string;\n  newValue?: string;\n  actionType: \"create\" | \"update\" | \"delete\";\n}\n\nexport function AuditLogEntry({ id, user, action, entity, timestamp, oldValue, newValue, actionType }: AuditLogEntryProps) {\n  const actionColors = {\n    create: 'bg-chart-2 text-primary-foreground',\n    update: 'bg-chart-4 text-primary-foreground',\n    delete: 'bg-chart-5 text-primary-foreground',\n  };\n\n  const initials = user.split(' ').map(n => n[0]).join('').toUpperCase();\n\n  return (\n    <div className=\"flex gap-4 p-4 rounded-lg border border-border hover-elevate\" data-testid={`log-entry-${id}`}>\n      <Avatar className=\"w-8 h-8 shrink-0\">\n        <AvatarFallback className=\"bg-primary text-primary-foreground text-xs\">{initials}</AvatarFallback>\n      </Avatar>\n      <div className=\"flex-1 min-w-0\">\n        <div className=\"flex items-start justify-between gap-2 mb-1\">\n          <div className=\"flex items-center gap-2 flex-wrap\">\n            <span className=\"font-semibold text-sm\">{user}</span>\n            <Badge className={`${actionColors[actionType]} text-xs`}>\n              {actionType.charAt(0).toUpperCase() + actionType.slice(1)}\n            </Badge>\n          </div>\n          <span className=\"text-xs text-muted-foreground shrink-0\">\n            {formatDistanceToNow(timestamp, { addSuffix: true })}\n          </span>\n        </div>\n        <p className=\"text-sm mb-2\">{action}</p>\n        <p className=\"text-xs text-muted-foreground mb-2\">Entity: <span className=\"font-mono\">{entity}</span></p>\n        {oldValue && newValue && (\n          <div className=\"grid grid-cols-2 gap-3 mt-2 p-3 rounded-md bg-card text-xs\">\n            <div>\n              <p className=\"text-muted-foreground mb-1\">Old Value:</p>\n              <p className=\"font-mono text-chart-5\">{oldValue}</p>\n            </div>\n            <div>\n              <p className=\"text-muted-foreground mb-1\">New Value:</p>\n              <p className=\"font-mono text-chart-2\">{newValue}</p>\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n","size_bytes":2321},"client/src/main.tsx":{"content":"import { createRoot } from \"react-dom/client\";\nimport App from \"./App\";\nimport \"./index.css\";\n\ncreateRoot(document.getElementById(\"root\")!).render(<App />);\n","size_bytes":157},"client/src/pages/audit.tsx":{"content":"import { AuditLogEntry } from \"@/components/audit-log-entry\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Input } from \"@/components/ui/input\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Search } from \"lucide-react\";\nimport { useState } from \"react\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport type { AuditLog } from \"@shared/schema\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\n\nexport default function Audit() {\n  const [filter, setFilter] = useState(\"all\");\n  const [searchQuery, setSearchQuery] = useState(\"\");\n\n  const { data: auditLogs = [], isLoading } = useQuery<AuditLog[]>({\n    queryKey: [\"/api/audit-logs\"],\n  });\n\n  const filteredLogs = auditLogs.filter(log => {\n    const matchesFilter = filter === \"all\" || log.actionType === filter;\n    const matchesSearch = !searchQuery || \n      log.action.toLowerCase().includes(searchQuery.toLowerCase()) ||\n      log.userName.toLowerCase().includes(searchQuery.toLowerCase()) ||\n      log.entity.toLowerCase().includes(searchQuery.toLowerCase());\n    return matchesFilter && matchesSearch;\n  });\n\n  return (\n    <div className=\"p-6 space-y-6\">\n      <div>\n        <h1 className=\"text-3xl font-heading font-bold mb-1\" data-testid=\"text-audit-title\">\n          Audit Log\n        </h1>\n        <p className=\"text-muted-foreground\">Complete history of all system actions and changes</p>\n      </div>\n\n      <div className=\"flex flex-col sm:flex-row gap-4\">\n        <div className=\"relative flex-1\">\n          <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground\" />\n          <Input\n            placeholder=\"Search audit logs...\"\n            className=\"pl-9\"\n            value={searchQuery}\n            onChange={(e) => setSearchQuery(e.target.value)}\n            data-testid=\"input-search-audit\"\n          />\n        </div>\n        <Select value={filter} onValueChange={setFilter}>\n          <SelectTrigger className=\"w-full sm:w-48\" data-testid=\"select-action-filter\">\n            <SelectValue placeholder=\"Filter by action\" />\n          </SelectTrigger>\n          <SelectContent>\n            <SelectItem value=\"all\">All Actions</SelectItem>\n            <SelectItem value=\"create\">Create</SelectItem>\n            <SelectItem value=\"update\">Update</SelectItem>\n            <SelectItem value=\"delete\">Delete</SelectItem>\n          </SelectContent>\n        </Select>\n      </div>\n\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"text-lg font-heading\">Activity History</CardTitle>\n        </CardHeader>\n        <CardContent className=\"space-y-3\">\n          {isLoading ? (\n            <div className=\"space-y-3\">\n              {[1, 2, 3, 4, 5].map((i) => (\n                <Skeleton key={i} className=\"h-20 w-full\" />\n              ))}\n            </div>\n          ) : filteredLogs.length === 0 ? (\n            <div className=\"text-center py-8 text-muted-foreground\">\n              {searchQuery || filter !== \"all\" \n                ? \"No audit logs match your filters.\" \n                : \"No audit logs yet. Actions will be tracked here.\"}\n            </div>\n          ) : (\n            filteredLogs.map((log) => (\n              <AuditLogEntry\n                key={log.id}\n                user={log.userName}\n                action={log.action}\n                entity={log.entity}\n                timestamp={new Date(log.timestamp)}\n                oldValue={log.oldValue || undefined}\n                newValue={log.newValue || undefined}\n                actionType={log.actionType as \"create\" | \"update\" | \"delete\"}\n              />\n            ))\n          )}\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":3760},"client/src/pages/analytics.tsx":{"content":"import { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Trophy, Target, TrendingUp, Users } from \"lucide-react\";\nimport { useState } from \"react\";\n\nexport default function Analytics() {\n  const [selectedRoster, setSelectedRoster] = useState(\"valorant\");\n\n  const rosters = [\n    { id: \"valorant\", name: \"Valorant\", game: \"Valorant\" },\n    { id: \"league\", name: \"League of Legends\", game: \"LoL\" },\n    { id: \"pubg\", name: \"PUBG Mobile\", game: \"PUBG\" },\n    { id: \"csgo\", name: \"Counter-Strike\", game: \"CS:GO\" },\n  ];\n\n  const analyticsData = {\n    valorant: {\n      winRate: 68,\n      totalMatches: 45,\n      wins: 31,\n      losses: 14,\n      avgPlacement: 2.3,\n      topPlayers: [\n        { name: \"Alex Rivera\", kd: 1.42, avg: 245 },\n        { name: \"Sarah Kim\", kd: 1.28, avg: 218 },\n        { name: \"Mike Torres\", kd: 1.15, avg: 197 },\n      ],\n    },\n  };\n\n  const data = analyticsData.valorant;\n\n  return (\n    <div className=\"p-6 space-y-6\">\n      <div className=\"flex items-center justify-between gap-4\">\n        <div>\n          <h1 className=\"text-3xl font-heading font-bold mb-1\" data-testid=\"text-analytics-title\">\n            Analytics Dashboard\n          </h1>\n          <p className=\"text-muted-foreground\">Track performance metrics across all rosters</p>\n        </div>\n        <Select value={selectedRoster} onValueChange={setSelectedRoster}>\n          <SelectTrigger className=\"w-64\" data-testid=\"select-roster\">\n            <SelectValue placeholder=\"Select roster\" />\n          </SelectTrigger>\n          <SelectContent>\n            {rosters.map((roster) => (\n              <SelectItem key={roster.id} value={roster.id}>\n                {roster.name}\n              </SelectItem>\n            ))}\n          </SelectContent>\n        </Select>\n      </div>\n\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium text-muted-foreground\">Win Rate</CardTitle>\n            <Trophy className=\"h-4 w-4 text-chart-2\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-3xl font-bold font-mono text-chart-2\" data-testid=\"stat-win-rate\">\n              {data.winRate}%\n            </div>\n            <p className=\"text-xs text-muted-foreground mt-1\">{data.wins}W - {data.losses}L</p>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium text-muted-foreground\">Total Matches</CardTitle>\n            <Target className=\"h-4 w-4 text-muted-foreground\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-3xl font-bold font-mono\">\n              {data.totalMatches}\n            </div>\n            <p className=\"text-xs text-muted-foreground mt-1\">This season</p>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium text-muted-foreground\">Avg Placement</CardTitle>\n            <TrendingUp className=\"h-4 w-4 text-chart-3\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-3xl font-bold font-mono text-chart-3\">\n              {data.avgPlacement}\n            </div>\n            <p className=\"text-xs text-muted-foreground mt-1\">In tournaments</p>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium text-muted-foreground\">Roster Size</CardTitle>\n            <Users className=\"h-4 w-4 text-muted-foreground\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-3xl font-bold font-mono\">\n              {data.topPlayers.length}\n            </div>\n            <p className=\"text-xs text-muted-foreground mt-1\">Active players</p>\n          </CardContent>\n        </Card>\n      </div>\n\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"text-lg font-heading\">Performance Trend</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"h-64 flex items-center justify-center bg-card rounded-lg\">\n              <div className=\"text-center\">\n                <TrendingUp className=\"w-12 h-12 mx-auto text-muted-foreground mb-3\" />\n                <p className=\"text-sm text-muted-foreground\">\n                  Interactive charts will be displayed here\n                </p>\n                <p className=\"text-xs text-muted-foreground mt-1\">\n                  Showing win/loss trends over time\n                </p>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"text-lg font-heading\">Top Performers</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"space-y-4\">\n              {data.topPlayers.map((player, idx) => (\n                <div key={player.name} className=\"flex items-center justify-between p-3 rounded-lg bg-card hover-elevate\">\n                  <div className=\"flex items-center gap-3\">\n                    <div className=\"w-8 h-8 rounded-full bg-primary flex items-center justify-center text-primary-foreground font-bold text-sm\">\n                      {idx + 1}\n                    </div>\n                    <div>\n                      <p className=\"font-semibold\">{player.name}</p>\n                      <p className=\"text-xs text-muted-foreground\">K/D: {player.kd}</p>\n                    </div>\n                  </div>\n                  <div className=\"text-right\">\n                    <p className=\"font-mono font-semibold\">{player.avg}</p>\n                    <p className=\"text-xs text-muted-foreground\">Avg ACS</p>\n                  </div>\n                </div>\n              ))}\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}\n","size_bytes":6363},"server/replitAuth.ts":{"content":"// Replit Auth integration - see blueprint:javascript_log_in_with_replit\nimport * as client from \"openid-client\";\nimport { Strategy, type VerifyFunction } from \"openid-client/passport\";\nimport passport from \"passport\";\nimport session from \"express-session\";\nimport type { Express, RequestHandler } from \"express\";\nimport memoize from \"memoizee\";\nimport connectPg from \"connect-pg-simple\";\nimport { storage } from \"./storage\";\n\nif (!process.env.REPLIT_DOMAINS) {\n  throw new Error(\"Environment variable REPLIT_DOMAINS not provided\");\n}\n\nconst getOidcConfig = memoize(\n  async () => {\n    return await client.discovery(\n      new URL(process.env.ISSUER_URL ?? \"https://replit.com/oidc\"),\n      process.env.REPL_ID!\n    );\n  },\n  { maxAge: 3600 * 1000 }\n);\n\nexport function getSession() {\n  const sessionTtl = 7 * 24 * 60 * 60 * 1000; // 1 week\n  const pgStore = connectPg(session);\n  const sessionStore = new pgStore({\n    conString: process.env.DATABASE_URL,\n    createTableIfMissing: false,\n    ttl: sessionTtl,\n    tableName: \"sessions\",\n  });\n  return session({\n    secret: process.env.SESSION_SECRET!,\n    store: sessionStore,\n    resave: false,\n    saveUninitialized: false,\n    cookie: {\n      httpOnly: true,\n      secure: true,\n      maxAge: sessionTtl,\n    },\n  });\n}\n\nfunction updateUserSession(\n  user: any,\n  tokens: client.TokenEndpointResponse & client.TokenEndpointResponseHelpers\n) {\n  user.claims = tokens.claims();\n  user.access_token = tokens.access_token;\n  user.refresh_token = tokens.refresh_token;\n  user.expires_at = user.claims?.exp;\n}\n\nasync function upsertUser(claims: any) {\n  // The upsertUser method will handle tenant creation if needed\n  await storage.upsertUser({\n    id: claims[\"sub\"],\n    email: claims[\"email\"],\n    firstName: claims[\"first_name\"],\n    lastName: claims[\"last_name\"],\n    profileImageUrl: claims[\"profile_image_url\"],\n  });\n}\n\nexport async function setupAuth(app: Express) {\n  app.set(\"trust proxy\", 1);\n  app.use(getSession());\n  app.use(passport.initialize());\n  app.use(passport.session());\n\n  const config = await getOidcConfig();\n\n  const verify: VerifyFunction = async (\n    tokens: client.TokenEndpointResponse & client.TokenEndpointResponseHelpers,\n    verified: passport.AuthenticateCallback\n  ) => {\n    const user = {};\n    updateUserSession(user, tokens);\n    await upsertUser(tokens.claims());\n    verified(null, user);\n  };\n\n  for (const domain of process.env.REPLIT_DOMAINS!.split(\",\")) {\n    const strategy = new Strategy(\n      {\n        name: `replitauth:${domain}`,\n        config,\n        scope: \"openid email profile offline_access\",\n        callbackURL: `https://${domain}/api/callback`,\n      },\n      verify\n    );\n    passport.use(strategy);\n  }\n\n  passport.serializeUser((user: Express.User, cb) => cb(null, user));\n  passport.deserializeUser((user: Express.User, cb) => cb(null, user));\n\n  app.get(\"/api/login\", (req, res, next) => {\n    passport.authenticate(`replitauth:${req.hostname}`, {\n      prompt: \"login consent\",\n      scope: [\"openid\", \"email\", \"profile\", \"offline_access\"],\n    })(req, res, next);\n  });\n\n  app.get(\"/api/callback\", (req, res, next) => {\n    passport.authenticate(`replitauth:${req.hostname}`, {\n      successReturnToOrRedirect: \"/\",\n      failureRedirect: \"/api/login\",\n    })(req, res, next);\n  });\n\n  app.get(\"/api/logout\", (req, res) => {\n    req.logout(() => {\n      res.redirect(\n        client.buildEndSessionUrl(config, {\n          client_id: process.env.REPL_ID!,\n          post_logout_redirect_uri: `${req.protocol}://${req.hostname}`,\n        }).href\n      );\n    });\n  });\n}\n\nexport const isAuthenticated: RequestHandler = async (req, res, next) => {\n  const user = req.user as any;\n\n  if (!req.isAuthenticated() || !user.expires_at) {\n    return res.status(401).json({ message: \"Unauthorized\" });\n  }\n\n  const now = Math.floor(Date.now() / 1000);\n  if (now <= user.expires_at) {\n    return next();\n  }\n\n  const refreshToken = user.refresh_token;\n  if (!refreshToken) {\n    res.status(401).json({ message: \"Unauthorized\" });\n    return;\n  }\n\n  try {\n    const config = await getOidcConfig();\n    const tokenResponse = await client.refreshTokenGrant(config, refreshToken);\n    updateUserSession(user, tokenResponse);\n    return next();\n  } catch (error) {\n    res.status(401).json({ message: \"Unauthorized\" });\n    return;\n  }\n};\n","size_bytes":4347},"client/src/components/contract-row.tsx":{"content":"import { FileText, Download, Eye } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { format, differenceInDays } from \"date-fns\";\n\ninterface ContractRowProps {\n  id: string;\n  fileName: string;\n  type: \"Player\" | \"Staff\" | \"Sponsor\";\n  linkedPerson: string;\n  expirationDate: Date;\n  status: \"active\" | \"expiring\" | \"expired\";\n}\n\nexport function ContractRow({ id, fileName, type, linkedPerson, expirationDate, status }: ContractRowProps) {\n  const daysUntilExpiration = differenceInDays(expirationDate, new Date());\n  \n  const statusColors = {\n    active: 'bg-chart-2 text-primary-foreground',\n    expiring: 'bg-chart-4 text-primary-foreground',\n    expired: 'bg-chart-5 text-primary-foreground',\n  };\n\n  const typeColors: Record<string, string> = {\n    'Player': 'bg-primary text-primary-foreground',\n    'Staff': 'bg-chart-3 text-primary-foreground',\n    'Sponsor': 'bg-accent text-accent-foreground',\n  };\n\n  return (\n    <div \n      className=\"flex items-center justify-between p-4 rounded-lg border border-border hover-elevate active-elevate-2\"\n      data-testid={`row-contract-${id}`}\n    >\n      <div className=\"flex items-center gap-4 flex-1 min-w-0\">\n        <div className=\"w-10 h-10 rounded-lg bg-card flex items-center justify-center shrink-0\">\n          <FileText className=\"w-5 h-5 text-muted-foreground\" />\n        </div>\n        <div className=\"flex-1 min-w-0\">\n          <div className=\"flex items-center gap-2 mb-1\">\n            <h4 className=\"font-semibold text-sm truncate\" data-testid={`text-filename-${id}`}>{fileName}</h4>\n            <Badge className={`${typeColors[type]} text-xs shrink-0`}>{type}</Badge>\n          </div>\n          <div className=\"flex items-center gap-3 text-xs text-muted-foreground\">\n            <span className=\"truncate\">{linkedPerson}</span>\n            <span></span>\n            <span className=\"shrink-0\">Expires: {format(expirationDate, 'MMM dd, yyyy')}</span>\n            {daysUntilExpiration > 0 && daysUntilExpiration <= 30 && (\n              <>\n                <span></span>\n                <span className=\"text-chart-4 shrink-0\">{daysUntilExpiration} days left</span>\n              </>\n            )}\n          </div>\n        </div>\n      </div>\n      <div className=\"flex items-center gap-2\">\n        <Badge className={`${statusColors[status]} text-xs`}>\n          {status.charAt(0).toUpperCase() + status.slice(1)}\n        </Badge>\n        <Button variant=\"ghost\" size=\"icon\" data-testid={`button-preview-${id}`}>\n          <Eye className=\"w-4 h-4\" />\n        </Button>\n        <Button variant=\"ghost\" size=\"icon\" data-testid={`button-download-${id}`}>\n          <Download className=\"w-4 h-4\" />\n        </Button>\n      </div>\n    </div>\n  );\n}\n","size_bytes":2786},"client/src/components/ui/context-menu.tsx":{"content":"import * as React from \"react\"\nimport * as ContextMenuPrimitive from \"@radix-ui/react-context-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ContextMenu = ContextMenuPrimitive.Root\n\nconst ContextMenuTrigger = ContextMenuPrimitive.Trigger\n\nconst ContextMenuGroup = ContextMenuPrimitive.Group\n\nconst ContextMenuPortal = ContextMenuPrimitive.Portal\n\nconst ContextMenuSub = ContextMenuPrimitive.Sub\n\nconst ContextMenuRadioGroup = ContextMenuPrimitive.RadioGroup\n\nconst ContextMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <ContextMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </ContextMenuPrimitive.SubTrigger>\n))\nContextMenuSubTrigger.displayName = ContextMenuPrimitive.SubTrigger.displayName\n\nconst ContextMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuSubContent.displayName = ContextMenuPrimitive.SubContent.displayName\n\nconst ContextMenuContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Portal>\n    <ContextMenuPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"z-50 max-h-[--radix-context-menu-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md animate-in fade-in-80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </ContextMenuPrimitive.Portal>\n))\nContextMenuContent.displayName = ContextMenuPrimitive.Content.displayName\n\nconst ContextMenuItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuItem.displayName = ContextMenuPrimitive.Item.displayName\n\nconst ContextMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <ContextMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.CheckboxItem>\n))\nContextMenuCheckboxItem.displayName =\n  ContextMenuPrimitive.CheckboxItem.displayName\n\nconst ContextMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <ContextMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.RadioItem>\n))\nContextMenuRadioItem.displayName = ContextMenuPrimitive.RadioItem.displayName\n\nconst ContextMenuLabel = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold text-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuLabel.displayName = ContextMenuPrimitive.Label.displayName\n\nconst ContextMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nContextMenuSeparator.displayName = ContextMenuPrimitive.Separator.displayName\n\nconst ContextMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nContextMenuShortcut.displayName = \"ContextMenuShortcut\"\n\nexport {\n  ContextMenu,\n  ContextMenuTrigger,\n  ContextMenuContent,\n  ContextMenuItem,\n  ContextMenuCheckboxItem,\n  ContextMenuRadioItem,\n  ContextMenuLabel,\n  ContextMenuSeparator,\n  ContextMenuShortcut,\n  ContextMenuGroup,\n  ContextMenuPortal,\n  ContextMenuSub,\n  ContextMenuSubContent,\n  ContextMenuSubTrigger,\n  ContextMenuRadioGroup,\n}\n","size_bytes":7428},"client/src/components/examples/CampaignCard.tsx":{"content":"import { CampaignCard } from \"../campaign-card\";\n\nexport default function CampaignCardExample() {\n  return (\n    <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 p-6 bg-background\">\n      <CampaignCard\n        id=\"1\"\n        title=\"VCT Championship Hype\"\n        description=\"Building excitement for our team's championship run with daily highlights and player interviews\"\n        startDate={new Date('2024-10-01')}\n        endDate={new Date('2024-10-15')}\n        platforms={['twitter', 'instagram', 'youtube']}\n        reach={125000}\n        engagement={8.5}\n        status=\"active\"\n      />\n      <CampaignCard\n        id=\"2\"\n        title=\"New Roster Announcement\"\n        description=\"Introducing our new League of Legends roster with teaser content and reveal event\"\n        startDate={new Date('2024-10-20')}\n        endDate={new Date('2024-10-22')}\n        platforms={['twitter', 'twitch']}\n        status=\"scheduled\"\n      />\n      <CampaignCard\n        id=\"3\"\n        title=\"Bootcamp Documentary\"\n        description=\"Behind-the-scenes content from our PUBG team's training bootcamp in Seoul\"\n        startDate={new Date('2024-09-15')}\n        endDate={new Date('2024-09-30')}\n        platforms={['youtube', 'tiktok', 'instagram']}\n        reach={89000}\n        engagement={12.3}\n        status=\"completed\"\n      />\n    </div>\n  );\n}\n","size_bytes":1364},"client/src/components/ui/aspect-ratio.tsx":{"content":"import * as AspectRatioPrimitive from \"@radix-ui/react-aspect-ratio\"\n\nconst AspectRatio = AspectRatioPrimitive.Root\n\nexport { AspectRatio }\n","size_bytes":140},"client/src/components/ui/slider.tsx":{"content":"import * as React from \"react\"\nimport * as SliderPrimitive from \"@radix-ui/react-slider\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Slider = React.forwardRef<\n  React.ElementRef<typeof SliderPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SliderPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <SliderPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex w-full touch-none select-none items-center\",\n      className\n    )}\n    {...props}\n  >\n    <SliderPrimitive.Track className=\"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary\">\n      <SliderPrimitive.Range className=\"absolute h-full bg-primary\" />\n    </SliderPrimitive.Track>\n    <SliderPrimitive.Thumb className=\"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50\" />\n  </SliderPrimitive.Root>\n))\nSlider.displayName = SliderPrimitive.Root.displayName\n\nexport { Slider }\n","size_bytes":1077},"client/src/components/examples/AuditLogEntry.tsx":{"content":"import { AuditLogEntry } from \"../audit-log-entry\";\n\nexport default function AuditLogEntryExample() {\n  return (\n    <div className=\"flex flex-col gap-3 p-6 bg-background\">\n      <AuditLogEntry\n        id=\"1\"\n        user=\"John Doe\"\n        action=\"Updated staff member role\"\n        entity=\"Staff #SA-4521\"\n        timestamp={new Date(Date.now() - 1000 * 60 * 15)}\n        oldValue=\"Player\"\n        newValue=\"Manager\"\n        actionType=\"update\"\n      />\n      <AuditLogEntry\n        id=\"2\"\n        user=\"Sarah Johnson\"\n        action=\"Created new payroll entry\"\n        entity=\"Payroll #PR-8833\"\n        timestamp={new Date(Date.now() - 1000 * 60 * 60 * 2)}\n        actionType=\"create\"\n      />\n      <AuditLogEntry\n        id=\"3\"\n        user=\"Mike Chen\"\n        action=\"Deleted expired contract\"\n        entity=\"Contract #CT-2291\"\n        timestamp={new Date(Date.now() - 1000 * 60 * 60 * 5)}\n        actionType=\"delete\"\n      />\n    </div>\n  );\n}\n","size_bytes":952},"client/src/components/ui/breadcrumb.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Breadcrumb = React.forwardRef<\n  HTMLElement,\n  React.ComponentPropsWithoutRef<\"nav\"> & {\n    separator?: React.ReactNode\n  }\n>(({ ...props }, ref) => <nav ref={ref} aria-label=\"breadcrumb\" {...props} />)\nBreadcrumb.displayName = \"Breadcrumb\"\n\nconst BreadcrumbList = React.forwardRef<\n  HTMLOListElement,\n  React.ComponentPropsWithoutRef<\"ol\">\n>(({ className, ...props }, ref) => (\n  <ol\n    ref={ref}\n    className={cn(\n      \"flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5\",\n      className\n    )}\n    {...props}\n  />\n))\nBreadcrumbList.displayName = \"BreadcrumbList\"\n\nconst BreadcrumbItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentPropsWithoutRef<\"li\">\n>(({ className, ...props }, ref) => (\n  <li\n    ref={ref}\n    className={cn(\"inline-flex items-center gap-1.5\", className)}\n    {...props}\n  />\n))\nBreadcrumbItem.displayName = \"BreadcrumbItem\"\n\nconst BreadcrumbLink = React.forwardRef<\n  HTMLAnchorElement,\n  React.ComponentPropsWithoutRef<\"a\"> & {\n    asChild?: boolean\n  }\n>(({ asChild, className, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      ref={ref}\n      className={cn(\"transition-colors hover:text-foreground\", className)}\n      {...props}\n    />\n  )\n})\nBreadcrumbLink.displayName = \"BreadcrumbLink\"\n\nconst BreadcrumbPage = React.forwardRef<\n  HTMLSpanElement,\n  React.ComponentPropsWithoutRef<\"span\">\n>(({ className, ...props }, ref) => (\n  <span\n    ref={ref}\n    role=\"link\"\n    aria-disabled=\"true\"\n    aria-current=\"page\"\n    className={cn(\"font-normal text-foreground\", className)}\n    {...props}\n  />\n))\nBreadcrumbPage.displayName = \"BreadcrumbPage\"\n\nconst BreadcrumbSeparator = ({\n  children,\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) => (\n  <li\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"[&>svg]:w-3.5 [&>svg]:h-3.5\", className)}\n    {...props}\n  >\n    {children ?? <ChevronRight />}\n  </li>\n)\nBreadcrumbSeparator.displayName = \"BreadcrumbSeparator\"\n\nconst BreadcrumbEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More</span>\n  </span>\n)\nBreadcrumbEllipsis.displayName = \"BreadcrumbElipssis\"\n\nexport {\n  Breadcrumb,\n  BreadcrumbList,\n  BreadcrumbItem,\n  BreadcrumbLink,\n  BreadcrumbPage,\n  BreadcrumbSeparator,\n  BreadcrumbEllipsis,\n}\n","size_bytes":2712},"client/src/components/ui/alert-dialog.tsx":{"content":"import * as React from \"react\"\nimport * as AlertDialogPrimitive from \"@radix-ui/react-alert-dialog\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nconst AlertDialog = AlertDialogPrimitive.Root\n\nconst AlertDialogTrigger = AlertDialogPrimitive.Trigger\n\nconst AlertDialogPortal = AlertDialogPrimitive.Portal\n\nconst AlertDialogOverlay = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nAlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName\n\nconst AlertDialogContent = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPortal>\n    <AlertDialogOverlay />\n    <AlertDialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    />\n  </AlertDialogPortal>\n))\nAlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName\n\nconst AlertDialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogHeader.displayName = \"AlertDialogHeader\"\n\nconst AlertDialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogFooter.displayName = \"AlertDialogFooter\"\n\nconst AlertDialogTitle = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold\", className)}\n    {...props}\n  />\n))\nAlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName\n\nconst AlertDialogDescription = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nAlertDialogDescription.displayName =\n  AlertDialogPrimitive.Description.displayName\n\nconst AlertDialogAction = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Action>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Action\n    ref={ref}\n    className={cn(buttonVariants(), className)}\n    {...props}\n  />\n))\nAlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName\n\nconst AlertDialogCancel = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Cancel>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Cancel\n    ref={ref}\n    className={cn(\n      buttonVariants({ variant: \"outline\" }),\n      \"mt-2 sm:mt-0\",\n      className\n    )}\n    {...props}\n  />\n))\nAlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName\n\nexport {\n  AlertDialog,\n  AlertDialogPortal,\n  AlertDialogOverlay,\n  AlertDialogTrigger,\n  AlertDialogContent,\n  AlertDialogHeader,\n  AlertDialogFooter,\n  AlertDialogTitle,\n  AlertDialogDescription,\n  AlertDialogAction,\n  AlertDialogCancel,\n}\n","size_bytes":4420},"client/src/components/match-card.tsx":{"content":"import { Card, CardContent } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Calendar, MapPin } from \"lucide-react\";\nimport { format } from \"date-fns\";\n\ninterface MatchCardProps {\n  id: string;\n  teamA: string;\n  teamB: string;\n  scoreA?: number;\n  scoreB?: number;\n  date: Date;\n  tournament: string | null;\n  game: string;\n  venue?: string | null;\n  status: \"upcoming\" | \"live\" | \"completed\";\n}\n\nexport function MatchCard({ id, teamA, teamB, scoreA, scoreB, date, tournament, game, venue, status }: MatchCardProps) {\n  const statusColors = {\n    upcoming: 'bg-chart-4 text-primary-foreground',\n    live: 'bg-chart-5 text-primary-foreground',\n    completed: 'bg-secondary text-secondary-foreground',\n  };\n\n  const winner = scoreA !== undefined && scoreB !== undefined ? (scoreA > scoreB ? 'A' : scoreA < scoreB ? 'B' : 'draw') : null;\n\n  return (\n    <Card className=\"hover-elevate active-elevate-2 cursor-pointer\" data-testid={`card-match-${id}`}>\n      <CardContent className=\"p-4\">\n        <div className=\"flex items-start justify-between mb-3\">\n          <div>\n            <h3 className=\"font-semibold text-sm\">{tournament || \"Standalone Match\"}</h3>\n            <p className=\"text-xs text-muted-foreground\">{game}</p>\n          </div>\n          <Badge className={`${statusColors[status]} text-xs`}>\n            {status.charAt(0).toUpperCase() + status.slice(1)}\n          </Badge>\n        </div>\n        \n        <div className=\"flex items-center justify-between py-3\">\n          <div className=\"flex-1 text-center\">\n            <p className={`font-semibold ${winner === 'A' ? 'text-chart-2' : ''}`}>{teamA}</p>\n          </div>\n          <div className=\"px-4\">\n            {status === 'completed' && scoreA !== undefined && scoreB !== undefined ? (\n              <div className=\"font-mono font-bold text-lg\">\n                <span className={winner === 'A' ? 'text-chart-2' : ''}>{scoreA}</span>\n                {' : '}\n                <span className={winner === 'B' ? 'text-chart-2' : ''}>{scoreB}</span>\n              </div>\n            ) : (\n              <span className=\"text-muted-foreground\">vs</span>\n            )}\n          </div>\n          <div className=\"flex-1 text-center\">\n            <p className={`font-semibold ${winner === 'B' ? 'text-chart-2' : ''}`}>{teamB}</p>\n          </div>\n        </div>\n\n        <div className=\"flex items-center justify-between text-xs text-muted-foreground pt-3 border-t border-border\">\n          <div className=\"flex items-center gap-1\">\n            <Calendar className=\"w-3 h-3\" />\n            <span>{format(date, 'MMM dd, HH:mm')}</span>\n          </div>\n          {venue && (\n            <div className=\"flex items-center gap-1\">\n              <MapPin className=\"w-3 h-3\" />\n              <span>{venue}</span>\n            </div>\n          )}\n        </div>\n      </CardContent>\n    </Card>\n  );\n}\n","size_bytes":2893},"client/src/components/app-sidebar.tsx":{"content":"import { Home, Users, DollarSign, BarChart3, Calendar, Trophy, Megaphone, Wallet, FileText, Shield, Settings, Crown } from \"lucide-react\";\nimport { Link, useLocation } from \"wouter\";\nimport {\n  Sidebar,\n  SidebarContent,\n  SidebarGroup,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarMenu,\n  SidebarMenuButton,\n  SidebarMenuItem,\n  SidebarHeader,\n  SidebarFooter,\n} from \"@/components/ui/sidebar\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { useAuth } from \"@/hooks/useAuth\";\n\nconst clubMenuItems = [\n  { title: \"Dashboard\", url: \"/dashboard\", icon: Home },\n  { title: \"Staff\", url: \"/staff\", icon: Users },\n  { title: \"Payroll\", url: \"/payroll\", icon: DollarSign },\n  { title: \"Analytics\", url: \"/analytics\", icon: BarChart3 },\n  { title: \"Matches\", url: \"/matches\", icon: Calendar },\n  { title: \"Tournaments\", url: \"/tournaments\", icon: Trophy },\n  { title: \"Marcom\", url: \"/marcom\", icon: Megaphone },\n  { title: \"Finance\", url: \"/finance\", icon: Wallet },\n  { title: \"Contracts\", url: \"/contracts\", icon: FileText },\n  { title: \"Audit Log\", url: \"/audit\", icon: Shield },\n  { title: \"Settings\", url: \"/settings\", icon: Settings },\n];\n\nconst adminMenuItems = [\n  { title: \"Admin Dashboard\", url: \"/admin\", icon: Crown },\n];\n\nexport function AppSidebar() {\n  const [location] = useLocation();\n  const { user } = useAuth();\n  const menuItems = user?.isSuperAdmin ? adminMenuItems : clubMenuItems;\n\n  return (\n    <Sidebar>\n      <SidebarHeader className=\"p-6\">\n        <div className=\"flex items-center gap-3\">\n          <div className=\"w-10 h-10 rounded-lg bg-primary flex items-center justify-center\">\n            <span className=\"text-primary-foreground font-heading font-bold text-xl\">N</span>\n          </div>\n          <div>\n            <h2 className=\"font-heading font-semibold text-base\">Nexus Suite</h2>\n            <p className=\"text-xs text-muted-foreground\">Esports Management</p>\n          </div>\n        </div>\n      </SidebarHeader>\n      <SidebarContent>\n        <SidebarGroup>\n          <SidebarGroupLabel>Main Menu</SidebarGroupLabel>\n          <SidebarGroupContent>\n            <SidebarMenu>\n              {menuItems.map((item) => {\n                const isActive = location === item.url;\n                return (\n                  <SidebarMenuItem key={item.title}>\n                    <SidebarMenuButton asChild isActive={isActive} data-testid={`link-${item.title.toLowerCase()}`}>\n                      <Link href={item.url}>\n                        <item.icon className=\"w-4 h-4\" />\n                        <span>{item.title}</span>\n                      </Link>\n                    </SidebarMenuButton>\n                  </SidebarMenuItem>\n                );\n              })}\n            </SidebarMenu>\n          </SidebarGroupContent>\n        </SidebarGroup>\n      </SidebarContent>\n      <SidebarFooter className=\"p-4\">\n        <div className=\"flex items-center gap-3 p-2 rounded-lg hover-elevate active-elevate-2\">\n          <Avatar className=\"w-8 h-8\">\n            <AvatarImage src={user?.profileImageUrl || undefined} />\n            <AvatarFallback className=\"bg-primary text-primary-foreground text-xs\">\n              {user?.firstName?.[0]}{user?.lastName?.[0] || user?.email?.[0].toUpperCase()}\n            </AvatarFallback>\n          </Avatar>\n          <div className=\"flex-1 min-w-0\">\n            <p className=\"text-sm font-medium truncate\">\n              {user?.firstName} {user?.lastName || user?.email}\n            </p>\n            <p className=\"text-xs text-muted-foreground truncate\">\n              {user?.isSuperAdmin ? \"Super Admin\" : user?.role}\n            </p>\n          </div>\n        </div>\n      </SidebarFooter>\n    </Sidebar>\n  );\n}\n","size_bytes":3733},"client/src/pages/matches.tsx":{"content":"import { MatchCard } from \"@/components/match-card\";\nimport { MatchDialog } from \"@/components/match-dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport { Plus, List, Calendar as CalendarIcon, Edit, Trash2, MoreHorizontal } from \"lucide-react\";\nimport { useState } from \"react\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { isUnauthorizedError } from \"@/lib/authUtils\";\nimport type { Match as MatchType } from \"@shared/schema\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuTrigger,\n} from \"@/components/ui/dropdown-menu\";\n\nexport default function Matches() {\n  const [view, setView] = useState<\"list\" | \"calendar\">(\"list\");\n  const [dialogOpen, setDialogOpen] = useState(false);\n  const [selectedMatch, setSelectedMatch] = useState<MatchType | undefined>();\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  const { data: matches = [], isLoading } = useQuery<MatchType[]>({\n    queryKey: [\"/api/matches\"],\n  });\n\n  const deleteMutation = useMutation({\n    mutationFn: async (id: string) => {\n      return await apiRequest(`/api/matches/${id}`, \"DELETE\");\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/matches\"] });\n      toast({\n        title: \"Success\",\n        description: \"Match deleted successfully\",\n      });\n    },\n    onError: (error: Error) => {\n      if (isUnauthorizedError(error)) {\n        toast({\n          title: \"Unauthorized\",\n          description: \"You are logged out. Logging in again...\",\n          variant: \"destructive\",\n        });\n        setTimeout(() => {\n          window.location.href = \"/login\";\n        }, 500);\n        return;\n      }\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to delete match\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleEdit = (match: MatchType) => {\n    setSelectedMatch(match);\n    setDialogOpen(true);\n  };\n\n  const handleAdd = () => {\n    setSelectedMatch(undefined);\n    setDialogOpen(true);\n  };\n\n  const handleDelete = async (id: string) => {\n    if (confirm(\"Are you sure you want to delete this match?\")) {\n      await deleteMutation.mutateAsync(id);\n    }\n  };\n\n  return (\n    <div className=\"p-6 space-y-6\">\n      <div className=\"flex items-center justify-between gap-4\">\n        <div>\n          <h1 className=\"text-3xl font-heading font-bold mb-1\" data-testid=\"text-matches-title\">\n            Matches & Tournaments\n          </h1>\n          <p className=\"text-muted-foreground\">Track your team's performance across all tournaments</p>\n        </div>\n        <Button onClick={handleAdd} data-testid=\"button-add-match\">\n          <Plus className=\"w-4 h-4 mr-2\" />\n          Add Match\n        </Button>\n      </div>\n\n      <Tabs value={view} onValueChange={(v) => setView(v as \"list\" | \"calendar\")}>\n        <TabsList>\n          <TabsTrigger value=\"list\" data-testid=\"tab-list-view\">\n            <List className=\"w-4 h-4 mr-2\" />\n            List View\n          </TabsTrigger>\n          <TabsTrigger value=\"calendar\" data-testid=\"tab-calendar-view\">\n            <CalendarIcon className=\"w-4 h-4 mr-2\" />\n            Calendar View\n          </TabsTrigger>\n        </TabsList>\n\n        <TabsContent value=\"list\" className=\"mt-6\">\n          {isLoading ? (\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n              {[1, 2, 3, 4, 5, 6].map((i) => (\n                <Skeleton key={i} className=\"h-48\" />\n              ))}\n            </div>\n          ) : matches.length === 0 ? (\n            <div className=\"text-center py-12 text-muted-foreground\">\n              No matches scheduled yet. Add your first match to get started.\n            </div>\n          ) : (\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n              {matches.map((match) => (\n                <div key={match.id} className=\"relative group\">\n                  <MatchCard\n                    {...match}\n                    date={new Date(match.date)}\n                    scoreA={match.scoreA ?? undefined}\n                    scoreB={match.scoreB ?? undefined}\n                    status={match.status as \"upcoming\" | \"live\" | \"completed\"}\n                  />\n                  <div className=\"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity\">\n                    <DropdownMenu>\n                      <DropdownMenuTrigger asChild>\n                        <Button variant=\"secondary\" size=\"icon\" data-testid={`button-menu-match-${match.id}`}>\n                          <MoreHorizontal className=\"h-4 w-4\" />\n                        </Button>\n                      </DropdownMenuTrigger>\n                      <DropdownMenuContent align=\"end\">\n                        <DropdownMenuItem onClick={() => handleEdit(match)} data-testid={`button-edit-match-${match.id}`}>\n                          <Edit className=\"h-4 w-4 mr-2\" />\n                          Edit\n                        </DropdownMenuItem>\n                        <DropdownMenuItem\n                          onClick={() => handleDelete(match.id)}\n                          className=\"text-destructive\"\n                          data-testid={`button-delete-match-${match.id}`}\n                        >\n                          <Trash2 className=\"h-4 w-4 mr-2\" />\n                          Delete\n                        </DropdownMenuItem>\n                      </DropdownMenuContent>\n                    </DropdownMenu>\n                  </div>\n                </div>\n              ))}\n            </div>\n          )}\n        </TabsContent>\n\n        <TabsContent value=\"calendar\" className=\"mt-6\">\n          <div className=\"bg-card border border-card-border rounded-lg p-6\">\n            <div className=\"text-center py-12\">\n              <CalendarIcon className=\"w-16 h-16 mx-auto text-muted-foreground mb-4\" />\n              <h3 className=\"text-lg font-semibold mb-2\">Calendar View</h3>\n              <p className=\"text-muted-foreground mb-4\">\n                Calendar view coming soon. Use list view to manage your matches.\n              </p>\n              <Button variant=\"outline\" onClick={() => setView(\"list\")} data-testid=\"button-switch-to-list\">\n                Switch to List View\n              </Button>\n            </div>\n          </div>\n        </TabsContent>\n      </Tabs>\n\n      <MatchDialog\n        open={dialogOpen}\n        onOpenChange={setDialogOpen}\n        match={selectedMatch}\n      />\n    </div>\n  );\n}\n","size_bytes":6771},"client/src/components/examples/StatCard.tsx":{"content":"import { StatCard } from \"../stat-card\";\nimport { DollarSign, Users, Trophy, Megaphone } from \"lucide-react\";\n\nexport default function StatCardExample() {\n  return (\n    <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 p-6 bg-background\">\n      <StatCard\n        title=\"Total Revenue\"\n        value=\"$142,500\"\n        icon={DollarSign}\n        trend={12.5}\n        trendLabel=\"vs last month\"\n      />\n      <StatCard\n        title=\"Active Rosters\"\n        value=\"6\"\n        icon={Users}\n        subtitle=\"Across 4 game titles\"\n      />\n      <StatCard\n        title=\"Win Rate\"\n        value=\"68%\"\n        icon={Trophy}\n        trend={5.2}\n        trendLabel=\"this season\"\n      />\n      <StatCard\n        title=\"Active Campaigns\"\n        value=\"12\"\n        icon={Megaphone}\n        trend={-2.1}\n        trendLabel=\"vs last month\"\n      />\n    </div>\n  );\n}\n","size_bytes":877},"client/src/pages/invite-accept.tsx":{"content":"import { useEffect, useState } from \"react\";\nimport { useParams, useLocation } from \"wouter\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { useAuth } from \"@/hooks/useAuth\";\nimport { Building2, CheckCircle, XCircle, Clock } from \"lucide-react\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport type { Invite, Tenant } from \"@shared/schema\";\n\nexport default function InviteAccept() {\n  const { token } = useParams();\n  const [, navigate] = useLocation();\n  const { isAuthenticated, user } = useAuth();\n  const [invite, setInvite] = useState<Invite | null>(null);\n  const [tenant, setTenant] = useState<Tenant | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(\"\");\n  const [accepting, setAccepting] = useState(false);\n\n  useEffect(() => {\n    if (!token) return;\n\n    // Verify invite (no auth required)\n    fetch(`/api/invites/verify/${token}`)\n      .then(res => res.json())\n      .then(async data => {\n        if (data.message) {\n          setError(data.message);\n        } else {\n          setInvite(data);\n          // Fetch tenant info\n          const tenantRes = await fetch(`/api/admin/clubs`);\n          if (tenantRes.ok) {\n            const clubs = await tenantRes.json();\n            const club = clubs.find((c: Tenant) => c.id === data.tenantId);\n            if (club) setTenant(club);\n          }\n        }\n        setLoading(false);\n      })\n      .catch(() => {\n        setError(\"Failed to load invite\");\n        setLoading(false);\n      });\n  }, [token]);\n\n  // Auto-accept if user is logged in and email matches\n  useEffect(() => {\n    if (isAuthenticated && user && invite && !error && !accepting) {\n      if (user.email?.toLowerCase() === invite.email.toLowerCase()) {\n        handleAccept();\n      } else if (user.email) {\n        setError(`This invite was sent to ${invite.email}, but you're logged in as ${user.email}`);\n      }\n    }\n  }, [isAuthenticated, user, invite, error]);\n\n  const handleAccept = async () => {\n    if (!token) return;\n    setAccepting(true);\n    try {\n      const result = await apiRequest(`/api/invites/accept/${token}`, \"POST\", {});\n      // Clear pending token from sessionStorage\n      sessionStorage.removeItem(\"pendingInviteToken\");\n      window.location.href = \"/dashboard\";\n    } catch (err: any) {\n      setError(err.message || \"Failed to accept invite\");\n      setAccepting(false);\n    }\n  };\n\n  const handleLogin = () => {\n    // Store token in sessionStorage so we can auto-accept after login\n    sessionStorage.setItem(\"pendingInviteToken\", token || \"\");\n    window.location.href = \"/login\";\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-background\">\n        <div className=\"text-center\">\n          <div className=\"inline-block h-8 w-8 animate-spin rounded-full border-4 border-solid border-primary border-r-transparent\"></div>\n          <p className=\"mt-4 text-muted-foreground\">Loading invite...</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-background p-4\">\n        <Card className=\"w-full max-w-md\">\n          <CardHeader>\n            <div className=\"flex items-center gap-3 mb-2\">\n              <div className=\"w-12 h-12 rounded-full bg-destructive/10 flex items-center justify-center\">\n                <XCircle className=\"w-6 h-6 text-destructive\" />\n              </div>\n              <div>\n                <CardTitle>Invalid Invite</CardTitle>\n                <CardDescription>{error}</CardDescription>\n              </div>\n            </div>\n          </CardHeader>\n          <CardContent>\n            <Button onClick={() => navigate(\"/\")} className=\"w-full\" data-testid=\"button-go-home\">\n              Go to Home\n            </Button>\n          </CardContent>\n        </Card>\n      </div>\n    );\n  }\n\n  if (!invite) {\n    return null;\n  }\n\n  if (accepting) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-background\">\n        <div className=\"text-center\">\n          <div className=\"inline-block h-8 w-8 animate-spin rounded-full border-4 border-solid border-primary border-r-transparent\"></div>\n          <p className=\"mt-4 text-muted-foreground\">Accepting invite...</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center bg-background p-4\">\n      <Card className=\"w-full max-w-md\">\n        <CardHeader>\n          <div className=\"flex items-center gap-3 mb-2\">\n            <div className=\"w-12 h-12 rounded-full bg-primary/10 flex items-center justify-center\">\n              <Building2 className=\"w-6 h-6 text-primary\" />\n            </div>\n            <div>\n              <CardTitle>You're Invited!</CardTitle>\n              <CardDescription>Join {tenant?.name || \"a club\"} on Nexus Suite</CardDescription>\n            </div>\n          </div>\n        </CardHeader>\n        <CardContent className=\"space-y-6\">\n          <div className=\"space-y-4\">\n            <div className=\"flex items-center justify-between p-3 rounded-lg bg-muted\">\n              <span className=\"text-sm text-muted-foreground\">Email</span>\n              <span className=\"font-medium\">{invite.email}</span>\n            </div>\n            <div className=\"flex items-center justify-between p-3 rounded-lg bg-muted\">\n              <span className=\"text-sm text-muted-foreground\">Role</span>\n              <Badge>{invite.role}</Badge>\n            </div>\n            <div className=\"flex items-center justify-between p-3 rounded-lg bg-muted\">\n              <span className=\"text-sm text-muted-foreground\">Invited by</span>\n              <span className=\"font-medium\">{invite.inviterName}</span>\n            </div>\n            <div className=\"flex items-center gap-2 p-3 rounded-lg bg-muted\">\n              <Clock className=\"w-4 h-4 text-muted-foreground\" />\n              <span className=\"text-sm text-muted-foreground\">\n                Expires: {new Date(invite.expiresAt).toLocaleDateString()}\n              </span>\n            </div>\n          </div>\n\n          {!isAuthenticated ? (\n            <div className=\"space-y-3\">\n              <p className=\"text-sm text-muted-foreground text-center\">\n                Login with the email address {invite.email} to accept this invitation\n              </p>\n              <Button onClick={handleLogin} className=\"w-full\" data-testid=\"button-login-to-accept\">\n                Login to Accept Invite\n              </Button>\n            </div>\n          ) : user?.email?.toLowerCase() === invite.email.toLowerCase() ? (\n            <div className=\"flex items-center justify-center gap-2 text-green-600\">\n              <CheckCircle className=\"w-5 h-5\" />\n              <span>Accepting invite...</span>\n            </div>\n          ) : (\n            <p className=\"text-sm text-destructive text-center\">\n              Please login with {invite.email} to accept this invite\n            </p>\n          )}\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":7206},"client/src/components/payroll-dialog.tsx":{"content":"import { useState } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { insertPayrollSchema, type InsertPayroll, type Payroll } from \"@shared/schema\";\nimport { z } from \"zod\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport {\n  Form,\n  FormControl,\n  FormField,\n  FormItem,\n  FormLabel,\n  FormMessage,\n} from \"@/components/ui/form\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport { Input } from \"@/components/ui/input\";\nimport { Button } from \"@/components/ui/button\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { isUnauthorizedError } from \"@/lib/authUtils\";\n\ninterface PayrollDialogProps {\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n  payroll?: Payroll;\n}\n\nexport function PayrollDialog({ open, onOpenChange, payroll }: PayrollDialogProps) {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [isSubmitting, setIsSubmitting] = useState(false);\n\n  const formSchema = insertPayrollSchema.omit({ tenantId: true }).extend({\n    date: insertPayrollSchema.shape.date.or(z.string().transform(val => new Date(val))),\n  });\n\n  const form = useForm({\n    resolver: zodResolver(formSchema),\n    defaultValues: {\n      staffId: payroll?.staffId || \"\",\n      name: payroll?.name || \"\",\n      role: payroll?.role || \"\",\n      amount: payroll?.amount || \"0\",\n      type: payroll?.type || \"monthly\",\n      status: payroll?.status || \"pending\",\n      date: payroll?.date ? new Date(payroll.date).toISOString().split('T')[0] : new Date().toISOString().split('T')[0],\n    },\n  });\n\n  const createMutation = useMutation({\n    mutationFn: async (data: InsertPayroll) => {\n      return await apiRequest(\"/api/payroll\", \"POST\", data);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/payroll\"] });\n      toast({\n        title: \"Success\",\n        description: \"Payroll entry added successfully\",\n      });\n      onOpenChange(false);\n      form.reset();\n    },\n    onError: (error: Error) => {\n      if (isUnauthorizedError(error)) {\n        toast({\n          title: \"Unauthorized\",\n          description: \"You are logged out. Logging in again...\",\n          variant: \"destructive\",\n        });\n        setTimeout(() => {\n          window.location.href = \"/login\";\n        }, 500);\n        return;\n      }\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to add payroll entry\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const updateMutation = useMutation({\n    mutationFn: async (data: InsertPayroll) => {\n      return await apiRequest(`/api/payroll/${payroll?.id}`, \"PATCH\", data);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/payroll\"] });\n      toast({\n        title: \"Success\",\n        description: \"Payroll entry updated successfully\",\n      });\n      onOpenChange(false);\n      form.reset();\n    },\n    onError: (error: Error) => {\n      if (isUnauthorizedError(error)) {\n        toast({\n          title: \"Unauthorized\",\n          description: \"You are logged out. Logging in again...\",\n          variant: \"destructive\",\n        });\n        setTimeout(() => {\n          window.location.href = \"/login\";\n        }, 500);\n        return;\n      }\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to update payroll entry\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const onSubmit = async (data: InsertPayroll) => {\n    setIsSubmitting(true);\n    try {\n      if (payroll) {\n        await updateMutation.mutateAsync(data);\n      } else {\n        await createMutation.mutateAsync(data);\n      }\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={onOpenChange}>\n      <DialogContent className=\"sm:max-w-[500px]\" data-testid=\"dialog-payroll\">\n        <DialogHeader>\n          <DialogTitle>{payroll ? \"Edit Payroll Entry\" : \"Add Payroll Entry\"}</DialogTitle>\n          <DialogDescription>\n            {payroll ? \"Update the payroll details below\" : \"Add a new payroll payment entry\"}\n          </DialogDescription>\n        </DialogHeader>\n\n        <Form {...form}>\n          <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\">\n            <FormField\n              control={form.control}\n              name=\"name\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Name</FormLabel>\n                  <FormControl>\n                    <Input placeholder=\"John Doe\" {...field} data-testid=\"input-payroll-name\" />\n                  </FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <FormField\n              control={form.control}\n              name=\"role\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Role</FormLabel>\n                  <FormControl>\n                    <Input placeholder=\"Player, Manager, etc.\" {...field} data-testid=\"input-payroll-role\" />\n                  </FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <div className=\"grid grid-cols-2 gap-4\">\n              <FormField\n                control={form.control}\n                name=\"amount\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Amount ($)</FormLabel>\n                    <FormControl>\n                      <Input type=\"number\" step=\"0.01\" placeholder=\"5000.00\" {...field} data-testid=\"input-payroll-amount\" />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"type\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Type</FormLabel>\n                    <Select onValueChange={field.onChange} defaultValue={field.value}>\n                      <FormControl>\n                        <SelectTrigger data-testid=\"select-payroll-type\">\n                          <SelectValue placeholder=\"Select type\" />\n                        </SelectTrigger>\n                      </FormControl>\n                      <SelectContent>\n                        <SelectItem value=\"monthly\">Monthly</SelectItem>\n                        <SelectItem value=\"weekly\">Weekly</SelectItem>\n                        <SelectItem value=\"one-time\">One-time</SelectItem>\n                      </SelectContent>\n                    </Select>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n            </div>\n\n            <div className=\"grid grid-cols-2 gap-4\">\n              <FormField\n                control={form.control}\n                name=\"status\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Status</FormLabel>\n                    <Select onValueChange={field.onChange} defaultValue={field.value}>\n                      <FormControl>\n                        <SelectTrigger data-testid=\"select-payroll-status\">\n                          <SelectValue placeholder=\"Select status\" />\n                        </SelectTrigger>\n                      </FormControl>\n                      <SelectContent>\n                        <SelectItem value=\"paid\">Paid</SelectItem>\n                        <SelectItem value=\"pending\">Pending</SelectItem>\n                      </SelectContent>\n                    </Select>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"date\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Date</FormLabel>\n                    <FormControl>\n                      <Input type=\"date\" {...field} data-testid=\"input-payroll-date\" />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n            </div>\n\n            <FormField\n              control={form.control}\n              name=\"staffId\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Staff ID (Optional)</FormLabel>\n                  <FormControl>\n                    <Input placeholder=\"Link to staff member\" {...field} data-testid=\"input-payroll-staffid\" />\n                  </FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <div className=\"flex justify-end gap-3 pt-4\">\n              <Button\n                type=\"button\"\n                variant=\"outline\"\n                onClick={() => onOpenChange(false)}\n                disabled={isSubmitting}\n                data-testid=\"button-cancel-payroll\"\n              >\n                Cancel\n              </Button>\n              <Button type=\"submit\" disabled={isSubmitting} data-testid=\"button-submit-payroll\">\n                {isSubmitting ? \"Saving...\" : payroll ? \"Update\" : \"Add\"}\n              </Button>\n            </div>\n          </form>\n        </Form>\n      </DialogContent>\n    </Dialog>\n  );\n}\n","size_bytes":9622},"client/src/pages/admin.tsx":{"content":"import { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { queryClient, apiRequest } from \"@/lib/queryClient\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Plus, Building2, Users, Trash2, Ban, CheckCircle, Download } from \"lucide-react\";\nimport { Dialog, DialogContent, DialogDescription, DialogFooter, DialogHeader, DialogTitle, DialogTrigger } from \"@/components/ui/dialog\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { Input } from \"@/components/ui/input\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { useState } from \"react\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { format } from \"date-fns\";\nimport type { Tenant, User } from \"@shared/schema\";\n\nconst clubSchema = z.object({\n  name: z.string().min(1, \"Club name is required\"),\n  clubTag: z.string().min(2, \"Club tag must be at least 2 characters\"),\n  subscriptionPlan: z.enum([\"starter\", \"growth\", \"enterprise\"]),\n  subscriptionStatus: z.enum([\"active\", \"suspended\", \"canceled\", \"trial\"]),\n});\n\nconst suspendSchema = z.object({\n  reason: z.string().min(1, \"Please provide a reason for suspension\"),\n});\n\nexport default function AdminPage() {\n  const { toast } = useToast();\n  const [isCreateDialogOpen, setIsCreateDialogOpen] = useState(false);\n  const [editingClub, setEditingClub] = useState<Tenant | null>(null);\n  const [suspendingClub, setSuspendingClub] = useState<Tenant | null>(null);\n\n  const { data: clubs = [], isLoading: loadingClubs } = useQuery<Tenant[]>({\n    queryKey: [\"/api/admin/clubs\"],\n  });\n\n  const { data: users = [], isLoading: loadingUsers } = useQuery<User[]>({\n    queryKey: [\"/api/admin/users\"],\n  });\n\n  const createClubMutation = useMutation({\n    mutationFn: async (data: z.infer<typeof clubSchema>) => {\n      return await apiRequest(\"/api/admin/clubs\", \"POST\", data);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/clubs\"] });\n      setIsCreateDialogOpen(false);\n      toast({ title: \"Success\", description: \"Club created successfully\" });\n    },\n    onError: () => {\n      toast({ title: \"Error\", description: \"Failed to create club\", variant: \"destructive\" });\n    },\n  });\n\n  const updateClubMutation = useMutation({\n    mutationFn: async ({ id, data }: { id: string; data: Partial<z.infer<typeof clubSchema>> }) => {\n      return await apiRequest(`/api/admin/clubs/${id}`, \"PATCH\", data);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/clubs\"] });\n      setEditingClub(null);\n      toast({ title: \"Success\", description: \"Club updated successfully\" });\n    },\n    onError: () => {\n      toast({ title: \"Error\", description: \"Failed to update club\", variant: \"destructive\" });\n    },\n  });\n\n  const deleteClubMutation = useMutation({\n    mutationFn: async (id: string) => {\n      return await apiRequest(`/api/admin/clubs/${id}`, \"DELETE\", {});\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/clubs\"] });\n      toast({ title: \"Success\", description: \"Club deleted successfully\" });\n    },\n    onError: () => {\n      toast({ title: \"Error\", description: \"Failed to delete club\", variant: \"destructive\" });\n    },\n  });\n\n  const suspendClubMutation = useMutation({\n    mutationFn: async ({ id, reason }: { id: string; reason: string }) => {\n      return await apiRequest(`/api/admin/clubs/${id}/suspend`, \"POST\", { reason });\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/clubs\"] });\n      setSuspendingClub(null);\n      toast({ title: \"Success\", description: \"Club suspended successfully\" });\n    },\n    onError: () => {\n      toast({ title: \"Error\", description: \"Failed to suspend club\", variant: \"destructive\" });\n    },\n  });\n\n  const reactivateClubMutation = useMutation({\n    mutationFn: async (id: string) => {\n      return await apiRequest(`/api/admin/clubs/${id}/reactivate`, \"POST\", {});\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/clubs\"] });\n      toast({ title: \"Success\", description: \"Club reactivated successfully\" });\n    },\n    onError: () => {\n      toast({ title: \"Error\", description: \"Failed to reactivate club\", variant: \"destructive\" });\n    },\n  });\n\n  const form = useForm<z.infer<typeof clubSchema>>({\n    resolver: zodResolver(clubSchema),\n    defaultValues: {\n      name: \"\",\n      clubTag: \"\",\n      subscriptionPlan: \"starter\",\n      subscriptionStatus: \"trial\",\n    },\n  });\n\n  const suspendForm = useForm<z.infer<typeof suspendSchema>>({\n    resolver: zodResolver(suspendSchema),\n    defaultValues: {\n      reason: \"\",\n    },\n  });\n\n  const onSubmit = (data: z.infer<typeof clubSchema>) => {\n    if (editingClub) {\n      updateClubMutation.mutate({ id: editingClub.id, data });\n    } else {\n      createClubMutation.mutate(data);\n    }\n  };\n\n  const handleEdit = (club: Tenant) => {\n    setEditingClub(club);\n    form.reset({\n      name: club.name,\n      clubTag: club.clubTag || \"\",\n      subscriptionPlan: (club.subscriptionPlan as any) || \"starter\",\n      subscriptionStatus: (club.subscriptionStatus as any) || \"active\",\n    });\n  };\n\n  const onSuspendSubmit = (data: z.infer<typeof suspendSchema>) => {\n    if (suspendingClub) {\n      suspendClubMutation.mutate({ id: suspendingClub.id, reason: data.reason });\n    }\n  };\n\n  const handleSuspendClick = (club: Tenant) => {\n    if (club.subscriptionStatus === \"suspended\") {\n      // Reactivate without dialog\n      reactivateClubMutation.mutate(club.id);\n    } else {\n      // Show suspension dialog\n      setSuspendingClub(club);\n      suspendForm.reset({ reason: \"\" });\n    }\n  };\n\n  const downloadDatabase = async () => {\n    try {\n      const response = await fetch(\"/api/admin/export-database\", {\n        method: \"GET\",\n        credentials: \"include\",\n      });\n\n      if (!response.ok) {\n        throw new Error(\"Failed to export database\");\n      }\n\n      const blob = await response.blob();\n      const url = window.URL.createObjectURL(blob);\n      const a = document.createElement(\"a\");\n      a.href = url;\n      a.download = `nexus-database-export-${new Date().toISOString().split('T')[0]}.json`;\n      document.body.appendChild(a);\n      a.click();\n      window.URL.revokeObjectURL(url);\n      document.body.removeChild(a);\n\n      toast({ title: \"Success\", description: \"Database exported successfully\" });\n    } catch (error) {\n      toast({ title: \"Error\", description: \"Failed to export database\", variant: \"destructive\" });\n    }\n  };\n\n  return (\n    <div className=\"p-6 space-y-6\">\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h1 className=\"text-3xl font-bold\">Super Admin Dashboard</h1>\n          <p className=\"text-muted-foreground\">Manage all clubs and users</p>\n        </div>\n        <Button onClick={downloadDatabase} variant=\"outline\" data-testid=\"button-export-database\">\n          <Download className=\"h-4 w-4 mr-2\" />\n          Export Database\n        </Button>\n      </div>\n\n      <div className=\"grid gap-4 md:grid-cols-3\">\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between gap-1 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">Total Clubs</CardTitle>\n            <Building2 className=\"h-4 w-4 text-muted-foreground\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\">{clubs.length}</div>\n          </CardContent>\n        </Card>\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between gap-1 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">Total Users</CardTitle>\n            <Users className=\"h-4 w-4 text-muted-foreground\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\">{users.length}</div>\n          </CardContent>\n        </Card>\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between gap-1 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">Active Subscriptions</CardTitle>\n            <CheckCircle className=\"h-4 w-4 text-muted-foreground\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\">\n              {clubs.filter((c) => c.subscriptionStatus === \"active\").length}\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n\n      <Card>\n        <CardHeader>\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <CardTitle>Clubs</CardTitle>\n              <CardDescription>Manage all esports clubs</CardDescription>\n            </div>\n            <Dialog open={isCreateDialogOpen || !!editingClub} onOpenChange={(open) => {\n              setIsCreateDialogOpen(open);\n              if (!open) {\n                setEditingClub(null);\n                form.reset();\n              }\n            }}>\n              <DialogTrigger asChild>\n                <Button data-testid=\"button-create-club\" onClick={() => setIsCreateDialogOpen(true)}>\n                  <Plus className=\"mr-2 h-4 w-4\" />\n                  Create Club\n                </Button>\n              </DialogTrigger>\n              <DialogContent>\n                <DialogHeader>\n                  <DialogTitle>{editingClub ? \"Edit Club\" : \"Create New Club\"}</DialogTitle>\n                  <DialogDescription>\n                    {editingClub ? \"Update club details\" : \"Add a new esports club to the platform\"}\n                  </DialogDescription>\n                </DialogHeader>\n                <Form {...form}>\n                  <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\">\n                    <FormField\n                      control={form.control}\n                      name=\"name\"\n                      render={({ field }) => (\n                        <FormItem>\n                          <FormLabel>Club Name</FormLabel>\n                          <FormControl>\n                            <Input {...field} placeholder=\"Team Liquid\" data-testid=\"input-club-name\" />\n                          </FormControl>\n                          <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n                    <FormField\n                      control={form.control}\n                      name=\"clubTag\"\n                      render={({ field }) => (\n                        <FormItem>\n                          <FormLabel>Club Tag</FormLabel>\n                          <FormControl>\n                            <Input {...field} placeholder=\"TL\" data-testid=\"input-club-tag\" />\n                          </FormControl>\n                          <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n                    <FormField\n                      control={form.control}\n                      name=\"subscriptionPlan\"\n                      render={({ field }) => (\n                        <FormItem>\n                          <FormLabel>Subscription Plan</FormLabel>\n                          <Select onValueChange={field.onChange} value={field.value}>\n                            <FormControl>\n                              <SelectTrigger data-testid=\"select-subscription-plan\">\n                                <SelectValue />\n                              </SelectTrigger>\n                            </FormControl>\n                            <SelectContent>\n                              <SelectItem value=\"starter\">Starter</SelectItem>\n                              <SelectItem value=\"growth\">Growth</SelectItem>\n                              <SelectItem value=\"enterprise\">Enterprise</SelectItem>\n                            </SelectContent>\n                          </Select>\n                          <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n                    <FormField\n                      control={form.control}\n                      name=\"subscriptionStatus\"\n                      render={({ field }) => (\n                        <FormItem>\n                          <FormLabel>Subscription Status</FormLabel>\n                          <Select onValueChange={field.onChange} value={field.value}>\n                            <FormControl>\n                              <SelectTrigger data-testid=\"select-subscription-status\">\n                                <SelectValue />\n                              </SelectTrigger>\n                            </FormControl>\n                            <SelectContent>\n                              <SelectItem value=\"trial\">Trial</SelectItem>\n                              <SelectItem value=\"active\">Active</SelectItem>\n                              <SelectItem value=\"suspended\">Suspended</SelectItem>\n                              <SelectItem value=\"canceled\">Canceled</SelectItem>\n                            </SelectContent>\n                          </Select>\n                          <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n                    <DialogFooter>\n                      <Button\n                        type=\"submit\"\n                        data-testid=\"button-submit-club\"\n                        disabled={createClubMutation.isPending || updateClubMutation.isPending}\n                      >\n                        {createClubMutation.isPending || updateClubMutation.isPending\n                          ? \"Saving...\"\n                          : editingClub\n                          ? \"Update\"\n                          : \"Create\"}\n                      </Button>\n                    </DialogFooter>\n                  </form>\n                </Form>\n              </DialogContent>\n            </Dialog>\n          </div>\n        </CardHeader>\n        <CardContent>\n          {loadingClubs ? (\n            <p className=\"text-muted-foreground\">Loading clubs...</p>\n          ) : clubs.length === 0 ? (\n            <p className=\"text-muted-foreground\">No clubs yet</p>\n          ) : (\n            <div className=\"space-y-4\">\n              {clubs.map((club) => (\n                <div\n                  key={club.id}\n                  className=\"flex items-center justify-between p-4 border rounded-lg\"\n                  data-testid={`club-item-${club.id}`}\n                >\n                  <div className=\"flex-1\">\n                    <div className=\"flex items-center gap-2\">\n                      <h3 className=\"font-semibold\">{club.name}</h3>\n                      {club.clubTag && (\n                        <Badge variant=\"outline\" className=\"font-mono\">\n                          {club.clubTag}\n                        </Badge>\n                      )}\n                    </div>\n                    <div className=\"flex items-center gap-2 mt-1\">\n                      <Badge variant={club.subscriptionStatus === \"active\" ? \"default\" : \"secondary\"}>\n                        {club.subscriptionStatus}\n                      </Badge>\n                      <Badge variant=\"outline\">{club.subscriptionPlan}</Badge>\n                      <span className=\"text-sm text-muted-foreground\">\n                        {users.filter((u) => u.tenantId === club.id).length} users\n                      </span>\n                    </div>\n                    {club.subscriptionStatus === \"suspended\" && club.suspensionReason && (\n                      <div className=\"mt-2 p-2 bg-destructive/10 border border-destructive/20 rounded text-sm\">\n                        <p className=\"text-destructive font-medium\">Suspended: {club.suspensionReason}</p>\n                        {club.suspendedAt && (\n                          <p className=\"text-muted-foreground text-xs mt-1\">\n                            Since {format(new Date(club.suspendedAt), \"PPP\")}\n                          </p>\n                        )}\n                      </div>\n                    )}\n                  </div>\n                  <div className=\"flex gap-2\">\n                    <Button\n                      variant=\"outline\"\n                      size=\"sm\"\n                      onClick={() => handleEdit(club)}\n                      data-testid={`button-edit-club-${club.id}`}\n                    >\n                      Edit\n                    </Button>\n                    <Button\n                      variant={club.subscriptionStatus === \"suspended\" ? \"default\" : \"outline\"}\n                      size=\"sm\"\n                      onClick={() => handleSuspendClick(club)}\n                      data-testid={`button-suspend-club-${club.id}`}\n                    >\n                      {club.subscriptionStatus === \"suspended\" ? (\n                        <>\n                          <CheckCircle className=\"h-4 w-4 mr-1\" />\n                          Reactivate\n                        </>\n                      ) : (\n                        <>\n                          <Ban className=\"h-4 w-4 mr-1\" />\n                          Suspend\n                        </>\n                      )}\n                    </Button>\n                    <Button\n                      variant=\"destructive\"\n                      size=\"sm\"\n                      onClick={() => {\n                        if (confirm(`Delete ${club.name}? This action cannot be undone.`)) {\n                          deleteClubMutation.mutate(club.id);\n                        }\n                      }}\n                      data-testid={`button-delete-club-${club.id}`}\n                    >\n                      <Trash2 className=\"h-4 w-4\" />\n                    </Button>\n                  </div>\n                </div>\n              ))}\n            </div>\n          )}\n        </CardContent>\n      </Card>\n\n      {/* Suspension Dialog */}\n      <Dialog open={!!suspendingClub} onOpenChange={(open) => {\n        if (!open) {\n          setSuspendingClub(null);\n          suspendForm.reset();\n        }\n      }}>\n        <DialogContent data-testid=\"dialog-suspend-club\">\n          <DialogHeader>\n            <DialogTitle>Suspend Club</DialogTitle>\n            <DialogDescription>\n              Provide a reason for suspending {suspendingClub?.name}. The club will lose access immediately.\n            </DialogDescription>\n          </DialogHeader>\n          <Form {...suspendForm}>\n            <form onSubmit={suspendForm.handleSubmit(onSuspendSubmit)} className=\"space-y-4\">\n              <FormField\n                control={suspendForm.control}\n                name=\"reason\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Suspension Reason</FormLabel>\n                    <FormControl>\n                      <Textarea\n                        {...field}\n                        placeholder=\"e.g., Payment failure, Terms violation, etc.\"\n                        rows={4}\n                        data-testid=\"input-suspension-reason\"\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n              <DialogFooter>\n                <Button\n                  type=\"button\"\n                  variant=\"outline\"\n                  onClick={() => setSuspendingClub(null)}\n                  data-testid=\"button-cancel-suspend\"\n                >\n                  Cancel\n                </Button>\n                <Button\n                  type=\"submit\"\n                  variant=\"destructive\"\n                  disabled={suspendClubMutation.isPending}\n                  data-testid=\"button-confirm-suspend\"\n                >\n                  {suspendClubMutation.isPending ? \"Suspending...\" : \"Suspend Club\"}\n                </Button>\n              </DialogFooter>\n            </form>\n          </Form>\n        </DialogContent>\n      </Dialog>\n    </div>\n  );\n}\n","size_bytes":20279},"client/src/components/contract-dialog.tsx":{"content":"import { useState } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { insertContractSchema, type InsertContract, type Contract } from \"@shared/schema\";\nimport { z } from \"zod\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport {\n  Form,\n  FormControl,\n  FormField,\n  FormItem,\n  FormLabel,\n  FormMessage,\n} from \"@/components/ui/form\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport { Input } from \"@/components/ui/input\";\nimport { Button } from \"@/components/ui/button\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { isUnauthorizedError } from \"@/lib/authUtils\";\n\ninterface ContractDialogProps {\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n  contract?: Contract;\n}\n\nexport function ContractDialog({ open, onOpenChange, contract }: ContractDialogProps) {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [isSubmitting, setIsSubmitting] = useState(false);\n\n  const formSchema = insertContractSchema.omit({ tenantId: true }).extend({\n    expirationDate: insertContractSchema.shape.expirationDate.or(z.string().transform(val => new Date(val))),\n  });\n\n  const form = useForm({\n    resolver: zodResolver(formSchema),\n    defaultValues: {\n      fileName: contract?.fileName || \"\",\n      fileUrl: contract?.fileUrl || \"\",\n      type: contract?.type || \"Player\",\n      linkedPerson: contract?.linkedPerson || \"\",\n      expirationDate: contract?.expirationDate ? new Date(contract.expirationDate).toISOString().split('T')[0] : new Date().toISOString().split('T')[0],\n      status: contract?.status || \"active\",\n    },\n  });\n\n  const createMutation = useMutation({\n    mutationFn: async (data: InsertContract) => {\n      return await apiRequest(\"/api/contracts\", \"POST\", data);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/contracts\"] });\n      toast({\n        title: \"Success\",\n        description: \"Contract added successfully\",\n      });\n      onOpenChange(false);\n      form.reset();\n    },\n    onError: (error: Error) => {\n      if (isUnauthorizedError(error)) {\n        toast({\n          title: \"Unauthorized\",\n          description: \"You are logged out. Logging in again...\",\n          variant: \"destructive\",\n        });\n        setTimeout(() => {\n          window.location.href = \"/login\";\n        }, 500);\n        return;\n      }\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to add contract\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const updateMutation = useMutation({\n    mutationFn: async (data: InsertContract) => {\n      return await apiRequest(`/api/contracts/${contract?.id}`, \"PATCH\", data);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/contracts\"] });\n      toast({\n        title: \"Success\",\n        description: \"Contract updated successfully\",\n      });\n      onOpenChange(false);\n      form.reset();\n    },\n    onError: (error: Error) => {\n      if (isUnauthorizedError(error)) {\n        toast({\n          title: \"Unauthorized\",\n          description: \"You are logged out. Logging in again...\",\n          variant: \"destructive\",\n        });\n        setTimeout(() => {\n          window.location.href = \"/login\";\n        }, 500);\n        return;\n      }\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to update contract\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const onSubmit = async (data: InsertContract) => {\n    setIsSubmitting(true);\n    try {\n      if (contract) {\n        await updateMutation.mutateAsync(data);\n      } else {\n        await createMutation.mutateAsync(data);\n      }\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={onOpenChange}>\n      <DialogContent className=\"sm:max-w-[500px]\" data-testid=\"dialog-contract\">\n        <DialogHeader>\n          <DialogTitle>{contract ? \"Edit Contract\" : \"Add Contract\"}</DialogTitle>\n          <DialogDescription>\n            {contract ? \"Update the contract details below\" : \"Add a new contract document\"}\n          </DialogDescription>\n        </DialogHeader>\n\n        <Form {...form}>\n          <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\">\n            <FormField\n              control={form.control}\n              name=\"fileName\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>File Name</FormLabel>\n                  <FormControl>\n                    <Input placeholder=\"player_contract_2024.pdf\" {...field} data-testid=\"input-contract-filename\" />\n                  </FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <FormField\n              control={form.control}\n              name=\"fileUrl\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>File URL</FormLabel>\n                  <FormControl>\n                    <Input placeholder=\"https://example.com/contracts/...\" {...field} data-testid=\"input-contract-fileurl\" />\n                  </FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <div className=\"grid grid-cols-2 gap-4\">\n              <FormField\n                control={form.control}\n                name=\"type\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Type</FormLabel>\n                    <Select onValueChange={field.onChange} defaultValue={field.value}>\n                      <FormControl>\n                        <SelectTrigger data-testid=\"select-contract-type\">\n                          <SelectValue placeholder=\"Select type\" />\n                        </SelectTrigger>\n                      </FormControl>\n                      <SelectContent>\n                        <SelectItem value=\"Player\">Player</SelectItem>\n                        <SelectItem value=\"Staff\">Staff</SelectItem>\n                        <SelectItem value=\"Sponsor\">Sponsor</SelectItem>\n                      </SelectContent>\n                    </Select>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"linkedPerson\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Linked Person</FormLabel>\n                    <FormControl>\n                      <Input placeholder=\"John Doe\" {...field} data-testid=\"input-contract-linkedperson\" />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n            </div>\n\n            <div className=\"grid grid-cols-2 gap-4\">\n              <FormField\n                control={form.control}\n                name=\"expirationDate\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Expiration Date</FormLabel>\n                    <FormControl>\n                      <Input type=\"date\" {...field} data-testid=\"input-contract-expirationdate\" />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"status\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Status</FormLabel>\n                    <Select onValueChange={field.onChange} defaultValue={field.value}>\n                      <FormControl>\n                        <SelectTrigger data-testid=\"select-contract-status\">\n                          <SelectValue placeholder=\"Select status\" />\n                        </SelectTrigger>\n                      </FormControl>\n                      <SelectContent>\n                        <SelectItem value=\"active\">Active</SelectItem>\n                        <SelectItem value=\"expiring\">Expiring Soon</SelectItem>\n                        <SelectItem value=\"expired\">Expired</SelectItem>\n                      </SelectContent>\n                    </Select>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n            </div>\n\n            <div className=\"flex justify-end gap-3 pt-4\">\n              <Button\n                type=\"button\"\n                variant=\"outline\"\n                onClick={() => onOpenChange(false)}\n                disabled={isSubmitting}\n                data-testid=\"button-cancel-contract\"\n              >\n                Cancel\n              </Button>\n              <Button type=\"submit\" disabled={isSubmitting} data-testid=\"button-submit-contract\">\n                {isSubmitting ? \"Saving...\" : contract ? \"Update\" : \"Add\"}\n              </Button>\n            </div>\n          </form>\n        </Form>\n      </DialogContent>\n    </Dialog>\n  );\n}\n","size_bytes":9328},"client/src/components/match-dialog.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { useMutation, useQueryClient, useQuery } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { insertMatchSchema, type InsertMatch, type Match, type Tournament, type TournamentRound } from \"@shared/schema\";\nimport { z } from \"zod\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport {\n  Form,\n  FormControl,\n  FormField,\n  FormItem,\n  FormLabel,\n  FormMessage,\n} from \"@/components/ui/form\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport { Input } from \"@/components/ui/input\";\nimport { Button } from \"@/components/ui/button\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { isUnauthorizedError } from \"@/lib/authUtils\";\n\ninterface MatchDialogProps {\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n  match?: Match;\n}\n\nexport function MatchDialog({ open, onOpenChange, match }: MatchDialogProps) {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [selectedTournamentId, setSelectedTournamentId] = useState<string | undefined>(match?.tournamentId || undefined);\n\n  const { data: tournaments = [] } = useQuery<Tournament[]>({\n    queryKey: [\"/api/tournaments\"],\n    enabled: open,\n  });\n\n  const { data: rounds = [] } = useQuery<TournamentRound[]>({\n    queryKey: [\"/api/tournaments\", selectedTournamentId, \"rounds\"],\n    enabled: open && !!selectedTournamentId,\n  });\n\n  const formSchema = insertMatchSchema.omit({ tenantId: true }).extend({\n    date: insertMatchSchema.shape.date.or(z.string().transform(val => new Date(val))),\n  });\n\n  const form = useForm({\n    resolver: zodResolver(formSchema),\n    defaultValues: {\n      tournamentId: match?.tournamentId || undefined,\n      roundId: match?.roundId || undefined,\n      teamA: match?.teamA || \"\",\n      teamB: match?.teamB || \"\",\n      scoreA: match?.scoreA || undefined,\n      scoreB: match?.scoreB || undefined,\n      date: match?.date ? new Date(match.date).toISOString().slice(0, 16) : new Date().toISOString().slice(0, 16),\n      tournament: match?.tournament || \"\",\n      game: match?.game || \"\",\n      venue: match?.venue || \"\",\n      status: match?.status || \"upcoming\",\n      notes: match?.notes || \"\",\n    },\n  });\n\n  useEffect(() => {\n    if (open) {\n      if (match) {\n        setSelectedTournamentId(match.tournamentId || undefined);\n        form.reset({\n          tournamentId: match.tournamentId || undefined,\n          roundId: match.roundId || undefined,\n          teamA: match.teamA || \"\",\n          teamB: match.teamB || \"\",\n          scoreA: match.scoreA || undefined,\n          scoreB: match.scoreB || undefined,\n          date: match.date ? new Date(match.date).toISOString().slice(0, 16) : new Date().toISOString().slice(0, 16),\n          tournament: match.tournament || \"\",\n          game: match.game || \"\",\n          venue: match.venue || \"\",\n          status: match.status || \"upcoming\",\n          notes: match.notes || \"\",\n        });\n      } else {\n        setSelectedTournamentId(undefined);\n        form.reset({\n          tournamentId: undefined,\n          roundId: undefined,\n          teamA: \"\",\n          teamB: \"\",\n          scoreA: undefined,\n          scoreB: undefined,\n          date: new Date().toISOString().slice(0, 16),\n          tournament: \"\",\n          game: \"\",\n          venue: \"\",\n          status: \"upcoming\",\n          notes: \"\",\n        });\n      }\n    }\n  }, [match, open, form]);\n\n  const createMutation = useMutation({\n    mutationFn: async (data: Omit<InsertMatch, \"tenantId\">) => {\n      return await apiRequest(\"/api/matches\", \"POST\", data);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/matches\"] });\n      toast({\n        title: \"Success\",\n        description: \"Match added successfully\",\n      });\n      onOpenChange(false);\n      form.reset();\n    },\n    onError: (error: Error) => {\n      if (isUnauthorizedError(error)) {\n        toast({\n          title: \"Unauthorized\",\n          description: \"You are logged out. Logging in again...\",\n          variant: \"destructive\",\n        });\n        setTimeout(() => {\n          window.location.href = \"/login\";\n        }, 500);\n        return;\n      }\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to add match\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const updateMutation = useMutation({\n    mutationFn: async (data: Omit<InsertMatch, \"tenantId\">) => {\n      return await apiRequest(`/api/matches/${match?.id}`, \"PATCH\", data);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/matches\"] });\n      toast({\n        title: \"Success\",\n        description: \"Match updated successfully\",\n      });\n      onOpenChange(false);\n      form.reset();\n    },\n    onError: (error: Error) => {\n      if (isUnauthorizedError(error)) {\n        toast({\n          title: \"Unauthorized\",\n          description: \"You are logged out. Logging in again...\",\n          variant: \"destructive\",\n        });\n        setTimeout(() => {\n          window.location.href = \"/login\";\n        }, 500);\n        return;\n      }\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to update match\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const onSubmit = async (data: any) => {\n    setIsSubmitting(true);\n    try {\n      const submitData = {\n        ...data,\n        date: new Date(data.date),\n      };\n      if (match) {\n        await updateMutation.mutateAsync(submitData);\n      } else {\n        await createMutation.mutateAsync(submitData);\n      }\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={onOpenChange}>\n      <DialogContent className=\"sm:max-w-[600px]\" data-testid=\"dialog-match\">\n        <DialogHeader>\n          <DialogTitle>{match ? \"Edit Match\" : \"Add Match\"}</DialogTitle>\n          <DialogDescription>\n            {match ? \"Update the match details below\" : \"Schedule a new match or tournament\"}\n          </DialogDescription>\n        </DialogHeader>\n\n        <Form {...form}>\n          <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\">\n            <div className=\"grid grid-cols-2 gap-4\">\n              <FormField\n                control={form.control}\n                name=\"tournamentId\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Tournament (Optional)</FormLabel>\n                    <Select \n                      onValueChange={(value) => {\n                        field.onChange(value === \"none\" ? undefined : value);\n                        setSelectedTournamentId(value === \"none\" ? undefined : value);\n                        form.setValue(\"roundId\", undefined);\n                      }} \n                      value={field.value || \"none\"}\n                    >\n                      <FormControl>\n                        <SelectTrigger data-testid=\"select-match-tournament\">\n                          <SelectValue placeholder=\"Select tournament\" />\n                        </SelectTrigger>\n                      </FormControl>\n                      <SelectContent>\n                        <SelectItem value=\"none\">None (Standalone Match)</SelectItem>\n                        {tournaments.map((tournament) => (\n                          <SelectItem key={tournament.id} value={tournament.id}>\n                            {tournament.name}\n                          </SelectItem>\n                        ))}\n                      </SelectContent>\n                    </Select>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"roundId\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Round (Optional)</FormLabel>\n                    <Select \n                      onValueChange={(value) => field.onChange(value === \"none\" ? undefined : value)}\n                      value={field.value || \"none\"}\n                      disabled={!selectedTournamentId}\n                    >\n                      <FormControl>\n                        <SelectTrigger data-testid=\"select-match-round\">\n                          <SelectValue placeholder={selectedTournamentId ? \"Select round\" : \"Select tournament first\"} />\n                        </SelectTrigger>\n                      </FormControl>\n                      <SelectContent>\n                        <SelectItem value=\"none\">None</SelectItem>\n                        {rounds.map((round) => (\n                          <SelectItem key={round.id} value={round.id}>\n                            {round.name}\n                          </SelectItem>\n                        ))}\n                      </SelectContent>\n                    </Select>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n            </div>\n\n            <div className=\"grid grid-cols-2 gap-4\">\n              <FormField\n                control={form.control}\n                name=\"teamA\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Team A</FormLabel>\n                    <FormControl>\n                      <Input placeholder=\"Nexus Valorant\" {...field} data-testid=\"input-match-teamA\" />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"teamB\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Team B</FormLabel>\n                    <FormControl>\n                      <Input placeholder=\"Opponent Team\" {...field} data-testid=\"input-match-teamB\" />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n            </div>\n\n            <div className=\"grid grid-cols-2 gap-4\">\n              <FormField\n                control={form.control}\n                name=\"scoreA\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Score A (Optional)</FormLabel>\n                    <FormControl>\n                      <Input\n                        type=\"number\"\n                        placeholder=\"2\"\n                        {...field}\n                        value={field.value ?? \"\"}\n                        onChange={(e) => field.onChange(e.target.value ? parseInt(e.target.value) : undefined)}\n                        data-testid=\"input-match-scoreA\"\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"scoreB\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Score B (Optional)</FormLabel>\n                    <FormControl>\n                      <Input\n                        type=\"number\"\n                        placeholder=\"1\"\n                        {...field}\n                        value={field.value ?? \"\"}\n                        onChange={(e) => field.onChange(e.target.value ? parseInt(e.target.value) : undefined)}\n                        data-testid=\"input-match-scoreB\"\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n            </div>\n\n            <div className=\"grid grid-cols-2 gap-4\">\n              <FormField\n                control={form.control}\n                name=\"tournament\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Tournament</FormLabel>\n                    <FormControl>\n                      <Input placeholder=\"VCT Champions\" {...field} data-testid=\"input-match-tournament\" />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"game\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Game</FormLabel>\n                    <FormControl>\n                      <Input placeholder=\"Valorant, League of Legends, etc.\" {...field} data-testid=\"input-match-game\" />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n            </div>\n\n            <div className=\"grid grid-cols-2 gap-4\">\n              <FormField\n                control={form.control}\n                name=\"date\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Date & Time</FormLabel>\n                    <FormControl>\n                      <Input type=\"datetime-local\" {...field} data-testid=\"input-match-date\" />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"status\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Status</FormLabel>\n                    <Select onValueChange={field.onChange} defaultValue={field.value}>\n                      <FormControl>\n                        <SelectTrigger data-testid=\"select-match-status\">\n                          <SelectValue placeholder=\"Select status\" />\n                        </SelectTrigger>\n                      </FormControl>\n                      <SelectContent>\n                        <SelectItem value=\"upcoming\">Upcoming</SelectItem>\n                        <SelectItem value=\"live\">Live</SelectItem>\n                        <SelectItem value=\"completed\">Completed</SelectItem>\n                      </SelectContent>\n                    </Select>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n            </div>\n\n            <FormField\n              control={form.control}\n              name=\"venue\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Venue (Optional)</FormLabel>\n                  <FormControl>\n                    <Input placeholder=\"Online, LA Studio, etc.\" {...field} data-testid=\"input-match-venue\" />\n                  </FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <FormField\n              control={form.control}\n              name=\"notes\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Notes (Optional)</FormLabel>\n                  <FormControl>\n                    <Textarea placeholder=\"Additional match details...\" {...field} data-testid=\"input-match-notes\" />\n                  </FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <div className=\"flex justify-end gap-3 pt-4\">\n              <Button\n                type=\"button\"\n                variant=\"outline\"\n                onClick={() => onOpenChange(false)}\n                disabled={isSubmitting}\n                data-testid=\"button-cancel-match\"\n              >\n                Cancel\n              </Button>\n              <Button type=\"submit\" disabled={isSubmitting} data-testid=\"button-submit-match\">\n                {isSubmitting ? \"Saving...\" : match ? \"Update\" : \"Add\"}\n              </Button>\n            </div>\n          </form>\n        </Form>\n      </DialogContent>\n    </Dialog>\n  );\n}\n","size_bytes":16283},"replit.md":{"content":"# Nexus Esports Suite\n\n## Overview\n\nNexus Esports Suite is a comprehensive multi-tenant SaaS platform designed for esports club management. It provides tools for staff roster management, payroll, match scheduling, marketing campaigns, contract administration, and analytics. The platform is subscription-based, targets multiple esports organizations, and features a dark-mode-first design with an emphasis on stability, performance, and clear data visualization. It uses a React frontend, Node.js/Express backend, PostgreSQL database, and implements role-based access control.\n\n## User Preferences\n\nPreferred communication style: Simple, everyday language.\n\n## System Architecture\n\n### Frontend Architecture\n\nThe frontend is built with **React** and **TypeScript**, using **Vite** for fast development and optimized builds, **Wouter** for routing, and **TanStack Query** for server state management. Styling is handled by **Tailwind CSS** with a custom design system. **shadcn/ui** components, based on Radix UI, are used for accessible and customizable UI, following a \"New York\" style variant and a dark-mode-first approach. Server state is managed via TanStack Query, local UI state with React hooks, and form state with React Hook Form and Zod validation.\n\n### Backend Architecture\n\nThe backend uses **Node.js** with **Express** and **TypeScript**. **Drizzle ORM** is employed for type-safe database interactions with **Neon PostgreSQL**. Authentication is handled via a **custom username/password authentication system** with session management using `express-session` and a PostgreSQL store. Passwords are securely hashed with **bcrypt**. Session cookies use httpOnly flag for XSS protection and conditional secure flag (production only) to support development environments. The system supports multi-tenancy, isolating each club's data through automatic tenant context injection and database-level filtering. RESTful APIs are designed with middleware-based authentication, consistent error handling, and automatic audit logging. Role-Based Access Control (RBAC) allows granular permissions for various roles across different modules.\n\n### Data Storage Solutions\n\n**PostgreSQL** serves as the primary data store, managed by **Drizzle ORM** for type-safe queries and schema migrations. Core entities include `sessions`, `users`, `tenants`, `staff`, `payroll`, `tournaments`, `tournamentRounds`, `matches`, `campaigns`, `contracts`, `socialAccounts`, `socialMetrics`, and `auditLogs`. **Zod schemas**, shared between frontend and backend, ensure data validation. Data operations are tenant-scoped, and a repository-like storage layer abstracts CRUD operations.\n\n### Social Media Analytics System\n\nThis system supports multi-platform social media integration (Instagram, Twitter/X, Facebook, TikTok, YouTube, Twitch) for analytics. It allows connecting multiple accounts per tenant, aggregating metrics like followers, reach, and engagement into a unified dashboard. Data is stored in `socialAccounts` (for credentials and status) and `socialMetrics` (for time-series analytics). CRUD APIs manage accounts, and an analytics endpoint provides aggregated data.\n\n**OAuth 2.0 Integration (October 2025):**\n\nThe platform now uses OAuth 2.0 authorization code flow for connecting social media accounts:\n\n**Backend Infrastructure:**\n- `server/oauth-config.ts` - Centralized OAuth configuration for all platforms\n- `getBaseUrl()` - Environment-aware redirect URI handling (production, dev, localhost)\n- `getOAuthConfig()` - Platform-specific OAuth configuration retrieval\n- State token management in session with 10-minute expiry\n- Automatic cleanup of consumed and expired state tokens\n\n**OAuth Endpoints:**\n- `GET /api/oauth/status` - Returns configuration status for all platforms\n- `POST /api/oauth/initiate/:platform` - Generates state token and authorization URL\n- `GET /api/oauth/callback/:platform` - Handles OAuth callback, exchanges code for token\n\n**Required Environment Variables per Platform:**\n- Instagram: `INSTAGRAM_CLIENT_ID`, `INSTAGRAM_CLIENT_SECRET`\n- Twitter/X: `TWITTER_CLIENT_ID`, `TWITTER_CLIENT_SECRET`\n- Facebook: `FACEBOOK_CLIENT_ID`, `FACEBOOK_CLIENT_SECRET`\n- TikTok: `TIKTOK_CLIENT_ID`, `TIKTOK_CLIENT_SECRET`\n- YouTube: `YOUTUBE_CLIENT_ID`, `YOUTUBE_CLIENT_SECRET`\n- Twitch: `TWITCH_CLIENT_ID`, `TWITCH_CLIENT_SECRET`\n\n**Security Features:**\n- Cryptographically secure state tokens using Node.js crypto\n- State tokens stored in session, not exposed to client\n- 10-minute state token expiry with automatic cleanup\n- All error paths clean up state tokens\n- Audit logging for all OAuth connections\n\n**Frontend Components:**\n- `SocialAccountOAuthDialog` - OAuth connection interface\n- Loading and error states for OAuth status fetch\n- Platform cards with configuration status badges\n- Required environment variable display for unconfigured platforms\n- Disabled connect buttons for unconfigured platforms\n- Query invalidation after successful OAuth\n\n**Flow:**\n1. User clicks \"Connect Account\"  OAuth dialog opens\n2. User selects platform  Redirects to platform authorization page\n3. User authorizes  Platform redirects back with authorization code\n4. Server exchanges code for access token  Saves to database\n5. User redirected to /marcom with success/error message\n6. Data automatically refreshes to show connected account\n\n### Finance & Transaction Management System\n\nThis system provides comprehensive tracking of income and expenses with categorization, real-time profit/loss reporting, and summary dashboards. Transactions are stored in a `transactions` table with details like type, category, amount, date, description, and payment method. CRUD APIs are available for managing transactions, with a frontend UI offering filtering, sorting, and real-time financial summaries.\n\n**Data Handling (October 2025):**\n- Amount field uses `decimal(10, 2)` type in PostgreSQL for precise monetary values\n- Frontend converts amount to string before submission to preserve decimal precision\n- Date field properly converted from date picker string to Date object\n- All CRUD operations support tenant isolation and audit logging\n\n### Tournament Management System\n\nThe tournament management system provides hierarchical organization of competitive events using a three-tier structure: **Tournaments  Rounds  Matches**. This allows clubs to organize complex multi-stage competitions with different formats (single elimination, double elimination, round robin, league, Swiss, custom).\n\n**Data Model:**\n- `tournaments` table stores top-level tournament information including name, description, format, game, dates, max teams, and status\n- `tournamentRounds` table stores intermediate stages/rounds with round numbers, formats, and dates\n- `matches` table is enhanced with `tournamentId` and `roundId` foreign keys to link matches to the hierarchy\n\n**Features:**\n- Full CRUD operations for tournaments and rounds with tenant isolation\n- Expandable UI cards showing hierarchical structure\n- Support for multiple tournament formats and status tracking (upcoming, ongoing, completed, cancelled)\n- Automatic cascade deletion (deleting a tournament removes all rounds and matches)\n- Full audit logging for all create, update, and delete operations\n- Modal dialogs for creating and editing tournaments and rounds with form validation\n\n### Tenant Suspension System\n\nThe tenant suspension system enables Super Admins to suspend and reactivate club accounts. When a tenant is suspended, all users of that tenant are immediately blocked from accessing the platform, except for Super Admins who can still manage the system.\n\n**Data Model:**\n- `tenants` table includes suspension tracking fields:\n  - `subscriptionStatus`: Can be \"active\", \"suspended\", \"canceled\", or \"trial\"\n  - `suspendedAt`: Timestamp when suspension occurred\n  - `suspensionReason`: Text description of why the tenant was suspended\n  - `suspendedBy`: User ID of the Super Admin who performed the suspension\n\n**Backend Implementation:**\n- `checkTenantSuspension` middleware runs on all protected routes after authentication\n- Checks if the user's tenant has `subscriptionStatus = \"suspended\"`\n- Returns 403 error with suspension details if tenant is suspended\n- Super Admins bypass the suspension check to maintain system access\n- Dedicated API endpoints for suspension management (Super Admin only):\n  - `POST /api/admin/clubs/:id/suspend` - Suspend a tenant with reason\n  - `POST /api/admin/clubs/:id/reactivate` - Reactivate a suspended tenant\n\n**Admin UI:**\n- Super Admin dashboard displays all tenants with their current status\n- Suspension dialog captures the reason before suspending\n- Visual indicators show suspended status with reason and timestamp\n- One-click reactivation for suspended tenants\n- Full audit logging of all suspension and reactivation actions\n\n### Custom Authentication System\n\nThe platform uses a fully custom username/password authentication system without any third-party OAuth dependencies.\n\n**Security Implementation:**\n- Password hashing using **bcrypt** (10 salt rounds)\n- Session-based authentication with PostgreSQL session store\n- Session regeneration on login/register to prevent fixation attacks\n- httpOnly cookies to prevent XSS attacks\n- Conditional secure flag (HTTPS-only in production, allows HTTP in development)\n- Session TTL: 7 days\n\n**User Registration Flow:**\n- New users provide: email, password, first name, last name, and organization name\n- System automatically creates both user account and tenant organization\n- First user of each tenant automatically receives 14-day trial subscription\n- Session is established immediately after registration\n\n**Authentication Routes:**\n- `POST /api/auth/register` - Create new account with tenant\n- `POST /api/auth/login` - Authenticate with email/password\n- `POST /api/auth/logout` - Destroy session\n- `GET /api/auth/user` - Get current authenticated user\n\n**Frontend Pages:**\n- `/login` - Login form with email and password\n- `/register` - Registration form with organization creation\n- Unauthenticated users automatically redirected to login page\n- Protected routes require valid session cookie\n\n**User Schema:**\n- Users identified by unique email (required)\n- Password stored as bcrypt hash (required)\n- Each user belongs to one tenant organization\n- Super Admin flag for platform-wide administrative access\n\n## External Dependencies\n\n### Third-Party Services\n\n-   **Neon PostgreSQL**: Serverless PostgreSQL database.\n\n### UI Component Dependencies\n\n-   **Radix UI**: Primitives for accessible UI components.\n-   **Lucide React**: Icon system.\n-   **React Icons**: For specific social media platform icons.\n-   **date-fns**: Date formatting and manipulation.\n-   **class-variance-authority**: For component variant management.\n\n### Build & Development Tools\n\n-   **Vite**: Frontend build tool.\n-   **ESBuild**: Server-side bundling.\n-   **tsx**: TypeScript execution in development.\n-   **Drizzle-kit**: Database migration tool.\n\n### Font System\n\n-   **Google Fonts**: Inter (primary UI), Space Grotesk (headings), JetBrains Mono (monospace).","size_bytes":11119},"client/src/components/campaign-dialog.tsx":{"content":"import { useState } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { insertCampaignSchema, type InsertCampaign, type Campaign } from \"@shared/schema\";\nimport { z } from \"zod\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport {\n  Form,\n  FormControl,\n  FormField,\n  FormItem,\n  FormLabel,\n  FormMessage,\n} from \"@/components/ui/form\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport { Input } from \"@/components/ui/input\";\nimport { Button } from \"@/components/ui/button\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { isUnauthorizedError } from \"@/lib/authUtils\";\n\ninterface CampaignDialogProps {\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n  campaign?: Campaign;\n}\n\nconst platformOptions = [\n  { id: \"twitter\", label: \"Twitter\" },\n  { id: \"instagram\", label: \"Instagram\" },\n  { id: \"youtube\", label: \"YouTube\" },\n  { id: \"twitch\", label: \"Twitch\" },\n  { id: \"tiktok\", label: \"TikTok\" },\n  { id: \"facebook\", label: \"Facebook\" },\n];\n\nexport function CampaignDialog({ open, onOpenChange, campaign }: CampaignDialogProps) {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [isSubmitting, setIsSubmitting] = useState(false);\n\n  const formSchema = insertCampaignSchema.omit({ tenantId: true }).extend({\n    startDate: insertCampaignSchema.shape.startDate.or(z.string().transform(val => new Date(val))),\n    endDate: insertCampaignSchema.shape.endDate.or(z.string().transform(val => new Date(val))),\n  });\n\n  const form = useForm({\n    resolver: zodResolver(formSchema),\n    defaultValues: {\n      title: campaign?.title || \"\",\n      description: campaign?.description || \"\",\n      startDate: campaign?.startDate ? new Date(campaign.startDate).toISOString().split('T')[0] : new Date().toISOString().split('T')[0],\n      endDate: campaign?.endDate ? new Date(campaign.endDate).toISOString().split('T')[0] : new Date().toISOString().split('T')[0],\n      platforms: campaign?.platforms || [],\n      reach: campaign?.reach || undefined,\n      engagement: campaign?.engagement || undefined,\n      status: campaign?.status || \"scheduled\",\n    },\n  });\n\n  const createMutation = useMutation({\n    mutationFn: async (data: InsertCampaign) => {\n      return await apiRequest(\"/api/campaigns\", \"POST\", data);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/campaigns\"] });\n      toast({\n        title: \"Success\",\n        description: \"Campaign created successfully\",\n      });\n      onOpenChange(false);\n      form.reset();\n    },\n    onError: (error: Error) => {\n      if (isUnauthorizedError(error)) {\n        toast({\n          title: \"Unauthorized\",\n          description: \"You are logged out. Logging in again...\",\n          variant: \"destructive\",\n        });\n        setTimeout(() => {\n          window.location.href = \"/login\";\n        }, 500);\n        return;\n      }\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to create campaign\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const updateMutation = useMutation({\n    mutationFn: async (data: InsertCampaign) => {\n      return await apiRequest(`/api/campaigns/${campaign?.id}`, \"PATCH\", data);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/campaigns\"] });\n      toast({\n        title: \"Success\",\n        description: \"Campaign updated successfully\",\n      });\n      onOpenChange(false);\n      form.reset();\n    },\n    onError: (error: Error) => {\n      if (isUnauthorizedError(error)) {\n        toast({\n          title: \"Unauthorized\",\n          description: \"You are logged out. Logging in again...\",\n          variant: \"destructive\",\n        });\n        setTimeout(() => {\n          window.location.href = \"/login\";\n        }, 500);\n        return;\n      }\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to update campaign\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const onSubmit = async (data: InsertCampaign) => {\n    setIsSubmitting(true);\n    try {\n      if (campaign) {\n        await updateMutation.mutateAsync(data);\n      } else {\n        await createMutation.mutateAsync(data);\n      }\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={onOpenChange}>\n      <DialogContent className=\"sm:max-w-[600px]\" data-testid=\"dialog-campaign\">\n        <DialogHeader>\n          <DialogTitle>{campaign ? \"Edit Campaign\" : \"Create Campaign\"}</DialogTitle>\n          <DialogDescription>\n            {campaign ? \"Update the campaign details below\" : \"Create a new marketing campaign\"}\n          </DialogDescription>\n        </DialogHeader>\n\n        <Form {...form}>\n          <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\">\n            <FormField\n              control={form.control}\n              name=\"title\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Title</FormLabel>\n                  <FormControl>\n                    <Input placeholder=\"VCT Championship Hype\" {...field} data-testid=\"input-campaign-title\" />\n                  </FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <FormField\n              control={form.control}\n              name=\"description\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Description</FormLabel>\n                  <FormControl>\n                    <Textarea placeholder=\"Campaign details...\" {...field} data-testid=\"input-campaign-description\" />\n                  </FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <div className=\"grid grid-cols-2 gap-4\">\n              <FormField\n                control={form.control}\n                name=\"startDate\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Start Date</FormLabel>\n                    <FormControl>\n                      <Input type=\"date\" {...field} data-testid=\"input-campaign-startdate\" />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"endDate\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>End Date</FormLabel>\n                    <FormControl>\n                      <Input type=\"date\" {...field} data-testid=\"input-campaign-enddate\" />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n            </div>\n\n            <FormField\n              control={form.control}\n              name=\"platforms\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Platforms</FormLabel>\n                  <div className=\"grid grid-cols-3 gap-3\">\n                    {platformOptions.map((platform) => (\n                      <div key={platform.id} className=\"flex items-center gap-2\">\n                        <Checkbox\n                          id={platform.id}\n                          checked={field.value?.includes(platform.id)}\n                          onCheckedChange={(checked) => {\n                            if (checked) {\n                              field.onChange([...(field.value || []), platform.id]);\n                            } else {\n                              field.onChange(field.value?.filter((p: string) => p !== platform.id) || []);\n                            }\n                          }}\n                          data-testid={`checkbox-platform-${platform.id}`}\n                        />\n                        <label htmlFor={platform.id} className=\"text-sm cursor-pointer\">\n                          {platform.label}\n                        </label>\n                      </div>\n                    ))}\n                  </div>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <div className=\"grid grid-cols-2 gap-4\">\n              <FormField\n                control={form.control}\n                name=\"reach\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Reach (Optional)</FormLabel>\n                    <FormControl>\n                      <Input\n                        type=\"number\"\n                        placeholder=\"125000\"\n                        {...field}\n                        value={field.value ?? \"\"}\n                        onChange={(e) => field.onChange(e.target.value ? parseInt(e.target.value) : undefined)}\n                        data-testid=\"input-campaign-reach\"\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"engagement\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Engagement % (Optional)</FormLabel>\n                    <FormControl>\n                      <Input\n                        type=\"number\"\n                        step=\"0.1\"\n                        placeholder=\"8.5\"\n                        {...field}\n                        value={field.value ?? \"\"}\n                        data-testid=\"input-campaign-engagement\"\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n            </div>\n\n            <FormField\n              control={form.control}\n              name=\"status\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Status</FormLabel>\n                  <Select onValueChange={field.onChange} defaultValue={field.value}>\n                    <FormControl>\n                      <SelectTrigger data-testid=\"select-campaign-status\">\n                        <SelectValue placeholder=\"Select status\" />\n                      </SelectTrigger>\n                    </FormControl>\n                    <SelectContent>\n                      <SelectItem value=\"scheduled\">Scheduled</SelectItem>\n                      <SelectItem value=\"active\">Active</SelectItem>\n                      <SelectItem value=\"completed\">Completed</SelectItem>\n                    </SelectContent>\n                  </Select>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <div className=\"flex justify-end gap-3 pt-4\">\n              <Button\n                type=\"button\"\n                variant=\"outline\"\n                onClick={() => onOpenChange(false)}\n                disabled={isSubmitting}\n                data-testid=\"button-cancel-campaign\"\n              >\n                Cancel\n              </Button>\n              <Button type=\"submit\" disabled={isSubmitting} data-testid=\"button-submit-campaign\">\n                {isSubmitting ? \"Saving...\" : campaign ? \"Update\" : \"Create\"}\n              </Button>\n            </div>\n          </form>\n        </Form>\n      </DialogContent>\n    </Dialog>\n  );\n}\n","size_bytes":11795},"client/src/components/staff-dialog.tsx":{"content":"import { useState } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { insertStaffSchema, type InsertStaff, type Staff } from \"@shared/schema\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport {\n  Form,\n  FormControl,\n  FormField,\n  FormItem,\n  FormLabel,\n  FormMessage,\n} from \"@/components/ui/form\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport { Input } from \"@/components/ui/input\";\nimport { Button } from \"@/components/ui/button\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { isUnauthorizedError } from \"@/lib/authUtils\";\n\ninterface StaffDialogProps {\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n  staff?: Staff;\n}\n\nconst modules = [\n  { id: \"Staff\", label: \"Staff Management\" },\n  { id: \"Payroll\", label: \"Payroll & Finance\" },\n  { id: \"Matches\", label: \"Match Scheduling\" },\n  { id: \"Analytics\", label: \"Analytics\" },\n  { id: \"Marcom\", label: \"Marketing\" },\n  { id: \"Contracts\", label: \"Contracts\" },\n  { id: \"Settings\", label: \"Settings\" },\n  { id: \"Audit\", label: \"Audit Logs\" },\n];\n\nexport function StaffDialog({ open, onOpenChange, staff }: StaffDialogProps) {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [isSubmitting, setIsSubmitting] = useState(false);\n\n  const form = useForm<InsertStaff>({\n    resolver: zodResolver(insertStaffSchema.omit({ tenantId: true })),\n    defaultValues: {\n      name: staff?.name || \"\",\n      email: staff?.email || \"\",\n      phone: staff?.phone || \"\",\n      role: staff?.role || \"staff\",\n      avatar: staff?.avatar || \"\",\n      permissions: staff?.permissions || [],\n      status: staff?.status || \"active\",\n    },\n  });\n\n  const createMutation = useMutation({\n    mutationFn: async (data: InsertStaff) => {\n      return await apiRequest(\"/api/staff\", \"POST\", data);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/staff\"] });\n      toast({\n        title: \"Success\",\n        description: \"Staff member added successfully\",\n      });\n      onOpenChange(false);\n      form.reset();\n    },\n    onError: (error: Error) => {\n      if (isUnauthorizedError(error)) {\n        toast({\n          title: \"Unauthorized\",\n          description: \"You are logged out. Logging in again...\",\n          variant: \"destructive\",\n        });\n        setTimeout(() => {\n          window.location.href = \"/login\";\n        }, 500);\n        return;\n      }\n      \n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to add staff member\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const updateMutation = useMutation({\n    mutationFn: async (data: InsertStaff) => {\n      return await apiRequest(`/api/staff/${staff?.id}`, \"PATCH\", data);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/staff\"] });\n      toast({\n        title: \"Success\",\n        description: \"Staff member updated successfully\",\n      });\n      onOpenChange(false);\n    },\n    onError: (error: Error) => {\n      if (isUnauthorizedError(error)) {\n        toast({\n          title: \"Unauthorized\",\n          description: \"You are logged out. Logging in again...\",\n          variant: \"destructive\",\n        });\n        setTimeout(() => {\n          window.location.href = \"/login\";\n        }, 500);\n        return;\n      }\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to update staff member\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const onSubmit = async (data: InsertStaff) => {\n    setIsSubmitting(true);\n    if (staff) {\n      await updateMutation.mutateAsync(data);\n    } else {\n      await createMutation.mutateAsync(data);\n    }\n    setIsSubmitting(false);\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={onOpenChange}>\n      <DialogContent className=\"max-w-2xl max-h-[90vh] overflow-y-auto\">\n        <DialogHeader>\n          <DialogTitle data-testid=\"text-dialog-title\">\n            {staff ? \"Edit Staff Member\" : \"Add Staff Member\"}\n          </DialogTitle>\n          <DialogDescription>\n            {staff ? \"Update staff member information and permissions\" : \"Add a new staff member to your organization\"}\n          </DialogDescription>\n        </DialogHeader>\n\n        <Form {...form}>\n          <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\">\n            <FormField\n              control={form.control}\n              name=\"name\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Name</FormLabel>\n                  <FormControl>\n                    <Input {...field} placeholder=\"John Doe\" data-testid=\"input-name\" />\n                  </FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <FormField\n              control={form.control}\n              name=\"email\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Email</FormLabel>\n                  <FormControl>\n                    <Input {...field} type=\"email\" placeholder=\"john@example.com\" data-testid=\"input-email\" />\n                  </FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <FormField\n              control={form.control}\n              name=\"phone\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Phone (Optional)</FormLabel>\n                  <FormControl>\n                    <Input {...field} value={field.value || \"\"} placeholder=\"+1 555-0123\" data-testid=\"input-phone\" />\n                  </FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <FormField\n              control={form.control}\n              name=\"role\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Role</FormLabel>\n                  <Select onValueChange={field.onChange} defaultValue={field.value}>\n                    <FormControl>\n                      <SelectTrigger data-testid=\"select-role\">\n                        <SelectValue placeholder=\"Select a role\" />\n                      </SelectTrigger>\n                    </FormControl>\n                    <SelectContent>\n                      <SelectItem value=\"owner\">Owner</SelectItem>\n                      <SelectItem value=\"admin\">Admin</SelectItem>\n                      <SelectItem value=\"manager\">Manager</SelectItem>\n                      <SelectItem value=\"staff\">Staff</SelectItem>\n                      <SelectItem value=\"player\">Player</SelectItem>\n                      <SelectItem value=\"marcom\">Marketing</SelectItem>\n                      <SelectItem value=\"analyst\">Analyst</SelectItem>\n                      <SelectItem value=\"finance\">Finance</SelectItem>\n                    </SelectContent>\n                  </Select>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <FormField\n              control={form.control}\n              name=\"status\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Status</FormLabel>\n                  <Select onValueChange={field.onChange} defaultValue={field.value}>\n                    <FormControl>\n                      <SelectTrigger data-testid=\"select-status\">\n                        <SelectValue placeholder=\"Select status\" />\n                      </SelectTrigger>\n                    </FormControl>\n                    <SelectContent>\n                      <SelectItem value=\"active\">Active</SelectItem>\n                      <SelectItem value=\"suspended\">Suspended</SelectItem>\n                    </SelectContent>\n                  </Select>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <FormField\n              control={form.control}\n              name=\"permissions\"\n              render={() => (\n                <FormItem>\n                  <div className=\"mb-4\">\n                    <FormLabel className=\"text-base\">Module Permissions</FormLabel>\n                  </div>\n                  <div className=\"grid grid-cols-2 gap-3\">\n                    {modules.map((module) => (\n                      <FormField\n                        key={module.id}\n                        control={form.control}\n                        name=\"permissions\"\n                        render={({ field }) => {\n                          return (\n                            <FormItem\n                              key={module.id}\n                              className=\"flex flex-row items-start space-x-3 space-y-0\"\n                            >\n                              <FormControl>\n                                <Checkbox\n                                  checked={field.value?.includes(module.id)}\n                                  onCheckedChange={(checked) => {\n                                    return checked\n                                      ? field.onChange([...(field.value || []), module.id])\n                                      : field.onChange(\n                                          field.value?.filter((value) => value !== module.id)\n                                        );\n                                  }}\n                                  data-testid={`checkbox-${module.id.toLowerCase()}`}\n                                />\n                              </FormControl>\n                              <FormLabel className=\"font-normal\">\n                                {module.label}\n                              </FormLabel>\n                            </FormItem>\n                          );\n                        }}\n                      />\n                    ))}\n                  </div>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <div className=\"flex justify-end gap-3 pt-4\">\n              <Button\n                type=\"button\"\n                variant=\"outline\"\n                onClick={() => onOpenChange(false)}\n                data-testid=\"button-cancel\"\n              >\n                Cancel\n              </Button>\n              <Button type=\"submit\" disabled={isSubmitting} data-testid=\"button-submit\">\n                {isSubmitting ? \"Saving...\" : staff ? \"Update Staff\" : \"Add Staff\"}\n              </Button>\n            </div>\n          </form>\n        </Form>\n      </DialogContent>\n    </Dialog>\n  );\n}\n","size_bytes":10890},"client/src/components/social-account-dialog.tsx":{"content":"import { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription } from \"@/components/ui/dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { isUnauthorizedError } from \"@/lib/authUtils\";\nimport type { SocialAccount } from \"@shared/schema\";\n\nconst socialAccountSchema = z.object({\n  platform: z.string().min(1, \"Platform is required\"),\n  accountName: z.string().min(1, \"Account name is required\"),\n  accountId: z.string().optional(),\n  apiKey: z.string().optional(),\n  apiSecret: z.string().optional(),\n});\n\ntype SocialAccountFormData = z.infer<typeof socialAccountSchema>;\n\ninterface SocialAccountDialogProps {\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n  account?: SocialAccount;\n}\n\nexport function SocialAccountDialog({ open, onOpenChange, account }: SocialAccountDialogProps) {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  \n  const form = useForm<SocialAccountFormData>({\n    resolver: zodResolver(socialAccountSchema),\n    defaultValues: {\n      platform: account?.platform || \"\",\n      accountName: account?.accountName || \"\",\n      accountId: account?.accountId || \"\",\n      apiKey: \"\",\n      apiSecret: \"\",\n    },\n  });\n\n  const mutation = useMutation({\n    mutationFn: async (data: SocialAccountFormData) => {\n      // Remove empty credential fields to preserve existing values when editing\n      const payload = { ...data };\n      if (!payload.apiKey || payload.apiKey.trim() === \"\") {\n        delete payload.apiKey;\n      }\n      if (!payload.apiSecret || payload.apiSecret.trim() === \"\") {\n        delete payload.apiSecret;\n      }\n      if (!payload.accountId || payload.accountId.trim() === \"\") {\n        delete payload.accountId;\n      }\n      \n      if (account) {\n        return await apiRequest(`/api/social/accounts/${account.id}`, \"PATCH\", payload);\n      } else {\n        return await apiRequest(\"/api/social/accounts\", \"POST\", payload);\n      }\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/social/accounts\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/social/analytics\"] });\n      toast({\n        title: \"Success\",\n        description: account ? \"Social account updated\" : \"Social account connected\",\n      });\n      onOpenChange(false);\n      form.reset();\n    },\n    onError: (error: Error) => {\n      if (isUnauthorizedError(error)) {\n        toast({\n          title: \"Unauthorized\",\n          description: \"You are logged out. Logging in again...\",\n          variant: \"destructive\",\n        });\n        setTimeout(() => {\n          window.location.href = \"/login\";\n        }, 500);\n        return;\n      }\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to connect social account\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const onSubmit = (data: SocialAccountFormData) => {\n    mutation.mutate(data);\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={onOpenChange}>\n      <DialogContent data-testid=\"dialog-social-account\">\n        <DialogHeader>\n          <DialogTitle>{account ? \"Update Social Account\" : \"Connect Social Account\"}</DialogTitle>\n          <DialogDescription>\n            {account ? \"Update your social media account settings\" : \"Connect a social media account to track analytics\"}\n          </DialogDescription>\n        </DialogHeader>\n        \n        <Form {...form}>\n          <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\">\n            <FormField\n              control={form.control}\n              name=\"platform\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Platform</FormLabel>\n                  <Select onValueChange={field.onChange} defaultValue={field.value}>\n                    <FormControl>\n                      <SelectTrigger data-testid=\"select-platform\">\n                        <SelectValue placeholder=\"Select platform\" />\n                      </SelectTrigger>\n                    </FormControl>\n                    <SelectContent>\n                      <SelectItem value=\"instagram\">Instagram</SelectItem>\n                      <SelectItem value=\"twitter\">Twitter / X</SelectItem>\n                      <SelectItem value=\"facebook\">Facebook</SelectItem>\n                      <SelectItem value=\"tiktok\">TikTok</SelectItem>\n                      <SelectItem value=\"youtube\">YouTube</SelectItem>\n                      <SelectItem value=\"twitch\">Twitch</SelectItem>\n                    </SelectContent>\n                  </Select>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <FormField\n              control={form.control}\n              name=\"accountName\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Account Name / Handle</FormLabel>\n                  <FormControl>\n                    <Input {...field} placeholder=\"@yourhandle\" data-testid=\"input-account-name\" />\n                  </FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <FormField\n              control={form.control}\n              name=\"accountId\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Account ID (Optional)</FormLabel>\n                  <FormControl>\n                    <Input {...field} placeholder=\"Platform-specific account ID\" data-testid=\"input-account-id\" />\n                  </FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <div className=\"pt-2 flex justify-end gap-2\">\n              <Button \n                type=\"button\" \n                variant=\"outline\" \n                onClick={() => onOpenChange(false)}\n                data-testid=\"button-cancel\"\n              >\n                Cancel\n              </Button>\n              <Button \n                type=\"submit\" \n                disabled={mutation.isPending}\n                data-testid=\"button-save-account\"\n              >\n                {mutation.isPending ? \"Saving...\" : account ? \"Update\" : \"Connect\"}\n              </Button>\n            </div>\n          </form>\n        </Form>\n      </DialogContent>\n    </Dialog>\n  );\n}\n","size_bytes":6882},"client/src/components/round-dialog.tsx":{"content":"import { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { insertTournamentRoundSchema, type InsertTournamentRound, type TournamentRound } from \"@shared/schema\";\nimport { useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { isUnauthorizedError } from \"@/lib/authUtils\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport {\n  Form,\n  FormControl,\n  FormField,\n  FormItem,\n  FormLabel,\n  FormMessage,\n} from \"@/components/ui/form\";\nimport { Input } from \"@/components/ui/input\";\nimport { Button } from \"@/components/ui/button\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport { format } from \"date-fns\";\n\ninterface RoundDialogProps {\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n  tournamentId: string;\n  round?: TournamentRound;\n}\n\nconst roundSchema = insertTournamentRoundSchema.omit({ tournamentId: true }).extend({\n  startDate: z.string().optional(),\n});\n\ntype RoundFormData = z.infer<typeof roundSchema>;\n\nexport function RoundDialog({ open, onOpenChange, tournamentId, round }: RoundDialogProps) {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const isEdit = !!round;\n\n  const form = useForm<RoundFormData>({\n    resolver: zodResolver(roundSchema),\n    defaultValues: round\n      ? {\n          name: round.name,\n          roundNumber: round.roundNumber,\n          format: round.format || \"\",\n          startDate: round.startDate ? format(new Date(round.startDate), \"yyyy-MM-dd\") : \"\",\n          status: round.status,\n        }\n      : {\n          name: \"\",\n          roundNumber: 1,\n          format: \"\",\n          startDate: \"\",\n          status: \"upcoming\",\n        },\n  });\n\n  const mutation = useMutation({\n    mutationFn: async (data: InsertTournamentRound) => {\n      if (isEdit) {\n        return await apiRequest(`/api/rounds/${round.id}`, \"PATCH\", { ...data, tournamentId });\n      }\n      return await apiRequest(`/api/tournaments/${tournamentId}/rounds`, \"POST\", data);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/tournaments\", tournamentId, \"rounds\"] });\n      toast({\n        title: \"Success\",\n        description: `Round ${isEdit ? \"updated\" : \"created\"} successfully`,\n      });\n      onOpenChange(false);\n      form.reset();\n    },\n    onError: (error: Error) => {\n      if (isUnauthorizedError(error)) {\n        toast({\n          title: \"Unauthorized\",\n          description: \"You are logged out. Logging in again...\",\n          variant: \"destructive\",\n        });\n        setTimeout(() => {\n          window.location.href = \"/login\";\n        }, 500);\n        return;\n      }\n      toast({\n        title: \"Error\",\n        description: error.message || `Failed to ${isEdit ? \"update\" : \"create\"} round`,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const onSubmit = (data: RoundFormData) => {\n    const roundData: any = {\n      ...data,\n      startDate: data.startDate ? new Date(data.startDate) : undefined,\n    };\n    mutation.mutate(roundData);\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={onOpenChange}>\n      <DialogContent>\n        <DialogHeader>\n          <DialogTitle>{isEdit ? \"Edit Round\" : \"Create Round\"}</DialogTitle>\n          <DialogDescription>\n            {isEdit ? \"Update round details\" : \"Add a new round or stage to this tournament\"}\n          </DialogDescription>\n        </DialogHeader>\n        <Form {...form}>\n          <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\">\n            <FormField\n              control={form.control}\n              name=\"name\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Round Name</FormLabel>\n                  <FormControl>\n                    <Input placeholder=\"Quarterfinals\" {...field} data-testid=\"input-round-name\" />\n                  </FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <div className=\"grid grid-cols-2 gap-4\">\n              <FormField\n                control={form.control}\n                name=\"roundNumber\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Round Number</FormLabel>\n                    <FormControl>\n                      <Input\n                        type=\"number\"\n                        placeholder=\"1\"\n                        {...field}\n                        onChange={(e) => field.onChange(parseInt(e.target.value))}\n                        data-testid=\"input-round-number\"\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"format\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Format (Optional)</FormLabel>\n                    <FormControl>\n                      <Input placeholder=\"Best of 3\" {...field} value={field.value || \"\"} data-testid=\"input-round-format\" />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n            </div>\n\n            <div className=\"grid grid-cols-2 gap-4\">\n              <FormField\n                control={form.control}\n                name=\"startDate\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Start Date (Optional)</FormLabel>\n                    <FormControl>\n                      <Input type=\"date\" {...field} data-testid=\"input-round-start-date\" />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"status\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Status</FormLabel>\n                    <Select onValueChange={field.onChange} defaultValue={field.value || undefined}>\n                      <FormControl>\n                        <SelectTrigger data-testid=\"select-round-status\">\n                          <SelectValue placeholder=\"Select status\" />\n                        </SelectTrigger>\n                      </FormControl>\n                      <SelectContent>\n                        <SelectItem value=\"upcoming\">Upcoming</SelectItem>\n                        <SelectItem value=\"ongoing\">Ongoing</SelectItem>\n                        <SelectItem value=\"completed\">Completed</SelectItem>\n                      </SelectContent>\n                    </Select>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n            </div>\n\n            <div className=\"flex justify-end gap-2 pt-4\">\n              <Button\n                type=\"button\"\n                variant=\"outline\"\n                onClick={() => onOpenChange(false)}\n                data-testid=\"button-cancel-round\"\n              >\n                Cancel\n              </Button>\n              <Button type=\"submit\" disabled={mutation.isPending} data-testid=\"button-save-round\">\n                {mutation.isPending ? \"Saving...\" : isEdit ? \"Update\" : \"Create\"}\n              </Button>\n            </div>\n          </form>\n        </Form>\n      </DialogContent>\n    </Dialog>\n  );\n}\n","size_bytes":7720},"client/src/pages/tournaments.tsx":{"content":"import { Button } from \"@/components/ui/button\";\nimport { Plus, Trophy, ChevronRight, ChevronDown, MoreHorizontal, Calendar, Users, Target } from \"lucide-react\";\nimport { useState } from \"react\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { isUnauthorizedError } from \"@/lib/authUtils\";\nimport type { Tournament, TournamentRound, Match } from \"@shared/schema\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuTrigger,\n} from \"@/components/ui/dropdown-menu\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { format } from \"date-fns\";\nimport { cn } from \"@/lib/utils\";\nimport { TournamentDialog } from \"@/components/tournament-dialog\";\nimport { RoundDialog } from \"@/components/round-dialog\";\n\nconst formatStatusBadge = (status: string) => {\n  const statusColors = {\n    upcoming: \"bg-blue-500/10 text-blue-500 border-blue-500/20\",\n    ongoing: \"bg-green-500/10 text-green-500 border-green-500/20\",\n    completed: \"bg-gray-500/10 text-gray-500 border-gray-500/20\",\n    cancelled: \"bg-red-500/10 text-red-500 border-red-500/20\",\n  };\n  return statusColors[status as keyof typeof statusColors] || statusColors.upcoming;\n};\n\nconst formatFormatBadge = (formatType: string) => {\n  const formatColors = {\n    \"single-elimination\": \"bg-purple-500/10 text-purple-500 border-purple-500/20\",\n    \"double-elimination\": \"bg-indigo-500/10 text-indigo-500 border-indigo-500/20\",\n    \"round-robin\": \"bg-cyan-500/10 text-cyan-500 border-cyan-500/20\",\n    league: \"bg-teal-500/10 text-teal-500 border-teal-500/20\",\n    swiss: \"bg-orange-500/10 text-orange-500 border-orange-500/20\",\n    custom: \"bg-pink-500/10 text-pink-500 border-pink-500/20\",\n  };\n  return formatColors[formatType as keyof typeof formatColors] || formatColors.custom;\n};\n\nfunction TournamentCard({ tournament, onEdit, onAddRound, onEditRound }: { \n  tournament: Tournament; \n  onEdit: (tournament: Tournament) => void;\n  onAddRound: (tournamentId: string) => void;\n  onEditRound: (round: TournamentRound) => void;\n}) {\n  const [isExpanded, setIsExpanded] = useState(false);\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  const { data: rounds = [], isLoading: loadingRounds } = useQuery<TournamentRound[]>({\n    queryKey: [\"/api/tournaments\", tournament.id, \"rounds\"],\n    enabled: isExpanded,\n  });\n\n  const deleteTournamentMutation = useMutation({\n    mutationFn: async (id: string) => {\n      return await apiRequest(`/api/tournaments/${id}`, \"DELETE\");\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/tournaments\"] });\n      toast({\n        title: \"Success\",\n        description: \"Tournament deleted successfully\",\n      });\n    },\n    onError: (error: Error) => {\n      if (isUnauthorizedError(error)) {\n        toast({\n          title: \"Unauthorized\",\n          description: \"You are logged out. Logging in again...\",\n          variant: \"destructive\",\n        });\n        setTimeout(() => {\n          window.location.href = \"/login\";\n        }, 500);\n        return;\n      }\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to delete tournament\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleDelete = async (id: string) => {\n    if (confirm(\"Are you sure? This will delete the tournament and all its rounds and matches.\")) {\n      await deleteTournamentMutation.mutateAsync(id);\n    }\n  };\n\n  return (\n    <Card className=\"overflow-hidden\">\n      <CardHeader className=\"flex flex-row items-start justify-between gap-2 space-y-0 pb-3\">\n        <div className=\"flex-1 min-w-0\">\n          <div className=\"flex items-center gap-2 mb-2\">\n            <Button\n              variant=\"ghost\"\n              size=\"icon\"\n              className=\"h-6 w-6\"\n              onClick={() => setIsExpanded(!isExpanded)}\n              data-testid={`button-toggle-tournament-${tournament.id}`}\n            >\n              {isExpanded ? <ChevronDown className=\"h-4 w-4\" /> : <ChevronRight className=\"h-4 w-4\" />}\n            </Button>\n            <Trophy className=\"h-5 w-5 text-primary\" />\n            <CardTitle className=\"text-lg truncate\" data-testid={`text-tournament-name-${tournament.id}`}>\n              {tournament.name}\n            </CardTitle>\n          </div>\n          {tournament.description && (\n            <p className=\"text-sm text-muted-foreground truncate ml-14\">{tournament.description}</p>\n          )}\n        </div>\n        <DropdownMenu>\n          <DropdownMenuTrigger asChild>\n            <Button variant=\"ghost\" size=\"icon\" className=\"h-8 w-8\" data-testid={`button-tournament-menu-${tournament.id}`}>\n              <MoreHorizontal className=\"h-4 w-4\" />\n            </Button>\n          </DropdownMenuTrigger>\n          <DropdownMenuContent align=\"end\">\n            <DropdownMenuItem \n              onClick={() => onEdit(tournament)}\n              data-testid={`button-edit-tournament-${tournament.id}`}\n            >\n              Edit Tournament\n            </DropdownMenuItem>\n            <DropdownMenuItem \n              onClick={() => onAddRound(tournament.id)}\n              data-testid={`button-add-round-${tournament.id}`}\n            >\n              Add Round\n            </DropdownMenuItem>\n            <DropdownMenuItem \n              className=\"text-destructive\" \n              onClick={() => handleDelete(tournament.id)}\n              data-testid={`button-delete-tournament-${tournament.id}`}\n            >\n              Delete Tournament\n            </DropdownMenuItem>\n          </DropdownMenuContent>\n        </DropdownMenu>\n      </CardHeader>\n      <CardContent className=\"space-y-3\">\n        <div className=\"flex flex-wrap items-center gap-2 text-sm\">\n          <Badge variant=\"outline\" className={cn(\"border\", formatStatusBadge(tournament.status))}>\n            {tournament.status}\n          </Badge>\n          <Badge variant=\"outline\" className={cn(\"border\", formatFormatBadge(tournament.format))}>\n            {tournament.format.replace(\"-\", \" \")}\n          </Badge>\n          {tournament.game && (\n            <Badge variant=\"outline\">\n              <Target className=\"h-3 w-3 mr-1\" />\n              {tournament.game}\n            </Badge>\n          )}\n        </div>\n        \n        <div className=\"flex flex-wrap items-center gap-4 text-sm text-muted-foreground\">\n          <div className=\"flex items-center gap-1\">\n            <Calendar className=\"h-4 w-4\" />\n            <span>{format(new Date(tournament.startDate), \"MMM d, yyyy\")}</span>\n          </div>\n          {tournament.endDate && (\n            <div className=\"flex items-center gap-1\">\n              <span>-</span>\n              <span>{format(new Date(tournament.endDate), \"MMM d, yyyy\")}</span>\n            </div>\n          )}\n          {tournament.maxTeams && (\n            <div className=\"flex items-center gap-1\">\n              <Users className=\"h-4 w-4\" />\n              <span>Max {tournament.maxTeams} teams</span>\n            </div>\n          )}\n        </div>\n\n        {isExpanded && (\n          <div className=\"mt-4 space-y-2 border-t pt-4\">\n            {loadingRounds ? (\n              <div className=\"space-y-2\">\n                <Skeleton className=\"h-16\" />\n                <Skeleton className=\"h-16\" />\n              </div>\n            ) : rounds.length === 0 ? (\n              <div className=\"text-center py-4 text-sm text-muted-foreground\">\n                No rounds added yet\n              </div>\n            ) : (\n              rounds.map((round) => (\n                <RoundItem \n                  key={round.id} \n                  round={round} \n                  tournamentId={tournament.id}\n                  onEdit={onEditRound}\n                />\n              ))\n            )}\n          </div>\n        )}\n      </CardContent>\n    </Card>\n  );\n}\n\nfunction RoundItem({ round, tournamentId, onEdit }: { \n  round: TournamentRound; \n  tournamentId: string;\n  onEdit: (round: TournamentRound) => void;\n}) {\n  const [isExpanded, setIsExpanded] = useState(false);\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  const { data: matches = [], isLoading: loadingMatches } = useQuery<Match[]>({\n    queryKey: [\"/api/rounds\", round.id, \"matches\"],\n    enabled: isExpanded,\n  });\n\n  const deleteRoundMutation = useMutation({\n    mutationFn: async (id: string) => {\n      return await apiRequest(`/api/rounds/${id}?tournamentId=${tournamentId}`, \"DELETE\");\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/tournaments\", tournamentId, \"rounds\"] });\n      toast({\n        title: \"Success\",\n        description: \"Round deleted successfully\",\n      });\n    },\n    onError: (error: Error) => {\n      if (isUnauthorizedError(error)) {\n        toast({\n          title: \"Unauthorized\",\n          description: \"You are logged out. Logging in again...\",\n          variant: \"destructive\",\n        });\n        setTimeout(() => {\n          window.location.href = \"/login\";\n        }, 500);\n        return;\n      }\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to delete round\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleDelete = async (id: string) => {\n    if (confirm(\"Are you sure? This will delete the round and all its matches.\")) {\n      await deleteRoundMutation.mutateAsync(id);\n    }\n  };\n\n  return (\n    <div className=\"border rounded-md p-3 bg-muted/30\">\n      <div className=\"flex items-center justify-between gap-2\">\n        <div className=\"flex items-center gap-2 flex-1 min-w-0\">\n          <Button\n            variant=\"ghost\"\n            size=\"icon\"\n            className=\"h-6 w-6\"\n            onClick={() => setIsExpanded(!isExpanded)}\n            data-testid={`button-toggle-round-${round.id}`}\n          >\n            {isExpanded ? <ChevronDown className=\"h-3 w-3\" /> : <ChevronRight className=\"h-3 w-3\" />}\n          </Button>\n          <div className=\"flex-1 min-w-0\">\n            <p className=\"text-sm font-medium truncate\" data-testid={`text-round-name-${round.id}`}>\n              Round {round.roundNumber}: {round.name}\n            </p>\n            {round.format && (\n              <p className=\"text-xs text-muted-foreground truncate\">Format: {round.format}</p>\n            )}\n          </div>\n        </div>\n        <DropdownMenu>\n          <DropdownMenuTrigger asChild>\n            <Button variant=\"ghost\" size=\"icon\" className=\"h-6 w-6\" data-testid={`button-round-menu-${round.id}`}>\n              <MoreHorizontal className=\"h-3 w-3\" />\n            </Button>\n          </DropdownMenuTrigger>\n          <DropdownMenuContent align=\"end\">\n            <DropdownMenuItem \n              onClick={() => onEdit(round)}\n              data-testid={`button-edit-round-${round.id}`}\n            >\n              Edit Round\n            </DropdownMenuItem>\n            <DropdownMenuItem data-testid={`button-add-match-${round.id}`}>Add Match</DropdownMenuItem>\n            <DropdownMenuItem \n              className=\"text-destructive\"\n              onClick={() => handleDelete(round.id)}\n              data-testid={`button-delete-round-${round.id}`}\n            >\n              Delete Round\n            </DropdownMenuItem>\n          </DropdownMenuContent>\n        </DropdownMenu>\n      </div>\n      \n      {isExpanded && (\n        <div className=\"mt-2 space-y-1 ml-8\">\n          {loadingMatches ? (\n            <Skeleton className=\"h-10\" />\n          ) : matches.length === 0 ? (\n            <div className=\"text-xs text-muted-foreground text-center py-2\">No matches scheduled</div>\n          ) : (\n            matches.map((match) => (\n              <div key={match.id} className=\"flex items-center gap-2 p-2 bg-background rounded text-xs\">\n                <span className=\"text-muted-foreground\">Match {match.matchNumber}:</span>\n                <span className=\"font-medium\">{match.teamA}</span>\n                {match.scoreA !== null && match.scoreB !== null ? (\n                  <>\n                    <span className=\"text-muted-foreground\">\n                      {match.scoreA} - {match.scoreB}\n                    </span>\n                    <span className=\"font-medium\">{match.teamB}</span>\n                  </>\n                ) : (\n                  <>\n                    <span className=\"text-muted-foreground\">vs</span>\n                    <span className=\"font-medium\">{match.teamB}</span>\n                  </>\n                )}\n              </div>\n            ))\n          )}\n        </div>\n      )}\n    </div>\n  );\n}\n\nexport default function Tournaments() {\n  const { toast } = useToast();\n  const [tournamentDialogOpen, setTournamentDialogOpen] = useState(false);\n  const [selectedTournament, setSelectedTournament] = useState<Tournament | undefined>();\n  const [roundDialogOpen, setRoundDialogOpen] = useState(false);\n  const [selectedRound, setSelectedRound] = useState<TournamentRound | undefined>();\n  const [selectedTournamentId, setSelectedTournamentId] = useState<string>(\"\");\n\n  const { data: tournaments = [], isLoading } = useQuery<Tournament[]>({\n    queryKey: [\"/api/tournaments\"],\n  });\n\n  const handleAdd = () => {\n    setSelectedTournament(undefined);\n    setTournamentDialogOpen(true);\n  };\n\n  const handleEditTournament = (tournament: Tournament) => {\n    setSelectedTournament(tournament);\n    setTournamentDialogOpen(true);\n  };\n\n  const handleAddRound = (tournamentId: string) => {\n    setSelectedTournamentId(tournamentId);\n    setSelectedRound(undefined);\n    setRoundDialogOpen(true);\n  };\n\n  const handleEditRound = (round: TournamentRound) => {\n    setSelectedTournamentId(round.tournamentId);\n    setSelectedRound(round);\n    setRoundDialogOpen(true);\n  };\n\n  return (\n    <div className=\"p-6 space-y-6\">\n      <div className=\"flex items-center justify-between gap-4 flex-wrap\">\n        <div>\n          <h1 className=\"text-3xl font-heading font-bold mb-1\" data-testid=\"text-tournaments-title\">\n            Tournaments\n          </h1>\n          <p className=\"text-muted-foreground\">Manage tournament structure with rounds and matches</p>\n        </div>\n        <Button onClick={handleAdd} data-testid=\"button-add-tournament\">\n          <Plus className=\"w-4 h-4 mr-2\" />\n          Add Tournament\n        </Button>\n      </div>\n\n      {isLoading ? (\n        <div className=\"grid grid-cols-1 gap-6\">\n          {[1, 2, 3].map((i) => (\n            <Skeleton key={i} className=\"h-48\" />\n          ))}\n        </div>\n      ) : tournaments.length === 0 ? (\n        <Card>\n          <CardContent className=\"flex flex-col items-center justify-center py-12\">\n            <Trophy className=\"h-12 w-12 text-muted-foreground mb-4\" />\n            <p className=\"text-center text-muted-foreground mb-4\">\n              No tournaments yet. Create your first tournament to get started.\n            </p>\n            <Button onClick={handleAdd}>\n              <Plus className=\"w-4 h-4 mr-2\" />\n              Create Tournament\n            </Button>\n          </CardContent>\n        </Card>\n      ) : (\n        <div className=\"grid grid-cols-1 gap-6\">\n          {tournaments.map((tournament) => (\n            <TournamentCard \n              key={tournament.id} \n              tournament={tournament}\n              onEdit={handleEditTournament}\n              onAddRound={handleAddRound}\n              onEditRound={handleEditRound}\n            />\n          ))}\n        </div>\n      )}\n\n      <TournamentDialog\n        open={tournamentDialogOpen}\n        onOpenChange={setTournamentDialogOpen}\n        tournament={selectedTournament}\n      />\n\n      <RoundDialog\n        open={roundDialogOpen}\n        onOpenChange={setRoundDialogOpen}\n        tournamentId={selectedTournamentId}\n        round={selectedRound}\n      />\n    </div>\n  );\n}\n","size_bytes":15976},"client/src/pages/finance.tsx":{"content":"import { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { queryClient, apiRequest } from \"@/lib/queryClient\";\nimport { type Transaction } from \"@shared/schema\";\nimport { useState, useMemo } from \"react\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from \"@/components/ui/dialog\";\nimport {\n  Form,\n  FormControl,\n  FormField,\n  FormItem,\n  FormLabel,\n  FormMessage,\n} from \"@/components/ui/form\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n  AlertDialogTrigger,\n} from \"@/components/ui/alert-dialog\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { insertTransactionSchema, type InsertTransaction } from \"@shared/schema\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { format } from \"date-fns\";\nimport {\n  Plus,\n  TrendingUp,\n  TrendingDown,\n  DollarSign,\n  Edit,\n  Trash2,\n  Calendar,\n  Filter,\n  Download,\n} from \"lucide-react\";\nimport {\n  LineChart,\n  Line,\n  XAxis,\n  YAxis,\n  CartesianGrid,\n  Tooltip,\n  Legend,\n  ResponsiveContainer,\n} from \"recharts\";\n\nconst incomeCategories = [\n  { value: \"sponsorship\", label: \"Sponsorship\" },\n  { value: \"merchandise\", label: \"Merchandise\" },\n  { value: \"tournament_prize\", label: \"Tournament Prize\" },\n  { value: \"streaming_revenue\", label: \"Streaming Revenue\" },\n  { value: \"ticket_sales\", label: \"Ticket Sales\" },\n  { value: \"other_income\", label: \"Other Income\" },\n];\n\nconst expenseCategories = [\n  { value: \"salaries\", label: \"Salaries\" },\n  { value: \"equipment\", label: \"Equipment\" },\n  { value: \"facility\", label: \"Facility Rent\" },\n  { value: \"travel\", label: \"Travel\" },\n  { value: \"marketing\", label: \"Marketing\" },\n  { value: \"tournament_fees\", label: \"Tournament Fees\" },\n  { value: \"utilities\", label: \"Utilities\" },\n  { value: \"other_expense\", label: \"Other Expense\" },\n];\n\nconst paymentMethods = [\n  { value: \"cash\", label: \"Cash\" },\n  { value: \"bank_transfer\", label: \"Bank Transfer\" },\n  { value: \"credit_card\", label: \"Credit Card\" },\n  { value: \"paypal\", label: \"PayPal\" },\n  { value: \"crypto\", label: \"Cryptocurrency\" },\n  { value: \"other\", label: \"Other\" },\n];\n\nexport default function Finance() {\n  const { toast } = useToast();\n  const [isOpen, setIsOpen] = useState(false);\n  const [editingTransaction, setEditingTransaction] = useState<Transaction | null>(null);\n  const [filterType, setFilterType] = useState<string>(\"all\");\n  const [filterCategory, setFilterCategory] = useState<string>(\"all\");\n\n  const { data: transactions = [], isLoading } = useQuery<Transaction[]>({\n    queryKey: [\"/api/finance\"],\n  });\n\n  const { data: monthlyData = [] } = useQuery<Array<{\n    month: string;\n    income: number;\n    expenses: number;\n    profit: number;\n  }>>({\n    queryKey: [\"/api/finance/monthly\"],\n  });\n\n  const handleExport = async () => {\n    try {\n      const response = await fetch(\"/api/finance/export\", {\n        credentials: \"include\",\n      });\n      \n      if (!response.ok) throw new Error(\"Export failed\");\n      \n      const blob = await response.blob();\n      const url = window.URL.createObjectURL(blob);\n      const a = document.createElement(\"a\");\n      a.href = url;\n      a.download = `transactions-${format(new Date(), \"yyyy-MM-dd\")}.csv`;\n      document.body.appendChild(a);\n      a.click();\n      window.URL.revokeObjectURL(url);\n      document.body.removeChild(a);\n      \n      toast({ title: \"Transactions exported successfully\" });\n    } catch (error) {\n      toast({\n        title: \"Failed to export transactions\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  const form = useForm<any>({\n    resolver: zodResolver(insertTransactionSchema.omit({ tenantId: true, createdBy: true })),\n    defaultValues: {\n      type: \"income\",\n      category: \"\",\n      amount: undefined,\n      description: \"\",\n      date: new Date().toISOString().split(\"T\")[0],\n      paymentMethod: \"\",\n      reference: \"\",\n    },\n  });\n\n  const createMutation = useMutation({\n    mutationFn: async (data: InsertTransaction) => {\n      return apiRequest(\"/api/finance\", \"POST\", data);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/finance\"] });\n      toast({ title: \"Transaction created successfully\" });\n      setIsOpen(false);\n      form.reset();\n    },\n    onError: () => {\n      toast({\n        title: \"Failed to create transaction\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const updateMutation = useMutation({\n    mutationFn: async ({\n      id,\n      data,\n    }: {\n      id: string;\n      data: Partial<InsertTransaction>;\n    }) => {\n      return apiRequest(`/api/finance/${id}`, \"PATCH\", data);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/finance\"] });\n      toast({ title: \"Transaction updated successfully\" });\n      setIsOpen(false);\n      setEditingTransaction(null);\n      form.reset();\n    },\n    onError: () => {\n      toast({\n        title: \"Failed to update transaction\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const deleteMutation = useMutation({\n    mutationFn: async (id: string) => {\n      return apiRequest(`/api/finance/${id}`, \"DELETE\");\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/finance\"] });\n      toast({ title: \"Transaction deleted successfully\" });\n    },\n    onError: () => {\n      toast({\n        title: \"Failed to delete transaction\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const onSubmit = (data: any) => {\n    const submitData = {\n      ...data,\n      amount: data.amount.toString(),\n      date: new Date(data.date),\n    };\n    if (editingTransaction) {\n      updateMutation.mutate({ id: editingTransaction.id, data: submitData });\n    } else {\n      createMutation.mutate(submitData);\n    }\n  };\n\n  const openEditDialog = (transaction: Transaction) => {\n    setEditingTransaction(transaction);\n    form.reset({\n      type: transaction.type,\n      category: transaction.category,\n      amount: transaction.amount,\n      description: transaction.description || \"\",\n      date: format(new Date(transaction.date), \"yyyy-MM-dd\"),\n      paymentMethod: transaction.paymentMethod || \"\",\n      reference: transaction.reference || \"\",\n    });\n    setIsOpen(true);\n  };\n\n  const closeDialog = () => {\n    setIsOpen(false);\n    setEditingTransaction(null);\n    form.reset();\n  };\n\n  // Calculate financial summary\n  const summary = useMemo(() => {\n    const income = transactions\n      .filter((t) => t.type === \"income\")\n      .reduce((sum, t) => sum + parseFloat(t.amount), 0);\n    const expenses = transactions\n      .filter((t) => t.type === \"expense\")\n      .reduce((sum, t) => sum + parseFloat(t.amount), 0);\n    const profit = income - expenses;\n    return { income, expenses, profit };\n  }, [transactions]);\n\n  // Filter transactions\n  const filteredTransactions = useMemo(() => {\n    return transactions.filter((t) => {\n      if (filterType !== \"all\" && t.type !== filterType) return false;\n      if (filterCategory !== \"all\" && t.category !== filterCategory) return false;\n      return true;\n    });\n  }, [transactions, filterType, filterCategory]);\n\n  const selectedType = form.watch(\"type\");\n  const categories = selectedType === \"income\" ? incomeCategories : expenseCategories;\n\n  return (\n    <div className=\"p-6 space-y-6\">\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h1 className=\"text-3xl font-bold tracking-tight\">Finance</h1>\n          <p className=\"text-muted-foreground mt-1\">\n            Track income, expenses, and financial health\n          </p>\n        </div>\n        <div className=\"flex gap-2\">\n          <Button \n            variant=\"outline\" \n            onClick={handleExport}\n            data-testid=\"button-export-transactions\"\n          >\n            <Download className=\"h-4 w-4 mr-2\" />\n            Export\n          </Button>\n          <Dialog open={isOpen} onOpenChange={setIsOpen}>\n            <DialogTrigger asChild>\n              <Button onClick={() => closeDialog()} data-testid=\"button-add-transaction\">\n                <Plus className=\"h-4 w-4 mr-2\" />\n                Add Transaction\n              </Button>\n            </DialogTrigger>\n          <DialogContent className=\"max-w-2xl\" data-testid=\"dialog-transaction\">\n            <DialogHeader>\n              <DialogTitle>\n                {editingTransaction ? \"Edit Transaction\" : \"Add Transaction\"}\n              </DialogTitle>\n            </DialogHeader>\n            <Form {...form}>\n              <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\">\n                <div className=\"grid grid-cols-2 gap-4\">\n                  <FormField\n                    control={form.control}\n                    name=\"type\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>Type</FormLabel>\n                        <Select\n                          onValueChange={(value) => {\n                            field.onChange(value);\n                            form.setValue(\"category\", \"\");\n                          }}\n                          value={field.value}\n                        >\n                          <FormControl>\n                            <SelectTrigger data-testid=\"select-type\">\n                              <SelectValue placeholder=\"Select type\" />\n                            </SelectTrigger>\n                          </FormControl>\n                          <SelectContent>\n                            <SelectItem value=\"income\">Income</SelectItem>\n                            <SelectItem value=\"expense\">Expense</SelectItem>\n                          </SelectContent>\n                        </Select>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  <FormField\n                    control={form.control}\n                    name=\"category\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>Category</FormLabel>\n                        <Select onValueChange={field.onChange} value={field.value}>\n                          <FormControl>\n                            <SelectTrigger data-testid=\"select-category\">\n                              <SelectValue placeholder=\"Select category\" />\n                            </SelectTrigger>\n                          </FormControl>\n                          <SelectContent>\n                            {categories.map((cat) => (\n                              <SelectItem key={cat.value} value={cat.value}>\n                                {cat.label}\n                              </SelectItem>\n                            ))}\n                          </SelectContent>\n                        </Select>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n                </div>\n\n                <div className=\"grid grid-cols-2 gap-4\">\n                  <FormField\n                    control={form.control}\n                    name=\"amount\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>Amount</FormLabel>\n                        <FormControl>\n                          <Input\n                            {...field}\n                            type=\"number\"\n                            step=\"0.01\"\n                            placeholder=\"0.00\"\n                            data-testid=\"input-amount\"\n                          />\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  <FormField\n                    control={form.control}\n                    name=\"date\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>Date</FormLabel>\n                        <FormControl>\n                          <Input\n                            {...field}\n                            type=\"date\"\n                            data-testid=\"input-date\"\n                          />\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n                </div>\n\n                <FormField\n                  control={form.control}\n                  name=\"description\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Description</FormLabel>\n                      <FormControl>\n                        <Textarea\n                          {...field}\n                          placeholder=\"Transaction details...\"\n                          data-testid=\"input-description\"\n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <div className=\"grid grid-cols-2 gap-4\">\n                  <FormField\n                    control={form.control}\n                    name=\"paymentMethod\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>Payment Method (Optional)</FormLabel>\n                        <Select onValueChange={field.onChange} value={field.value || \"\"}>\n                          <FormControl>\n                            <SelectTrigger data-testid=\"select-payment-method\">\n                              <SelectValue placeholder=\"Select method\" />\n                            </SelectTrigger>\n                          </FormControl>\n                          <SelectContent>\n                            {paymentMethods.map((method) => (\n                              <SelectItem key={method.value} value={method.value}>\n                                {method.label}\n                              </SelectItem>\n                            ))}\n                          </SelectContent>\n                        </Select>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  <FormField\n                    control={form.control}\n                    name=\"reference\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>Reference (Optional)</FormLabel>\n                        <FormControl>\n                          <Input\n                            {...field}\n                            placeholder=\"Invoice #, Receipt #, etc.\"\n                            data-testid=\"input-reference\"\n                          />\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n                </div>\n\n                <div className=\"flex gap-2 justify-end\">\n                  <Button\n                    type=\"button\"\n                    variant=\"outline\"\n                    onClick={closeDialog}\n                    data-testid=\"button-cancel\"\n                  >\n                    Cancel\n                  </Button>\n                  <Button\n                    type=\"submit\"\n                    disabled={createMutation.isPending || updateMutation.isPending}\n                    data-testid=\"button-submit\"\n                  >\n                    {editingTransaction ? \"Update\" : \"Create\"} Transaction\n                  </Button>\n                </div>\n              </form>\n            </Form>\n          </DialogContent>\n          </Dialog>\n        </div>\n      </div>\n\n      {/* Summary Cards */}\n      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n        <Card data-testid=\"card-income\">\n          <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">Total Income</CardTitle>\n            <TrendingUp className=\"h-4 w-4 text-success\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold font-mono\" data-testid=\"text-total-income\">\n              ${summary.income.toFixed(2)}\n            </div>\n            <p className=\"text-xs text-muted-foreground mt-1\">\n              {transactions.filter((t) => t.type === \"income\").length} transactions\n            </p>\n          </CardContent>\n        </Card>\n\n        <Card data-testid=\"card-expenses\">\n          <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">Total Expenses</CardTitle>\n            <TrendingDown className=\"h-4 w-4 text-destructive\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold font-mono\" data-testid=\"text-total-expenses\">\n              ${summary.expenses.toFixed(2)}\n            </div>\n            <p className=\"text-xs text-muted-foreground mt-1\">\n              {transactions.filter((t) => t.type === \"expense\").length} transactions\n            </p>\n          </CardContent>\n        </Card>\n\n        <Card data-testid=\"card-profit\">\n          <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">Net Profit/Loss</CardTitle>\n            <DollarSign className=\"h-4 w-4\" />\n          </CardHeader>\n          <CardContent>\n            <div\n              className={`text-2xl font-bold font-mono ${\n                summary.profit >= 0 ? \"text-success\" : \"text-destructive\"\n              }`}\n              data-testid=\"text-profit\"\n            >\n              ${summary.profit.toFixed(2)}\n            </div>\n            <p className=\"text-xs text-muted-foreground mt-1\">\n              {summary.profit >= 0 ? \"Profitable\" : \"Loss\"}\n            </p>\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Monthly Trend Chart */}\n      {monthlyData.length > 0 && (\n        <Card data-testid=\"card-monthly-trend\">\n          <CardHeader>\n            <CardTitle>Monthly Trends</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <ResponsiveContainer width=\"100%\" height={300}>\n              <LineChart data={monthlyData}>\n                <CartesianGrid strokeDasharray=\"3 3\" className=\"stroke-muted\" />\n                <XAxis \n                  dataKey=\"month\" \n                  className=\"text-xs\"\n                  tick={{ fill: 'hsl(var(--muted-foreground))' }}\n                />\n                <YAxis \n                  className=\"text-xs\"\n                  tick={{ fill: 'hsl(var(--muted-foreground))' }}\n                  tickFormatter={(value) => `$${value.toLocaleString()}`}\n                />\n                <Tooltip \n                  contentStyle={{\n                    backgroundColor: 'hsl(var(--popover))',\n                    border: '1px solid hsl(var(--border))',\n                    borderRadius: '6px',\n                  }}\n                  labelStyle={{ color: 'hsl(var(--popover-foreground))' }}\n                  formatter={(value: number) => [`$${value.toFixed(2)}`]}\n                />\n                <Legend \n                  wrapperStyle={{ color: 'hsl(var(--foreground))' }}\n                />\n                <Line \n                  type=\"monotone\" \n                  dataKey=\"income\" \n                  stroke=\"hsl(var(--success))\" \n                  strokeWidth={2}\n                  name=\"Income\"\n                  data-testid=\"line-income\"\n                />\n                <Line \n                  type=\"monotone\" \n                  dataKey=\"expenses\" \n                  stroke=\"hsl(var(--destructive))\" \n                  strokeWidth={2}\n                  name=\"Expenses\"\n                  data-testid=\"line-expenses\"\n                />\n                <Line \n                  type=\"monotone\" \n                  dataKey=\"profit\" \n                  stroke=\"hsl(var(--primary))\" \n                  strokeWidth={2}\n                  name=\"Net Profit\"\n                  data-testid=\"line-profit\"\n                />\n              </LineChart>\n            </ResponsiveContainer>\n          </CardContent>\n        </Card>\n      )}\n\n      {/* Filters */}\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <Filter className=\"h-5 w-5\" />\n            Filters\n          </CardTitle>\n        </CardHeader>\n        <CardContent className=\"flex gap-4\">\n          <Select value={filterType} onValueChange={setFilterType}>\n            <SelectTrigger className=\"w-[180px]\" data-testid=\"select-filter-type\">\n              <SelectValue placeholder=\"Filter by type\" />\n            </SelectTrigger>\n            <SelectContent>\n              <SelectItem value=\"all\">All Types</SelectItem>\n              <SelectItem value=\"income\">Income</SelectItem>\n              <SelectItem value=\"expense\">Expense</SelectItem>\n            </SelectContent>\n          </Select>\n\n          <Select value={filterCategory} onValueChange={setFilterCategory}>\n            <SelectTrigger className=\"w-[180px]\" data-testid=\"select-filter-category\">\n              <SelectValue placeholder=\"Filter by category\" />\n            </SelectTrigger>\n            <SelectContent>\n              <SelectItem value=\"all\">All Categories</SelectItem>\n              {[...incomeCategories, ...expenseCategories].map((cat) => (\n                <SelectItem key={cat.value} value={cat.value}>\n                  {cat.label}\n                </SelectItem>\n              ))}\n            </SelectContent>\n          </Select>\n        </CardContent>\n      </Card>\n\n      {/* Transactions List */}\n      <Card>\n        <CardHeader>\n          <CardTitle>Transactions</CardTitle>\n        </CardHeader>\n        <CardContent>\n          {isLoading ? (\n            <div className=\"text-center py-8 text-muted-foreground\">\n              Loading transactions...\n            </div>\n          ) : filteredTransactions.length === 0 ? (\n            <div className=\"text-center py-8 text-muted-foreground\">\n              No transactions found\n            </div>\n          ) : (\n            <div className=\"space-y-2\">\n              {filteredTransactions.map((transaction) => (\n                <div\n                  key={transaction.id}\n                  className=\"flex items-center justify-between p-4 rounded-lg border hover-elevate active-elevate-2\"\n                  data-testid={`transaction-${transaction.id}`}\n                >\n                  <div className=\"flex items-center gap-4 flex-1\">\n                    <div\n                      className={`p-2 rounded-lg ${\n                        transaction.type === \"income\"\n                          ? \"bg-success/10 text-success\"\n                          : \"bg-destructive/10 text-destructive\"\n                      }`}\n                    >\n                      {transaction.type === \"income\" ? (\n                        <TrendingUp className=\"h-5 w-5\" />\n                      ) : (\n                        <TrendingDown className=\"h-5 w-5\" />\n                      )}\n                    </div>\n                    <div className=\"flex-1\">\n                      <div className=\"flex items-center gap-2\">\n                        <h4 className=\"font-semibold\" data-testid={`text-description-${transaction.id}`}>\n                          {transaction.description || transaction.category}\n                        </h4>\n                        <Badge variant={transaction.type === \"income\" ? \"default\" : \"destructive\"}>\n                          {transaction.category.replace(/_/g, \" \")}\n                        </Badge>\n                      </div>\n                      <div className=\"flex items-center gap-4 mt-1 text-sm text-muted-foreground\">\n                        <span className=\"flex items-center gap-1\">\n                          <Calendar className=\"h-3 w-3\" />\n                          {format(new Date(transaction.date), \"MMM dd, yyyy\")}\n                        </span>\n                        {transaction.paymentMethod && (\n                          <span>{transaction.paymentMethod.replace(/_/g, \" \")}</span>\n                        )}\n                        {transaction.reference && (\n                          <span>Ref: {transaction.reference}</span>\n                        )}\n                      </div>\n                    </div>\n                    <div\n                      className={`text-lg font-mono font-semibold ${\n                        transaction.type === \"income\" ? \"text-success\" : \"text-destructive\"\n                      }`}\n                      data-testid={`text-amount-${transaction.id}`}\n                    >\n                      {transaction.type === \"income\" ? \"+\" : \"-\"}$\n                      {parseFloat(transaction.amount).toFixed(2)}\n                    </div>\n                  </div>\n                  <div className=\"flex items-center gap-2 ml-4\">\n                    <Button\n                      variant=\"ghost\"\n                      size=\"icon\"\n                      onClick={() => openEditDialog(transaction)}\n                      data-testid={`button-edit-${transaction.id}`}\n                    >\n                      <Edit className=\"h-4 w-4\" />\n                    </Button>\n                    <AlertDialog>\n                      <AlertDialogTrigger asChild>\n                        <Button\n                          variant=\"ghost\"\n                          size=\"icon\"\n                          data-testid={`button-delete-${transaction.id}`}\n                        >\n                          <Trash2 className=\"h-4 w-4\" />\n                        </Button>\n                      </AlertDialogTrigger>\n                      <AlertDialogContent>\n                        <AlertDialogHeader>\n                          <AlertDialogTitle>Delete Transaction</AlertDialogTitle>\n                          <AlertDialogDescription>\n                            Are you sure you want to delete this transaction? This action\n                            cannot be undone.\n                          </AlertDialogDescription>\n                        </AlertDialogHeader>\n                        <AlertDialogFooter>\n                          <AlertDialogCancel data-testid=\"button-cancel-delete\">\n                            Cancel\n                          </AlertDialogCancel>\n                          <AlertDialogAction\n                            onClick={() => deleteMutation.mutate(transaction.id)}\n                            data-testid=\"button-confirm-delete\"\n                          >\n                            Delete\n                          </AlertDialogAction>\n                        </AlertDialogFooter>\n                      </AlertDialogContent>\n                    </AlertDialog>\n                  </div>\n                </div>\n              ))}\n            </div>\n          )}\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":27502},"client/src/components/tournament-dialog.tsx":{"content":"import { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { insertTournamentSchema, type InsertTournament, type Tournament } from \"@shared/schema\";\nimport { useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { isUnauthorizedError } from \"@/lib/authUtils\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport {\n  Form,\n  FormControl,\n  FormField,\n  FormItem,\n  FormLabel,\n  FormMessage,\n} from \"@/components/ui/form\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Button } from \"@/components/ui/button\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport { format } from \"date-fns\";\n\ninterface TournamentDialogProps {\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n  tournament?: Tournament;\n}\n\nconst tournamentSchema = insertTournamentSchema.omit({ tenantId: true }).extend({\n  startDate: z.string(),\n  endDate: z.string().optional(),\n});\n\ntype TournamentFormData = z.infer<typeof tournamentSchema>;\n\nexport function TournamentDialog({ open, onOpenChange, tournament }: TournamentDialogProps) {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const isEdit = !!tournament;\n\n  const form = useForm<TournamentFormData>({\n    resolver: zodResolver(tournamentSchema),\n    defaultValues: tournament\n      ? {\n          name: tournament.name,\n          description: tournament.description || \"\",\n          format: tournament.format,\n          game: tournament.game || \"\",\n          startDate: tournament.startDate ? format(new Date(tournament.startDate), \"yyyy-MM-dd\") : \"\",\n          endDate: tournament.endDate ? format(new Date(tournament.endDate), \"yyyy-MM-dd\") : \"\",\n          maxTeams: tournament.maxTeams || undefined,\n          status: tournament.status,\n        }\n      : {\n          name: \"\",\n          description: \"\",\n          format: \"single-elimination\",\n          game: \"\",\n          startDate: \"\",\n          endDate: \"\",\n          maxTeams: undefined,\n          status: \"upcoming\",\n        },\n  });\n\n  const mutation = useMutation({\n    mutationFn: async (data: InsertTournament) => {\n      if (isEdit) {\n        return await apiRequest(`/api/tournaments/${tournament.id}`, \"PATCH\", data);\n      }\n      return await apiRequest(\"/api/tournaments\", \"POST\", data);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/tournaments\"] });\n      toast({\n        title: \"Success\",\n        description: `Tournament ${isEdit ? \"updated\" : \"created\"} successfully`,\n      });\n      onOpenChange(false);\n      form.reset();\n    },\n    onError: (error: Error) => {\n      if (isUnauthorizedError(error)) {\n        toast({\n          title: \"Unauthorized\",\n          description: \"You are logged out. Logging in again...\",\n          variant: \"destructive\",\n        });\n        setTimeout(() => {\n          window.location.href = \"/login\";\n        }, 500);\n        return;\n      }\n      toast({\n        title: \"Error\",\n        description: error.message || `Failed to ${isEdit ? \"update\" : \"create\"} tournament`,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const onSubmit = (data: TournamentFormData) => {\n    const tournamentData: any = {\n      ...data,\n      startDate: new Date(data.startDate),\n      endDate: data.endDate ? new Date(data.endDate) : undefined,\n    };\n    mutation.mutate(tournamentData);\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={onOpenChange}>\n      <DialogContent className=\"max-w-2xl max-h-[90vh] overflow-y-auto\">\n        <DialogHeader>\n          <DialogTitle>{isEdit ? \"Edit Tournament\" : \"Create Tournament\"}</DialogTitle>\n          <DialogDescription>\n            {isEdit ? \"Update tournament details\" : \"Add a new tournament to your organization\"}\n          </DialogDescription>\n        </DialogHeader>\n        <Form {...form}>\n          <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\">\n            <FormField\n              control={form.control}\n              name=\"name\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Tournament Name</FormLabel>\n                  <FormControl>\n                    <Input placeholder=\"Spring Championship 2025\" {...field} data-testid=\"input-tournament-name\" />\n                  </FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <FormField\n              control={form.control}\n              name=\"description\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Description (Optional)</FormLabel>\n                  <FormControl>\n                    <Textarea\n                      placeholder=\"Tournament details...\"\n                      {...field}\n                      value={field.value || \"\"}\n                      data-testid=\"input-tournament-description\"\n                    />\n                  </FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <div className=\"grid grid-cols-2 gap-4\">\n              <FormField\n                control={form.control}\n                name=\"format\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Format</FormLabel>\n                    <Select onValueChange={field.onChange} defaultValue={field.value || undefined}>\n                      <FormControl>\n                        <SelectTrigger data-testid=\"select-tournament-format\">\n                          <SelectValue placeholder=\"Select format\" />\n                        </SelectTrigger>\n                      </FormControl>\n                      <SelectContent>\n                        <SelectItem value=\"single-elimination\">Single Elimination</SelectItem>\n                        <SelectItem value=\"double-elimination\">Double Elimination</SelectItem>\n                        <SelectItem value=\"round-robin\">Round Robin</SelectItem>\n                        <SelectItem value=\"league\">League</SelectItem>\n                        <SelectItem value=\"swiss\">Swiss</SelectItem>\n                        <SelectItem value=\"custom\">Custom</SelectItem>\n                      </SelectContent>\n                    </Select>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"game\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Game (Optional)</FormLabel>\n                    <FormControl>\n                      <Input placeholder=\"League of Legends\" {...field} data-testid=\"input-tournament-game\" />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n            </div>\n\n            <div className=\"grid grid-cols-2 gap-4\">\n              <FormField\n                control={form.control}\n                name=\"startDate\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Start Date</FormLabel>\n                    <FormControl>\n                      <Input type=\"date\" {...field} data-testid=\"input-tournament-start-date\" />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"endDate\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>End Date (Optional)</FormLabel>\n                    <FormControl>\n                      <Input type=\"date\" {...field} data-testid=\"input-tournament-end-date\" />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n            </div>\n\n            <div className=\"grid grid-cols-2 gap-4\">\n              <FormField\n                control={form.control}\n                name=\"maxTeams\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Max Teams (Optional)</FormLabel>\n                    <FormControl>\n                      <Input\n                        type=\"number\"\n                        placeholder=\"16\"\n                        {...field}\n                        onChange={(e) => field.onChange(e.target.value ? parseInt(e.target.value) : undefined)}\n                        value={field.value || \"\"}\n                        data-testid=\"input-tournament-max-teams\"\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"status\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Status</FormLabel>\n                    <Select onValueChange={field.onChange} defaultValue={field.value || undefined}>\n                      <FormControl>\n                        <SelectTrigger data-testid=\"select-tournament-status\">\n                          <SelectValue placeholder=\"Select status\" />\n                        </SelectTrigger>\n                      </FormControl>\n                      <SelectContent>\n                        <SelectItem value=\"upcoming\">Upcoming</SelectItem>\n                        <SelectItem value=\"ongoing\">Ongoing</SelectItem>\n                        <SelectItem value=\"completed\">Completed</SelectItem>\n                        <SelectItem value=\"cancelled\">Cancelled</SelectItem>\n                      </SelectContent>\n                    </Select>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n            </div>\n\n            <div className=\"flex justify-end gap-2 pt-4\">\n              <Button\n                type=\"button\"\n                variant=\"outline\"\n                onClick={() => onOpenChange(false)}\n                data-testid=\"button-cancel-tournament\"\n              >\n                Cancel\n              </Button>\n              <Button type=\"submit\" disabled={mutation.isPending} data-testid=\"button-save-tournament\">\n                {mutation.isPending ? \"Saving...\" : isEdit ? \"Update\" : \"Create\"}\n              </Button>\n            </div>\n          </form>\n        </Form>\n      </DialogContent>\n    </Dialog>\n  );\n}\n","size_bytes":10822},"client/src/pages/login.tsx":{"content":"import { useState } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { LogIn, Trophy } from \"lucide-react\";\nimport { Link, useLocation } from \"wouter\";\n\nconst loginSchema = z.object({\n  email: z.string().email(\"Invalid email address\"),\n  password: z.string().min(1, \"Password is required\"),\n});\n\ntype LoginForm = z.infer<typeof loginSchema>;\n\nexport default function Login() {\n  const [, setLocation] = useLocation();\n  const { toast } = useToast();\n  const [isLoading, setIsLoading] = useState(false);\n\n  const form = useForm<LoginForm>({\n    resolver: zodResolver(loginSchema),\n    defaultValues: {\n      email: \"\",\n      password: \"\",\n    },\n  });\n\n  async function onSubmit(data: LoginForm) {\n    try {\n      setIsLoading(true);\n      const response = await apiRequest(\"/api/auth/login\", \"POST\", data);\n      \n      toast({\n        title: \"Welcome back!\",\n        description: \"Login successful\",\n      });\n\n      // Redirect to dashboard\n      setLocation(\"/\");\n    } catch (error: any) {\n      toast({\n        title: \"Login failed\",\n        description: error.message || \"Invalid email or password\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setIsLoading(false);\n    }\n  }\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center bg-background p-4\">\n      <div className=\"w-full max-w-md space-y-6\">\n        <div className=\"flex flex-col items-center text-center space-y-2\">\n          <div className=\"flex items-center gap-2\">\n            <Trophy className=\"w-8 h-8 text-primary\" />\n            <h1 className=\"text-3xl font-heading font-bold bg-gradient-to-r from-primary via-primary/80 to-primary/60 bg-clip-text text-transparent\">\n              Nexus Esports Suite\n            </h1>\n          </div>\n          <p className=\"text-muted-foreground\">Sign in to your account</p>\n        </div>\n\n        <Card>\n          <CardHeader>\n            <CardTitle>Login</CardTitle>\n            <CardDescription>Enter your credentials to access your account</CardDescription>\n          </CardHeader>\n          <CardContent>\n            <Form {...form}>\n              <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\">\n                <FormField\n                  control={form.control}\n                  name=\"email\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Email</FormLabel>\n                      <FormControl>\n                        <Input \n                          type=\"email\" \n                          placeholder=\"your@email.com\" \n                          data-testid=\"input-email\"\n                          {...field} \n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <FormField\n                  control={form.control}\n                  name=\"password\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Password</FormLabel>\n                      <FormControl>\n                        <Input \n                          type=\"password\" \n                          placeholder=\"\" \n                          data-testid=\"input-password\"\n                          {...field} \n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <Button \n                  type=\"submit\" \n                  className=\"w-full\" \n                  disabled={isLoading}\n                  data-testid=\"button-login\"\n                >\n                  <LogIn className=\"w-4 h-4 mr-2\" />\n                  {isLoading ? \"Signing in...\" : \"Sign In\"}\n                </Button>\n              </form>\n            </Form>\n\n            <div className=\"mt-4 text-center text-sm\">\n              <span className=\"text-muted-foreground\">Don't have an account? </span>\n              <Link href=\"/register\">\n                <span className=\"text-primary hover:underline cursor-pointer\" data-testid=\"link-register\">\n                  Sign up\n                </span>\n              </Link>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}\n","size_bytes":4815},"client/src/pages/register.tsx":{"content":"import { useState } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { UserPlus, Trophy } from \"lucide-react\";\nimport { Link, useLocation } from \"wouter\";\n\nconst registerSchema = z.object({\n  email: z.string().email(\"Invalid email address\"),\n  password: z.string().min(8, \"Password must be at least 8 characters\"),\n  confirmPassword: z.string(),\n  firstName: z.string().min(1, \"First name is required\"),\n  lastName: z.string().min(1, \"Last name is required\"),\n  tenantName: z.string().min(1, \"Organization name is required\"),\n}).refine((data) => data.password === data.confirmPassword, {\n  message: \"Passwords don't match\",\n  path: [\"confirmPassword\"],\n});\n\ntype RegisterForm = z.infer<typeof registerSchema>;\n\nexport default function Register() {\n  const [, setLocation] = useLocation();\n  const { toast } = useToast();\n  const [isLoading, setIsLoading] = useState(false);\n\n  const form = useForm<RegisterForm>({\n    resolver: zodResolver(registerSchema),\n    defaultValues: {\n      email: \"\",\n      password: \"\",\n      confirmPassword: \"\",\n      firstName: \"\",\n      lastName: \"\",\n      tenantName: \"\",\n    },\n  });\n\n  async function onSubmit(data: RegisterForm) {\n    try {\n      setIsLoading(true);\n      const { confirmPassword, ...registerData } = data;\n      const response = await apiRequest(\"/api/auth/register\", \"POST\", registerData);\n      \n      toast({\n        title: \"Account created!\",\n        description: \"Welcome to Nexus Esports Suite\",\n      });\n\n      // Redirect to dashboard\n      setLocation(\"/\");\n    } catch (error: any) {\n      toast({\n        title: \"Registration failed\",\n        description: error.message || \"Could not create account\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setIsLoading(false);\n    }\n  }\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center bg-background p-4\">\n      <div className=\"w-full max-w-md space-y-6\">\n        <div className=\"flex flex-col items-center text-center space-y-2\">\n          <div className=\"flex items-center gap-2\">\n            <Trophy className=\"w-8 h-8 text-primary\" />\n            <h1 className=\"text-3xl font-heading font-bold bg-gradient-to-r from-primary via-primary/80 to-primary/60 bg-clip-text text-transparent\">\n              Nexus Esports Suite\n            </h1>\n          </div>\n          <p className=\"text-muted-foreground\">Create your esports organization account</p>\n        </div>\n\n        <Card>\n          <CardHeader>\n            <CardTitle>Sign Up</CardTitle>\n            <CardDescription>Get started with your free trial</CardDescription>\n          </CardHeader>\n          <CardContent>\n            <Form {...form}>\n              <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\">\n                <div className=\"grid grid-cols-2 gap-4\">\n                  <FormField\n                    control={form.control}\n                    name=\"firstName\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>First Name</FormLabel>\n                        <FormControl>\n                          <Input \n                            placeholder=\"John\" \n                            data-testid=\"input-first-name\"\n                            {...field} \n                          />\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  <FormField\n                    control={form.control}\n                    name=\"lastName\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>Last Name</FormLabel>\n                        <FormControl>\n                          <Input \n                            placeholder=\"Doe\" \n                            data-testid=\"input-last-name\"\n                            {...field} \n                          />\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n                </div>\n\n                <FormField\n                  control={form.control}\n                  name=\"email\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Email</FormLabel>\n                      <FormControl>\n                        <Input \n                          type=\"email\" \n                          placeholder=\"your@email.com\" \n                          data-testid=\"input-email\"\n                          {...field} \n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <FormField\n                  control={form.control}\n                  name=\"tenantName\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Organization Name</FormLabel>\n                      <FormControl>\n                        <Input \n                          placeholder=\"Acme Esports\" \n                          data-testid=\"input-org-name\"\n                          {...field} \n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <FormField\n                  control={form.control}\n                  name=\"password\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Password</FormLabel>\n                      <FormControl>\n                        <Input \n                          type=\"password\" \n                          placeholder=\"\" \n                          data-testid=\"input-password\"\n                          {...field} \n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <FormField\n                  control={form.control}\n                  name=\"confirmPassword\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Confirm Password</FormLabel>\n                      <FormControl>\n                        <Input \n                          type=\"password\" \n                          placeholder=\"\" \n                          data-testid=\"input-confirm-password\"\n                          {...field} \n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <Button \n                  type=\"submit\" \n                  className=\"w-full\" \n                  disabled={isLoading}\n                  data-testid=\"button-register\"\n                >\n                  <UserPlus className=\"w-4 h-4 mr-2\" />\n                  {isLoading ? \"Creating account...\" : \"Create Account\"}\n                </Button>\n              </form>\n            </Form>\n\n            <div className=\"mt-4 text-center text-sm\">\n              <span className=\"text-muted-foreground\">Already have an account? </span>\n              <Link href=\"/login\">\n                <span className=\"text-primary hover:underline cursor-pointer\" data-testid=\"link-login\">\n                  Sign in\n                </span>\n              </Link>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}\n","size_bytes":8104},"server/auth.ts":{"content":"// Custom authentication system\nimport session from \"express-session\";\nimport type { Express, RequestHandler } from \"express\";\nimport connectPg from \"connect-pg-simple\";\n\nexport function getSession() {\n  const sessionTtl = 7 * 24 * 60 * 60 * 1000; // 1 week\n  const pgStore = connectPg(session);\n  const sessionStore = new pgStore({\n    conString: process.env.DATABASE_URL,\n    createTableIfMissing: false,\n    ttl: sessionTtl,\n    tableName: \"sessions\",\n  });\n  return session({\n    secret: process.env.SESSION_SECRET!,\n    store: sessionStore,\n    resave: false,\n    saveUninitialized: false,\n    cookie: {\n      httpOnly: true,\n      secure: process.env.NODE_ENV === \"production\",\n      maxAge: sessionTtl,\n    },\n  });\n}\n\nexport async function setupAuth(app: Express) {\n  app.set(\"trust proxy\", 1);\n  app.use(getSession());\n}\n\nexport const isAuthenticated: RequestHandler = async (req, res, next) => {\n  // Check if user ID exists in session\n  const userId = (req as any).session?.passport?.user?.claims?.sub;\n  \n  if (!userId) {\n    return res.status(401).json({ message: \"Unauthorized\" });\n  }\n\n  // Attach user object for compatibility with existing middleware\n  (req as any).user = {\n    claims: { sub: userId }\n  };\n\n  next();\n};\n","size_bytes":1239},"client/src/components/social-account-dialog-oauth.tsx":{"content":"import { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription } from \"@/components/ui/dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { SiInstagram, SiX, SiFacebook, SiTiktok, SiYoutube, SiTwitch } from \"react-icons/si\";\nimport { Link as LinkIcon, AlertCircle, CheckCircle2 } from \"lucide-react\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useState } from \"react\";\nimport { Alert, AlertDescription } from \"@/components/ui/alert\";\n\ninterface OAuthStatus {\n  configured: boolean;\n  name: string;\n  note?: string;\n}\n\ninterface SocialAccountOAuthDialogProps {\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n}\n\nconst platformIcons: Record<string, any> = {\n  instagram: SiInstagram,\n  twitter: SiX,\n  facebook: SiFacebook,\n  tiktok: SiTiktok,\n  youtube: SiYoutube,\n  twitch: SiTwitch,\n};\n\nconst platformColors: Record<string, string> = {\n  instagram: \"bg-gradient-to-br from-purple-600 via-pink-600 to-orange-500\",\n  twitter: \"bg-black\",\n  facebook: \"bg-blue-600\",\n  tiktok: \"bg-black\",\n  youtube: \"bg-red-600\",\n  twitch: \"bg-purple-600\",\n};\n\nexport function SocialAccountOAuthDialog({ open, onOpenChange }: SocialAccountOAuthDialogProps) {\n  const { toast } = useToast();\n  const [connectingPlatform, setConnectingPlatform] = useState<string | null>(null);\n\n  const { data: oauthStatus = {}, isLoading, error } = useQuery<Record<string, OAuthStatus>>({\n    queryKey: [\"/api/oauth/status\"],\n    enabled: open,\n  });\n\n  const handleConnect = async (platform: string) => {\n    try {\n      setConnectingPlatform(platform);\n      \n      const response = await fetch(`/api/oauth/init/${platform}`, {\n        credentials: \"include\",\n      });\n      \n      if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.message || \"Failed to initiate OAuth\");\n      }\n      \n      const { authUrl } = await response.json();\n      \n      // Redirect to the OAuth authorization page\n      window.location.href = authUrl;\n    } catch (error: any) {\n      setConnectingPlatform(null);\n      toast({\n        title: \"Connection failed\",\n        description: error.message || \"Failed to connect social account\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  const anyConfigured = Object.values(oauthStatus).some((status) => status.configured);\n\n  return (\n    <Dialog open={open} onOpenChange={onOpenChange}>\n      <DialogContent className=\"max-w-3xl\" data-testid=\"dialog-social-oauth\">\n        <DialogHeader>\n          <DialogTitle>Connect Social Media Account</DialogTitle>\n          <DialogDescription>\n            Connect your social media accounts using OAuth to track analytics and engagement.\n          </DialogDescription>\n        </DialogHeader>\n\n        {isLoading && (\n          <div className=\"text-center py-8\">\n            <p className=\"text-muted-foreground\">Loading platforms...</p>\n          </div>\n        )}\n\n        {error && (\n          <Alert variant=\"destructive\" data-testid=\"alert-error\">\n            <AlertCircle className=\"h-4 w-4\" />\n            <AlertDescription>\n              Failed to load OAuth platforms. Please try again.\n            </AlertDescription>\n          </Alert>\n        )}\n\n        {!isLoading && !error && !anyConfigured && (\n          <Alert data-testid=\"alert-no-platforms\">\n            <AlertCircle className=\"h-4 w-4\" />\n            <AlertDescription>\n              <strong>OAuth Not Configured</strong>\n              <p className=\"mt-2 text-sm\">\n                To enable social media connections, you need to register developer apps on each platform\n                and configure the API credentials as environment variables.\n              </p>\n              <p className=\"mt-2 text-sm font-mono text-xs\">\n                Example: INSTAGRAM_CLIENT_ID, INSTAGRAM_CLIENT_SECRET\n              </p>\n            </AlertDescription>\n          </Alert>\n        )}\n\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n          {Object.entries(oauthStatus).map(([platform, status]) => {\n            const Icon = platformIcons[platform];\n            const colorClass = platformColors[platform];\n            const isConnecting = connectingPlatform === platform;\n\n            return (\n              <Card key={platform} className=\"hover-elevate\" data-testid={`card-platform-${platform}`}>\n                <CardContent className=\"p-4\">\n                  <div className=\"flex items-start gap-3\">\n                    <div className={`${colorClass} p-3 rounded-md text-white`}>\n                      {Icon && <Icon className=\"h-6 w-6\" />}\n                    </div>\n                    <div className=\"flex-1 min-w-0\">\n                      <div className=\"flex items-center gap-2 mb-1\">\n                        <h3 className=\"font-semibold\">{status.name}</h3>\n                        {status.configured ? (\n                          <Badge variant=\"default\" className=\"text-xs\" data-testid={`badge-configured-${platform}`}>\n                            <CheckCircle2 className=\"h-3 w-3 mr-1\" />\n                            Ready\n                          </Badge>\n                        ) : (\n                          <Badge variant=\"secondary\" className=\"text-xs\" data-testid={`badge-not-configured-${platform}`}>\n                            Not Configured\n                          </Badge>\n                        )}\n                      </div>\n                      {status.note && (\n                        <p className=\"text-xs text-muted-foreground mb-3\">{status.note}</p>\n                      )}\n                      {!status.configured && (\n                        <p className=\"text-xs text-muted-foreground mb-3 font-mono\">\n                          Needs: {platform.toUpperCase()}_CLIENT_ID, {platform.toUpperCase()}_CLIENT_SECRET\n                        </p>\n                      )}\n                      <Button\n                        size=\"sm\"\n                        variant={status.configured ? \"default\" : \"outline\"}\n                        disabled={!status.configured || isConnecting}\n                        onClick={() => handleConnect(platform)}\n                        className=\"w-full\"\n                        data-testid={`button-connect-${platform}`}\n                      >\n                        {isConnecting ? (\n                          \"Connecting...\"\n                        ) : (\n                          <>\n                            <LinkIcon className=\"h-3 w-3 mr-2\" />\n                            Connect {status.name}\n                          </>\n                        )}\n                      </Button>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n            );\n          })}\n        </div>\n\n        <Alert className=\"mt-4\">\n          <AlertCircle className=\"h-4 w-4\" />\n          <AlertDescription className=\"text-sm\">\n            <strong>Setup Required:</strong> Each platform requires you to register a developer application\n            and obtain OAuth credentials. Contact your administrator to configure these integrations.\n          </AlertDescription>\n        </Alert>\n      </DialogContent>\n    </Dialog>\n  );\n}\n","size_bytes":7319},"server/oauth-config.ts":{"content":"// OAuth configuration for social media platforms\n// Each platform requires app registration and API credentials\n\nexport interface OAuthConfig {\n  clientId: string;\n  clientSecret: string;\n  authorizationUrl: string;\n  tokenUrl: string;\n  scope: string[];\n  redirectUri: string;\n}\n\nexport const OAUTH_PLATFORMS = {\n  instagram: {\n    name: \"Instagram\",\n    authorizationUrl: \"https://api.instagram.com/oauth/authorize\",\n    tokenUrl: \"https://api.instagram.com/oauth/access_token\",\n    scope: [\"user_profile\", \"user_media\"],\n    requiresBusinessAccount: true,\n    note: \"Requires Facebook Business account and app review\",\n  },\n  twitter: {\n    name: \"Twitter / X\",\n    authorizationUrl: \"https://twitter.com/i/oauth2/authorize\",\n    tokenUrl: \"https://api.twitter.com/2/oauth2/token\",\n    scope: [\"tweet.read\", \"users.read\", \"follows.read\"],\n    requiresPaidApi: true,\n    note: \"Requires paid API access ($100+/month)\",\n  },\n  facebook: {\n    name: \"Facebook\",\n    authorizationUrl: \"https://www.facebook.com/v18.0/dialog/oauth\",\n    tokenUrl: \"https://graph.facebook.com/v18.0/oauth/access_token\",\n    scope: [\"pages_show_list\", \"pages_read_engagement\", \"read_insights\"],\n    note: \"Requires app review and business verification\",\n  },\n  tiktok: {\n    name: \"TikTok\",\n    authorizationUrl: \"https://www.tiktok.com/v2/auth/authorize\",\n    tokenUrl: \"https://open.tiktokapis.com/v2/oauth/token\",\n    scope: [\"user.info.basic\", \"video.list\"],\n    note: \"Requires developer account and app approval\",\n  },\n  youtube: {\n    name: \"YouTube\",\n    authorizationUrl: \"https://accounts.google.com/o/oauth2/v2/auth\",\n    tokenUrl: \"https://oauth2.googleapis.com/token\",\n    scope: [\n      \"https://www.googleapis.com/auth/youtube.readonly\",\n      \"https://www.googleapis.com/auth/yt-analytics.readonly\",\n    ],\n    note: \"Requires Google Cloud project and OAuth consent screen\",\n  },\n  twitch: {\n    name: \"Twitch\",\n    authorizationUrl: \"https://id.twitch.tv/oauth2/authorize\",\n    tokenUrl: \"https://id.twitch.tv/oauth2/token\",\n    scope: [\"user:read:email\", \"channel:read:subscriptions\", \"analytics:read:extensions\"],\n    note: \"Requires Twitch developer account\",\n  },\n};\n\nfunction getBaseUrl(): string {\n  // Production: Use REPLIT_DOMAINS (comma-separated list, take first)\n  if (process.env.REPLIT_DOMAINS) {\n    const domain = process.env.REPLIT_DOMAINS.split(',')[0];\n    return `https://${domain}`;\n  }\n  \n  // Development: Use REPLIT_DEV_DOMAIN or localhost\n  if (process.env.REPLIT_DEV_DOMAIN) {\n    return `https://${process.env.REPLIT_DEV_DOMAIN}`;\n  }\n  \n  return \"http://localhost:5000\";\n}\n\nexport function getOAuthConfig(platform: string, skipLogging = false): OAuthConfig | null {\n  const platformConfig = OAUTH_PLATFORMS[platform as keyof typeof OAUTH_PLATFORMS];\n  if (!platformConfig) return null;\n\n  // Get platform-specific credentials from environment variables\n  const envPrefix = platform.toUpperCase();\n  const clientId = process.env[`${envPrefix}_CLIENT_ID`];\n  const clientSecret = process.env[`${envPrefix}_CLIENT_SECRET`];\n\n  // If credentials aren't configured, return null\n  if (!clientId || !clientSecret) {\n    if (!skipLogging) {\n      console.log(`OAuth not configured for ${platform}. Missing ${envPrefix}_CLIENT_ID or ${envPrefix}_CLIENT_SECRET`);\n    }\n    return null;\n  }\n\n  const baseUrl = getBaseUrl();\n  const redirectUri = `${baseUrl}/api/oauth/callback/${platform}`;\n\n  return {\n    clientId,\n    clientSecret,\n    authorizationUrl: platformConfig.authorizationUrl,\n    tokenUrl: platformConfig.tokenUrl,\n    scope: platformConfig.scope,\n    redirectUri,\n  };\n}\n\nexport function isOAuthConfigured(platform: string): boolean {\n  return getOAuthConfig(platform, true) !== null;\n}\n","size_bytes":3717}},"version":2}